<ion-header [translucent]="true">
  <ion-toolbar color="primary">
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/"></ion-back-button>
    </ion-buttons>
    <ion-title>ЁЯХЙя╕П роХро╛ропродрпНро░ро┐ роороирпНродро┐ро░роЩрпНроХро│рпН</ion-title>
    <ion-buttons slot="end">
      <ion-button (click)="toggleBookmark()">
        <ion-icon [name]="isBookmarked ? 'bookmark' : 'bookmark-outline'"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true">
  <!-- Hero Section -->
  <div class="hero-section">
    <div class="hero-content">
      <div class="hero-icon">
        <ion-icon name="flower-outline"></ion-icon>
      </div>
      <h1>роХро╛ропродрпНро░ро┐ роороирпНродро┐ро░роЩрпНроХро│рпН</h1>
      <p>Sacred Gayathri Mantras for Spiritual Enhancement</p>
    </div>
  </div>

  <!-- Content Section -->
  <div class="content-section">
    <!-- Category Grid with Expandable Sections -->
    <div class="categories-container">
      <div *ngFor="let category of gayathriCategories" class="category-section">
        
        <!-- Category Header Card -->
        <ion-card 
          [color]="category.color" 
          (click)="toggleCategory(category.id)"
          class="category-header-card">
          <ion-card-content>
            <div class="category-header-content">
              <div class="category-info">
                <div class="category-icon">{{ category.icon }}</div>
                <div class="category-details">
                  <h3>{{ category.name }}</h3>
                  <p>{{ category.mantras.length }} роороирпНродро┐ро░роЩрпНроХро│рпН</p>
                </div>
              </div>
              <div class="expand-icon">
                <ion-icon [name]="expandedCategories[category.id] ? 'chevron-up' : 'chevron-down'"></ion-icon>
              </div>
            </div>
          </ion-card-content>
        </ion-card>

        <!-- Expandable Mantras List -->
        <div *ngIf="expandedCategories[category.id]" class="mantras-expandable" [@slideInOut]>
          <div class="mantras-list">
            <ion-card 
              *ngFor="let mantra of category.mantras; trackBy: trackByMantraId" 
              class="compact-mantra-card"
              (click)="openMantraPreview(mantra)">
              
              <ion-card-content>
                <div class="card-header">
                  <div class="mantra-info">
                    <h4>{{ mantra.name }}</h4>
                    <p>{{ mantra.deity }}</p>
                  </div>
                  <div class="card-actions">
                    <ion-button fill="clear" size="small" (click)="toggleFavoriteMantra(mantra); $event.stopPropagation()">
                      <ion-icon [name]="isFavoriteMantra(mantra) ? 'heart' : 'heart-outline'" [color]="isFavoriteMantra(mantra) ? 'danger' : 'medium'"></ion-icon>
                    </ion-button>
                    <ion-icon name="chevron-forward" color="medium"></ion-icon>
                  </div>
                </div>
                
                <div class="mantra-preview-text">
                  {{ mantra.text.substring(0, 80) }}...
                </div>
                
                <div class="mantra-actions-inline">
                  <ion-button size="small" fill="clear" (click)="copyMantra(mantra); $event.stopPropagation()">
                    <ion-icon name="copy" slot="start"></ion-icon>
                    роироХрд▓рпН
                  </ion-button>
                  <ion-chip color="primary" size="small">
                    {{ mantra.benefits.length }} рокро▓ройрпНроХро│рпН
                  </ion-chip>
                </div>
              </ion-card-content>
            </ion-card>
          </div>
        </div>
      </div>
    </div>

  <!-- Mantra Preview Modal -->
  <ion-modal #previewModal class="preview-modal">
    <ng-template>
      <ion-header>
        <ion-toolbar color="primary">
          <ion-buttons slot="start">
            <ion-button (click)="closeMantraPreview()">
              <ion-icon name="arrow-back"></ion-icon>
            </ion-button>
          </ion-buttons>
          <ion-title>{{ selectedMantraForPreview?.name }}</ion-title>
          <ion-buttons slot="end">
            <ion-button (click)="openMantraDetail(selectedMantraForPreview)">
              <ion-icon name="expand-outline"></ion-icon>
            </ion-button>
          </ion-buttons>
        </ion-toolbar>
      </ion-header>
      
      <ion-content *ngIf="selectedMantraForPreview">
        <div class="preview-content">
          <!-- Deity Header -->
          <div class="deity-header-preview">
            <div class="deity-icon">{{ selectedGayathriCategory?.icon }}</div>
            <div class="deity-info">
              <h2>{{ selectedMantraForPreview.name }}</h2>
              <p>{{ selectedMantraForPreview.deity }}</p>
            </div>
          </div>

          <!-- Mantra Text -->
          <ion-card class="mantra-text-card">
            <ion-card-content>
              <div class="mantra-text-full">{{ selectedMantraForPreview.text }}</div>
            </ion-card-content>
          </ion-card>

          <!-- Benefits -->
          <ion-card class="benefits-card">
            <ion-card-header>
              <ion-card-title>рокро▓ройрпНроХро│рпН</ion-card-title>
            </ion-card-header>
            <ion-card-content>
              <div class="benefits-list">
                <div *ngFor="let benefit of selectedMantraForPreview.benefits" class="benefit-item">
                  <ion-icon name="checkmark-circle" color="success"></ion-icon>
                  <span>{{ benefit }}</span>
                </div>
              </div>
            </ion-card-content>
          </ion-card>

          <!-- Action Buttons -->
          <div class="preview-actions">
            <ion-button expand="block" fill="outline" (click)="copyMantra(selectedMantraForPreview)">
              <ion-icon name="copy" slot="start"></ion-icon>
              роироХро▓рпЖроЯрпБ
            </ion-button>
            <ion-button expand="block" (click)="openMantraDetail(selectedMantraForPreview)">
              <ion-icon name="eye" slot="start"></ion-icon>
              роорпБро┤рпБ ро╡ро┐ро╡ро░роорпН
            </ion-button>
          </div>
        </div>
      </ion-content>
    </ng-template>
  </ion-modal>

    <!-- Practice Guidelines -->
    <ion-card class="practice-card">
      <ion-card-header>
        <ion-card-title>ЁЯЩП роЬрок ро╡ро┐родро┐роорпБро▒рпИроХро│рпН</ion-card-title>
        <ion-card-subtitle>Practice Guidelines</ion-card-subtitle>
      </ion-card-header>
      <ion-card-content>
        <ion-list>
          <ion-item>
            <ion-icon name="time-outline" slot="start"></ion-icon>
            <ion-label>
              <h3>роЪро┐ро▒роирпНрод роирпЗро░роорпН</h3>
              <p>роЕродро┐роХро╛ро▓рпИ 4-6 роорогро┐ роЕро▓рпНро▓родрпБ роЪрпВро░рпНроп роЙродропроорпН</p>
            </ion-label>
          </ion-item>
          <ion-item>
            <ion-icon name="repeat-outline" slot="start"></ion-icon>
            <ion-label>
              <h3>роЬрок роОрогрпНрогро┐роХрпНроХрпИ</h3>
              <p>108 роорпБро▒рпИ роЕро▓рпНро▓родрпБ 27 роорпБро▒рпИ родро┐ройроорпБроорпН</p>
            </ion-label>
          </ion-item>
          <ion-item>
            <ion-icon name="leaf-outline" slot="start"></ion-icon>
            <ion-label>
              <h3>родрпВропрпНроорпИ</h3>
              <p>роХрпБро│ро┐родрпНродрпБ роЪрпБродрпНродрооро╛рой роЙроЯрпИропрпБроЯройрпН</p>
            </ion-label>
          </ion-item>
          <ion-item>
            <ion-icon name="flower-outline" slot="start"></ion-icon>
            <ion-label>
              <h3>рокрпВроЬрпИ рокрпКро░рпБроЯрпНроХро│рпН</h3>
              <p>ро╡ро┐ро│роХрпНроХрпБ, роЕроХро░рпНрокродрпНродро┐, рокрпВ, роирпАро░рпН</p>
            </ion-label>
          </ion-item>
        </ion-list>
      </ion-card-content>
    </ion-card>
  </div>

  <!-- Mantra Detail Modal -->
  <ion-modal #detailModal [isOpen]="selectedMantra !== null" [presentingElement]="null" class="fullscreen-modal">
    <ng-template>
      <ion-header>
        <ion-toolbar color="primary">
          <ion-buttons slot="start">
            <ion-button (click)="closeMantraDetail()">
              <ion-icon name="arrow-back"></ion-icon>
            </ion-button>
          </ion-buttons>
          <ion-title>{{ selectedMantra?.name }}</ion-title>
          <ion-buttons slot="end">
            <ion-button (click)="closeMantraDetail()">
              <ion-icon name="close"></ion-icon>
            </ion-button>
          </ion-buttons>
        </ion-toolbar>
      </ion-header>
      
      <ion-content *ngIf="selectedMantra">
        <div class="modal-content">
          <ion-card>
            <ion-card-header>
              <ion-card-title>{{ selectedMantra.name }}</ion-card-title>
              <ion-card-subtitle>{{ selectedMantra.deity }}</ion-card-subtitle>
            </ion-card-header>
            <ion-card-content>
              <div class="mantra-text-full">{{ selectedMantra.text }}</div>
              
              <div class="benefits-section">
                <h4>рокро▓ройрпНроХро│рпН:</h4>
                <ion-list>
                  <ion-item *ngFor="let benefit of selectedMantra.benefits">
                    <ion-icon name="checkmark-circle" slot="start" color="success"></ion-icon>
                    <ion-label>{{ benefit }}</ion-label>
                  </ion-item>
                </ion-list>
              </div>

              <div class="action-buttons">
                <ion-button fill="outline" (click)="copyMantra(selectedMantra)">
                  <ion-icon name="copy" slot="start"></ion-icon>
                  роироХрд▓рпЖроЯрпБ
                </ion-button>
                <ion-button fill="outline" (click)="shareMantra(selectedMantra)">
                  <ion-icon name="share" slot="start"></ion-icon>
                  рокроХро┐ро░рпБ
                </ion-button>
                <ion-button fill="outline" (click)="toggleFavoriteMantra(selectedMantra)">
                  <ion-icon [name]="isFavoriteMantra(selectedMantra) ? 'heart' : 'heart-outline'" slot="start"></ion-icon>
                  {{ isFavoriteMantra(selectedMantra) ? 'роирпАроХрпНроХрпБ' : 'роЪрпЗро░рпН' }}
                </ion-button>
              </div>
            </ion-card-content>
          </ion-card>
        </div>
      </ion-content>
    </ng-template>
  </ion-modal>
</ion-content>
