import { Component, OnInit } from '@angular/core';
import { ToastController, AlertController } from '@ionic/angular';

interface RemedySection {
  title: string;
  type: string;
  content: string[];
}

interface Remedy {
  title: string;
  subtitle: string;
  tags: string[];
  sections: RemedySection[];
  benefits: string;
  warning?: string;
  important?: string;
  expanded?: boolean;
}

interface Category {
  key: string;
  icon: string;
  title: string;
  remedies: Remedy[];
}

interface SearchResult {
  title: string;
  subtitle: string;
  categoryTitle: string;
  categoryColor: string;
  matchingTags: string[];
  benefits: string;
  remedy: Remedy;
  category: Category;
}

@Component({
  selector: 'app-tantrik-pariharam',
  templateUrl: './tantrik-pariharam.page.html',
  styleUrls: ['./tantrik-pariharam.page.scss'],
})
export class TantrikPariharamPage implements OnInit {
  isBookmarked = false;
  showCategoryView = true;
  selectedCategory: Category | null = null;
  searchTerm = '';
  searchResults: SearchResult[] = [];

  categories: Category[] = [
    {
      key: 'debt',
      icon: 'ЁЯТ░',
      title: 'роХроЯройрпН родрпАро░рпНро╡рпБ',
      remedies: [
        {
          title: '1. роЙроЪрпНроЪро░ро┐роХрпНроХрпБроорпН рокро░ро┐роХро╛ро░роорпН',
          subtitle: 'роорой роиро┐ро▓рпИропрпИ рооро╛ро▒рпНро▒ро┐ рокрог ро╡ро░ро╡рпИ роИро░рпНроХрпНроХрпБроорпН роорпБро▒рпИ',
          tags: ['роХроЯройрпН', 'рокрогроорпН', 'роорой роЕроорпИродро┐', 'роирпЗро░рпНрооро▒рпИ роЪро┐роирпНродройрпИ', 'debt', 'money', 'mental peace', 'positive thinking'],
          sections: [
            {
              title: 'ЁЯУЛ роЪрпЖропрпНроорпБро▒рпИ',
              type: 'method',
              content: [
                'ро░рпЛроЬро╛ роиро╛роЯрпНроХро│ро┐ро▓рпН роХро╛ро▓рпИ 5 роорогро┐роХрпНроХрпБ роОро┤рпБроирпНродрпБ роХрпБро│ро┐роХрпНроХ ро╡рпЗрогрпНроЯрпБроорпН',
                '"роиро╛ройрпН рокрогроХрпНроХро╛ро░ройрпН, роОройроХрпНроХрпБ рокрогроорпН роиро┐ро▒рпИроп роЗро░рпБроХрпНроХро┐ро▒родрпБ" роОройрпНро▒рпБ рооройродро┐ро▓рпН роЙро▒рпБродро┐ропро╛роХ роиро┐ройрпИроХрпНроХ ро╡рпЗрогрпНроЯрпБроорпН',
                'роХрпЛро╡ро┐ро▓ро┐ро▓рпН роЪрпЖройрпНро▒рпБ ро╡ро┐ро│роХрпНроХрпЗро▒рпНро▒ро┐ ро╡ро┤ро┐рокроЯ ро╡рпЗрогрпНроЯрпБроорпН',
                'ро░рпЛроЬро╛ роиро╛роЯрпНроХро│ро┐ро▓рпН роирпЛройрпНрокрпБ роЗро░рпБроХрпНроХ ро╡рпЗрогрпНроЯрпБроорпН'
              ]
            }
          ],
          benefits: 'ЁЯТл роорой роиро┐ро▓рпИ рооро╛ро▒рпБроорпН, рокрогроорпН ро╡ро░ роЖро░роорпНрокро┐роХрпНроХрпБроорпН, роироорпНрокро┐роХрпНроХрпИ рокро┐ро▒роХрпНроХрпБроорпН',
          warning: 'роироорпНрокро┐роХрпНроХрпИропрпБроЯройрпН роЪрпЖропрпНроп ро╡рпЗрогрпНроЯрпБроорпН. роЪроирпНродрпЗроХроорпН ро╡роирпНродро╛ро▓рпН рокро▓ройрпН роХро┐роЯрпИроХрпНроХро╛родрпБ.'
        },
        {
          title: '2. роиро╛рогроп рокро░ро┐роХро╛ро░роорпН',
          subtitle: '108 ро░рпВрокро╛ропрпН роиро╛рогропроЩрпНроХро│рпИ роХрпКрогрпНроЯ рокро░ро┐роХро╛ро░роорпН',
          tags: ['роХроЯройрпН', '108 роиро╛рогропроорпН', 'роороЮрпНроЪро│рпН', 'роЙрокрпНрокрпБ', 'debt', 'coins', 'turmeric', 'salt'],
          sections: [
            {
              title: 'ЁЯЫНя╕П родрпЗро╡рпИропро╛рой рокрпКро░рпБроЯрпНроХро│рпН',
              type: 'method',
              content: [
                '108 роТро░рпБ ро░рпВрокро╛ропрпН роиро╛рогропроЩрпНроХро│рпН',
                'роороЮрпНроЪро│рпН (Turmeric)',
                'роЙрокрпНрокрпБ (Salt)'
              ]
            },
            {
              title: 'тП░ роирпЗро░роорпН рооро▒рпНро▒рпБроорпН роЗроЯроорпН',
              type: 'method',
              content: [
                'роорпБродро▓рпН роЮро╛ропро┐ро▒рпНро▒рпБроХрпНроХро┐ро┤роорпИ роЕро▓рпНро▓родрпБ рокро┐ро▒роирпНродроиро╛ро│рпН',
                'роЪрпВро░ро┐роп роЙродропродрпНродро┐ро▒рпНроХрпБ роорпБройрпН',
                'роХроЯро▓рпН, роЖро▒рпБ роЕро▓рпНро▓родрпБ роиродро┐ роЕро░рпБроХро┐ро▓рпН',
                'ро╡роЯроХрпНроХрпБ роЕро▓рпНро▓родрпБ роХро┐ро┤роХрпНроХрпБ родро┐роЪрпИропрпИ роирпЛроХрпНроХро┐'
              ]
            },
            {
              title: 'ЁЯУЛ роЪрпЖропрпНроорпБро▒рпИ',
              type: 'method',
              content: [
                'роорпБродро▓ро┐ро▓рпН роХрпБро│ро┐родрпНродрпБ роЪрпБродрпНродрооро╛роХ роЗро░рпБроХрпНроХ ро╡рпЗрогрпНроЯрпБроорпН',
                '108 роиро╛рогропроЩрпНроХро│рпИ роороЮрпНроЪро│рпН, роЙрокрпНрокрпБ роХро▓роирпНрод роирпАро░ро┐ро▓рпН роорпБройрпНройро┐ро░ро╡рпБ роЪрпБродрпНродроорпН роЪрпЖропрпНроп ро╡рпЗрогрпНроЯрпБроорпН',
                'роТро╡рпНро╡рпКро░рпБ роиро╛рогропродрпНродрпИропрпБроорпН родро▓рпИроХрпНроХрпБ роорпЗро▓рпН 3 роорпБро▒рпИ роЪрпБро▒рпНро▒ро┐ роХрпАро┤рпЗ рокрпЛроЯ ро╡рпЗрогрпНроЯрпБроорпН',
                'ро╡ро┐роиро╛ропроХро░рпИ ро╡ро┤ро┐рокроЯрпНроЯрпБ ро╡ро░ ро╡рпЗрогрпНроЯрпБроорпН'
              ]
            }
          ],
          benefits: 'ЁЯОп 200% рокро▓ройрпН роХро┐роЯрпИроХрпНроХрпБроорпН. роироорпНрокро┐роХрпНроХрпИропрпБроЯройрпН роЪрпЖропрпНродро╛ро▓рпН рокро┐ро░роЪрпНроЪройрпИроХрпНроХрпБродрпН родрпАро░рпНро╡рпБ ро╡ро░рпБроорпН'
        },
        {
          title: '3. роиро╡ родро╛ройро┐ропрокрпН рокро░ро┐роХро╛ро░роорпН',
          subtitle: 'роХро┐ро░роХ родрпЛро╖роорпН роирпАроХрпНроХрпБроорпН роорпБро▒рпИ',
          tags: ['роХроЯройрпН', 'роиро╡ родро╛ройро┐ропроорпН', 'роХро┐ро░роХ родрпЛро╖роорпН', 'рокрогроорпН', 'роорпБро│рпИрокрпНрокро╛ро░ро┐', 'debt', 'nine grains', 'planetary dosham', 'money', 'sprouting'],
          sections: [
            {
              title: 'ЁЯМ╛ роиро╡ родро╛ройро┐ропроЩрпНроХро│рпН',
              type: 'method',
              content: [
                'роХрпЛродрпБроорпИ, роирпЖро▓рпН, родрпБро╡ро░рпИ, рокро╛роЪро┐рокрпНрокропро▒рпБ',
                'роХрпКрогрпНроЯрпИроХрпНроХроЯро▓рпИ, роорпКроЪрпНроЪрпИ, роОро│рпН',
                'роЙро│рпБроирпНродрпБ, роХрпКро│рпНро│рпБ'
              ]
            },
            {
              title: 'ЁЯУЛ роЪрпЖропрпНроорпБро▒рпИ',
              type: 'method',
              content: [
                'ро╡ро▓родрпБ роХрпИропро┐ро▓рпН роТро░рпБ роХрпИрокрпНрокро┐роЯро┐ роиро╡ родро╛ройро┐ропроЩрпНроХро│рпИ роОроЯрпБроХрпНроХ ро╡рпЗрогрпНроЯрпБроорпН',
                'ро╡роЯроХрпНроХрпБ родро┐роЪрпИропрпИ роирпЛроХрпНроХро┐ роиро┐ро▒рпНроХ ро╡рпЗрогрпНроЯрпБроорпН',
                'родро▓рпИроХрпНроХрпБ роорпЗро▓рпН роЗроЯрооро┐ро░рпБроирпНродрпБ ро╡ро▓рооро╛роХ 9 роорпБро▒рпИ роЪрпБро▒рпНро▒ ро╡рпЗрогрпНроЯрпБроорпН',
                'роТро░рпБ рокро╛родрпНродро┐ро░родрпНродро┐ро▓рпН рокрпЛроЯ ро╡рпЗрогрпНроЯрпБроорпН'
              ]
            },
            {
              title: 'ЁЯМ▒ роорпБро│рпИрокрпНрокро╛ро░ро┐',
              type: 'method',
              content: [
                'роТро░рпБ роЪроЯрпНроЯро┐ропро┐ро▓рпН роорогро▓рпН роЗроЯрпНроЯрпБ родро╛ройро┐ропроЩрпНроХро│рпИрокрпН рокрпЛроЯ ро╡рпЗрогрпНроЯрпБроорпН',
                '3 роиро╛роЯрпНроХро│ро┐ро▓рпН роорпБро│рпИроХрпНроХ ро╡рпЗрогрпНроЯрпБроорпН',
                'роорпБро│рпИродрпНрод рокро┐ро▒роХрпБ роЪрпБродрпНродрооро╛рой роЗроЯродрпНродро┐ро▓рпН рокрпЛроЯ ро╡рпЗрогрпНроЯрпБроорпН'
              ]
            }
          ],
          benefits: 'тЬи роиро╡роХро┐ро░роХ родрпЛро╖роорпН ро╡ро┐ро▓роХрпБроорпН, роХроЯройрпН родрпАро░рпБроорпН, рокрогрокрпНрокрпБро┤роХрпНроХроорпН роЪрпАро░ро╛роХрпБроорпН'
        }
      ]
    },
    {
      key: 'health',
      icon: 'ЁЯПе',
      title: 'роирпЛропрпН роиро┐ро╡ро╛ро░рогроорпН',
      remedies: [
        {
          title: '1. роХрпБро│ро┐роХрпНроХрпБроорпН роорпБро▒рпИ рокро░ро┐роХро╛ро░роорпН',
          subtitle: 'роЪро┐ро╡рокрпЖро░рпБрооро╛ройро┐ройрпН роЕро░рпБро│рпИрокрпН рокрпЖро▒ роЪро┐ро▒рокрпНрокрпБ роХрпБро│ро┐ропро▓рпН роорпБро▒рпИ',
          tags: ['роирпЛропрпН', 'роХрпБро│ро┐ропро▓рпН', 'роЪро┐ро╡ройрпН', 'роЕро░рпБро│рпН', 'health', 'bathing', 'shiva', 'blessing'],
          sections: [
            {
              title: 'ЁЯЫНя╕П родрпЗро╡рпИропро╛рой рокрпКро░рпБроЯрпНроХро│рпН',
              type: 'method',
              content: [
                'ро╡рпЖро│рпНро│рпИ роОро│рпН - 1 роХрпИрокрпНрокро┐роЯро┐',
                'роХроЯрпБроХрпБ - 1 родрпЗроХрпНроХро░рогрпНроЯро┐',
                'рокрпБроЩрпНроХройрпН роЗро▓рпИ - 7 роЗро▓рпИроХро│рпН',
                'родрпАрокроорпН роПро▒рпНро▒ роОрогрпНрогрпЖропрпН'
              ]
            },
            {
              title: 'ЁЯУЛ роЪрпЖропрпНроорпБро▒рпИ',
              type: 'method',
              content: [
                'родро┐роЩрпНроХроЯрпНроХро┐ро┤роорпИ роЕройрпНро▒рпБ роХро╛ро▓рпИ 5 роорогро┐роХрпНроХрпБ роОро┤рпБроирпНродрпБ',
                'роЕройрпИродрпНродрпБ рокрпКро░рпБроЯрпНроХро│рпИропрпБроорпН родрогрпНрогрпАро░ро┐ро▓рпН роХро▓роХрпНроХ ро╡рпЗрогрпНроЯрпБроорпН',
                'роЪро┐ро╡ройрпИ ро╡ро┤ро┐рокроЯрпНроЯрпБ ро╡ро┐роЯрпНроЯрпБ роХрпБро│ро┐роХрпНроХ ро╡рпЗрогрпНроЯрпБроорпН',
                '21 роиро╛роЯрпНроХро│рпН родрпКроЯро░рпНроирпНродрпБ роЪрпЖропрпНроп ро╡рпЗрогрпНроЯрпБроорпН'
              ]
            }
          ],
          benefits: 'ЁЯХЙя╕П роЕройрпИродрпНродрпБ ро╡роХрпИ роирпЛропрпНроХро│рпБроорпН роХрпБрогрооро╛роХрпБроорпН, роЪро┐ро╡ройро┐ройрпН роЕро░рпБро│рпН роХро┐роЯрпИроХрпНроХрпБроорпН'
        }
      ]
    },
    {
      key: 'prosperity',
      icon: 'ЁЯМЯ',
      title: 'роЪрпЖро▓рпНро╡роорпН & ро╡ро│ро░рпНроЪрпНроЪро┐',
      remedies: [
        {
          title: '1. родроЯрпИ роирпАроХрпНроХ роЗроЮрпНроЪро┐ рокро░ро┐роХро╛ро░роорпН',
          subtitle: 'ро╡ро┐ро░рпИро╡ро┐ро▓рпН рокрогроорпН ро╡ро░ роЗроЮрпНроЪро┐ропрпИроХрпН роХрпКрогрпНроЯ роЕро▒рпНрокрпБрод рокро░ро┐роХро╛ро░роорпН',
          tags: ['роЗроЮрпНроЪро┐', 'рокрогроорпН', 'родроЯрпИ роирпАроХрпНроХроорпН', 'роЪрпЖро▓рпНро╡роорпН', 'ginger', 'money', 'obstacle removal', 'prosperity'],
          sections: [
            {
              title: 'ЁЯЫНя╕П родрпЗро╡рпИропро╛рой рокрпКро░рпБроЯрпНроХро│рпН',
              type: 'method',
              content: [
                'рокрпБродро┐роп роЗроЮрпНроЪро┐ - 1 родрпБрогрпНроЯрпБ',
                'роороЮрпНроЪро│рпН родрпВро│рпН',
                'роХрпБроЩрпНроХрпБроороорпН',
                'ро╡рпЖро│рпНро│ро┐ роиро╛рогропроорпН роЕро▓рпНро▓родрпБ ро╡рпЖро│рпНро│ро┐ ро╡ро│рпИропро▓рпН'
              ]
            },
            {
              title: 'ЁЯУЛ роЪрпЖропрпНроорпБро▒рпИ',
              type: 'method',
              content: [
                'ро╡рпЖро│рпНро│ро┐роХрпНроХро┐ро┤роорпИ роЕройрпНро▒рпБ роХро╛ро▓рпИ роОро┤рпБроирпНродрпБ',
                'роЗроЮрпНроЪро┐ропро┐ро▓рпН роороЮрпНроЪро│рпН, роХрпБроЩрпНроХрпБроороорпН родроЯро╡ ро╡рпЗрогрпНроЯрпБроорпН',
                'рокрогрокрпНрокрпИропро┐ро▓рпН ро╡рпЖро│рпНро│ро┐ роиро╛рогропродрпНродрпБроЯройрпН ро╡рпИроХрпНроХ ро╡рпЗрогрпНроЯрпБроорпН',
                '7 роиро╛роЯрпНроХро│рпН роХро┤ро┐родрпНродрпБ рооро╛ро▒рпНро▒ ро╡рпЗрогрпНроЯрпБроорпН'
              ]
            }
          ],
          benefits: 'ЁЯТ╕ ро╡ро┐ро░рпИро╡ро┐ро▓рпН рокрогроорпН ро╡ро░рпБроорпН, родроЯрпИроХро│рпН ро╡ро┐ро▓роХрпБроорпН, ро╡ро┐ропро╛рокро╛ро░роорпН роиройрпНро▒ро╛роХ роироЯроХрпНроХрпБроорпН'
        },
        {
          title: '2. рокрогрокрпНрокрпИропро┐ро▓рпН ро╡рпИроХрпНроХрпБроорпН рокро░ро┐роХро╛ро░роорпН',
          subtitle: 'рокрогрокрпНрокрпИропро┐ро▓рпН ро╡рпИродрпНродрпБ роЪрпЖро▓рпНро▓ ро╡рпЗрогрпНроЯро┐роп роЪро┐ро▒рокрпНрокрпБ рокрпКро░рпБроЯрпНроХро│рпН',
          tags: ['рокрогрокрпНрокрпИ', 'роЪрпЖро▓рпНро╡роорпН', 'ро▓роЯрпНроЪрпБрооро┐', 'роХро╛роЪрпБ', 'wallet', 'wealth', 'lakshmi', 'money'],
          sections: [
            {
              title: 'ЁЯЫНя╕П рокрогрокрпНрокрпИропро┐ро▓рпН ро╡рпИроХрпНроХ ро╡рпЗрогрпНроЯро┐ропро╡рпИ',
              type: 'method',
              content: [
                'роХрпЛроородро┐ роЪроХрпНроХро░роорпН - 1',
                'ро╕рпНро░рпА ропроирпНродро┐ро░роорпН - роЪро┐ро▒ро┐роп роЕро│ро╡рпБ',
                'роороЮрпНроЪро│рпН родрпБрогрпНроЯрпБ',
                'родрпБро│роЪро┐ роЗро▓рпИ - роЙро▓ро░рпНроирпНродродрпБ'
              ]
            },
            {
              title: 'ЁЯУЛ ро╡ро┐родро┐роХро│рпН',
              type: 'method',
              content: [
                'ро╡рпЖро│рпНро│ро┐роХрпНроХро┐ро┤роорпИ роЕройрпНро▒рпБ рокрогрокрпНрокрпИропро┐ро▓рпН ро╡рпИроХрпНроХ ро╡рпЗрогрпНроЯрпБроорпН',
                'роТро╡рпНро╡рпКро░рпБ рооро╛родроорпБроорпН рокрпБродрпБрокрпНрокро┐роХрпНроХ ро╡рпЗрогрпНроЯрпБроорпН',
                'рокрогрокрпНрокрпИропрпИ роЪрпБродрпНродрооро╛роХ ро╡рпИроХрпНроХ ро╡рпЗрогрпНроЯрпБроорпН',
                'роХро┐ро┤ро┐роирпНрод роирпЛроЯрпНроЯрпБроХро│рпИ ро╡рпИроХрпНроХроХрпН роХрпВроЯро╛родрпБ'
              ]
            }
          ],
          benefits: 'ЁЯТ░ роОрокрпНрокрпЛродрпБроорпН рокрогроорпН роЗро░рпБроХрпНроХрпБроорпН, ро╡ро░рпБрооро╛ройроорпН роЕродро┐роХро░ро┐роХрпНроХрпБроорпН, ро▓роЯрпНроЪрпБрооро┐ роХроЯро╛роЯрпНроЪроорпН роХро┐роЯрпИроХрпНроХрпБроорпН'
        }
      ]
    },
    {
      key: 'career',
      icon: 'ЁЯПЫя╕П',
      title: 'роЕро░роЪрпБ ро╡рпЗро▓рпИ ро╡рпЖро▒рпНро▒ро┐',
      remedies: [
        {
          title: '1. роЕро░роЪрпБ ро╡рпЗро▓рпИ рокро░ро┐роХро╛ро░роорпН',
          subtitle: 'роЕро░роЪрпБ ро╡рпЗро▓рпИ роХро┐роЯрпИроХрпНроХ роЪро┐ро▒рокрпНрокрпБ рокро░ро┐роХро╛ро░ роорпБро▒рпИ',
          tags: ['роЕро░роЪрпБ ро╡рпЗро▓рпИ', 'ро╡рпЖро▒рпНро▒ро┐', 'родрпЗро░рпНро╡рпБ', 'роЪройро┐', 'government job', 'success', 'exam', 'saturn'],
          sections: [
            {
              title: 'ЁЯЫНя╕П родрпЗро╡рпИропро╛рой рокрпКро░рпБроЯрпНроХро│рпН',
              type: 'method',
              content: [
                'роХро░рпБрокрпНрокрпБ роОро│рпН - 1 роХрокрпН',
                'роЗро░рпБроорпНрокрпБ рокро╛родрпНродро┐ро░роорпН',
                'роЪройро┐роХрпНроХро┐ро┤роорпИ ро╡рпЗрокрпНрок роОрогрпНрогрпЖропрпН',
                'роХро░рпБрокрпНрокрпБ роОро│рпН роЙрогрпНроЯрпИроХро│рпН'
              ]
            },
            {
              title: 'ЁЯУЛ роЪрпЖропрпНроорпБро▒рпИ',
              type: 'method',
              content: [
                'роЪройро┐роХрпНроХро┐ро┤роорпИ роЕройрпНро▒рпБ роХро╛ро▓рпИ роОро┤рпБроирпНродрпБ',
                'ро╣ройрпБрооро╛ройрпН роХрпЛро╡ро┐ро▓ро┐ро▓рпН роЪрпЖройрпНро▒рпБ',
                'роХро░рпБрокрпНрокрпБ роОро│рпНро│рпИ родро▓рпИроХрпНроХрпБ роорпЗро▓рпН 7 роорпБро▒рпИ роЪрпБро▒рпНро▒ро┐',
                'ро╡рпЗрокрпНрок роОрогрпНрогрпЖропрпН родрпАрокроорпН роПро▒рпНро▒ ро╡рпЗрогрпНроЯрпБроорпН'
              ]
            }
          ],
          benefits: 'ЁЯОп роЕро░роЪрпБ ро╡рпЗро▓рпИ роХро┐роЯрпИроХрпНроХрпБроорпН, родрпЗро░рпНро╡ро┐ро▓рпН ро╡рпЖро▒рпНро▒ро┐ рокрпЖро▒рпБро╡рпАро░рпНроХро│рпН, роЪройро┐ родрпЛро╖роорпН ро╡ро┐ро▓роХрпБроорпН'
        }
      ]
    }
  ];

  constructor(
    private toastController: ToastController,
    private alertController: AlertController
  ) { }

  ngOnInit() {
    this.checkBookmarkStatus();
  }

  checkBookmarkStatus() {
    const bookmarks = JSON.parse(localStorage.getItem('bookmarkedConcepts') || '[]');
    this.isBookmarked = bookmarks.includes('tantrik_001');
  }

  async toggleBookmark() {
    const bookmarks = JSON.parse(localStorage.getItem('bookmarkedConcepts') || '[]');
    
    if (this.isBookmarked) {
      const index = bookmarks.indexOf('tantrik_001');
      if (index > -1) {
        bookmarks.splice(index, 1);
      }
      this.isBookmarked = false;
      await this.showToast('Bookmark removed', 'warning');
    } else {
      bookmarks.push('tantrik_001');
      this.isBookmarked = true;
      await this.showToast('Bookmarked successfully', 'success');
    }
    
    localStorage.setItem('bookmarkedConcepts', JSON.stringify(bookmarks));
  }

  selectCategory(categoryKey: string) {
    this.selectedCategory = this.categories.find(cat => cat.key === categoryKey) || null;
    this.showCategoryView = false;
  }

  goBack() {
    this.showCategoryView = true;
    this.selectedCategory = null;
    this.searchTerm = '';
    this.searchResults = [];
  }

  toggleRemedy(remedy: Remedy) {
    remedy.expanded = !remedy.expanded;
  }

  searchRemedies(event: any) {
    const query = event.detail.value.toLowerCase().trim();
    this.searchResults = [];

    if (query.length < 2) {
      return;
    }

    this.categories.forEach(category => {
      category.remedies.forEach(remedy => {
        const matchingTags = remedy.tags.filter(tag => 
          tag.toLowerCase().includes(query)
        );

        if (matchingTags.length > 0 || 
            remedy.title.toLowerCase().includes(query) ||
            remedy.subtitle.toLowerCase().includes(query) ||
            remedy.benefits.toLowerCase().includes(query)) {
          
          this.searchResults.push({
            title: remedy.title,
            subtitle: remedy.subtitle,
            categoryTitle: category.title,
            categoryColor: this.getCategoryColor(category.key),
            matchingTags: matchingTags,
            benefits: remedy.benefits,
            remedy: remedy,
            category: category
          });
        }
      });
    });
  }

  selectSearchResult(result: SearchResult) {
    this.selectedCategory = result.category;
    this.showCategoryView = false;
    this.searchTerm = '';
    this.searchResults = [];
    
    // Expand the selected remedy
    result.remedy.expanded = true;
  }

  getCategoryColor(categoryKey: string): string {
    const colorMap: { [key: string]: string } = {
      'debt': 'success',
      'health': 'danger',
      'prosperity': 'warning',
      'career': 'tertiary'
    };
    return colorMap[categoryKey] || 'medium';
  }

  async bookConsultation() {
    const alert = await this.alertController.create({
      header: 'роиро┐рокрпБрогро░рпН роЖро▓рпЛроЪройрпИ',
      message: 'ро╡ро┐ро░рпИро╡ро┐ро▓рпН роЗроирпНрод роЪрпЗро╡рпИ роХро┐роЯрпИроХрпНроХрпБроорпН. роХрпВроЯрпБродро▓рпН ро╡ро┐ро╡ро░роЩрпНроХро│рпБроХрпНроХрпБ родрпКроЯро░рпНрокро┐ро▓рпН роЗро░рпБроЩрпНроХро│рпН.',
      buttons: ['роЪро░ро┐']
    });
    await alert.present();
  }

  async shareContent() {
    try {
      if ('share' in navigator) {
        await (navigator as any).share({
          title: 'родроирпНродро┐ро░ рокро░ро┐роХро╛ро░роорпН - Tantrik Pariharam',
          text: 'ро╡рпЗрод роЪро╛ро╕рпНродро┐ро░роЩрпНроХро│ро┐ройрпН ро░роХрж╕ро┐роп роЕроорпНроЪрооро╛рой родроирпНродро┐ро░ рокро░ро┐роХро╛ро░роЩрпНроХро│рпН',
          url: window.location.href,
        });
      } else {
        await this.showToast('Content link copied to clipboard', 'success');
      }
    } catch (error) {
      console.error('Error sharing content:', error);
    }
  }

  private async showToast(message: string, color: string) {
    const toast = await this.toastController.create({
      message: message,
      duration: 2000,
      color: color,
      position: 'bottom'
    });
    await toast.present();
  }
}
