import{a as Et,b as It,c as Tt,d as Pt}from"./chunk-INZWUBPP.js";import{a as Ut,b as Gt,c as zt,d as Jt,e as Kt,f as Qt,g as F}from"./chunk-SP3Z5TV7.js";import{a as Wt,b as Xt}from"./chunk-NI5FSVGM.js";import{a as Yt,b as Zt}from"./chunk-74LTD5PY.js";import{a as yt,b as Dt}from"./chunk-2ROSCVIC.js";import{a as ct,b as pt,c as dt,e as st,g as ft}from"./chunk-WWQZTZCX.js";import{a as Ft,b as Ot,c as Rt,d as Bt,e as Lt,f as $t,g as qt,h as jt,i as Vt,j as Ht,k as At}from"./chunk-OMNFHR7K.js";import{a as kt,b as wt}from"./chunk-NNROVGUN.js";import{b as vt,c as Nt,q as k,r as w}from"./chunk-HHRDAJVU.js";import"./chunk-NGDKZ7II.js";import{a as ut,b as gt,c as _t,e as Ct,h as ht,i as xt}from"./chunk-3Y56DFGH.js";import{Ab as u,Bb as G,Ca as r,Da as f,Gb as y,Ib as D,Kb as $,Lb as z,Mc as W,Oc as X,Qc as C,Sa as c,Sc as Y,Tc as Z,U as A,Ud as mt,Xa as l,Xc as tt,Yc as et,Z as U,Za as B,_c as it,ba as M,bd as ot,db as n,dc as E,de as lt,eb as o,ed as nt,fb as p,fd as at,gb as g,hb as _,hc as J,hd as rt,ja as v,jb as b,je as T,ka as N,kc as K,lc as I,le as Mt,mb as h,me as P,ne as bt,ob as S,oc as Q,oe as St,xb as L,yb as a}from"./chunk-L74P3D6T.js";import"./chunk-GAL4ENT6.js";var x=class e{constructor(t){this.http=t}apiUrl=`${W.apiUrl}/notifications`;getNotifications(){return this.http.get(this.apiUrl)}getNotificationById(t){return this.http.get(`${this.apiUrl}/${t}`)}getNotificationsByLoginId(t){return this.http.get(`${this.apiUrl}/user/${t}`)}createNotification(t){return this.http.post(this.apiUrl,t)}updateNotification(t,i){return this.http.put(`${this.apiUrl}/${t}`,i)}deleteNotification(t){return this.http.delete(`${this.apiUrl}/${t}`)}static \u0275fac=function(i){return new(i||e)(U(Q))};static \u0275prov=A({token:e,factory:e.\u0275fac,providedIn:"root"})};function me(e,t){e&1&&(n(0,"mat-error"),a(1," Login ID is required "),o())}function le(e,t){e&1&&(n(0,"mat-error"),a(1," Title is required "),o())}function ce(e,t){e&1&&(n(0,"mat-error"),a(1," Message is required "),o())}function pe(e,t){e&1&&(n(0,"mat-error"),a(1," Notification type is required "),o())}var O=class e{constructor(t,i,m,d,s){this.fb=t;this.notificationService=i;this.snackBar=m;this.dialogRef=d;this.data=s;this.editMode=!!s?.notification,this.notificationForm=this.createForm(),this.editMode&&s.notification&&this.populateForm(s.notification)}notificationForm;editMode=!1;isLoading=!1;createForm(){return this.fb.group({loginId:["",[C.required,C.min(1)]],title:["",[C.required,C.minLength(3)]],message:["",[C.required,C.minLength(10)]],notificationType:["push",C.required],startDate:[""],expiryDate:[""],isRead:[!1]})}populateForm(t){this.notificationForm.patchValue({loginId:t.loginId,title:t.title,message:t.message,notificationType:t.notificationType||"push",startDate:t.startDate?new Date(t.startDate):"",expiryDate:t.expiryDate?new Date(t.expiryDate):"",isRead:t.isRead||!1})}onSubmit(){if(this.notificationForm.valid&&!this.isLoading){this.isLoading=!0;let t=this.notificationForm.value,i={loginId:t.loginId,title:t.title,message:t.message,notificationType:t.notificationType,startDate:t.startDate?t.startDate.toISOString().split("T")[0]:void 0,expiryDate:t.expiryDate?t.expiryDate.toISOString().split("T")[0]:void 0,isRead:t.isRead};this.editMode&&this.data.notification?(i.notificationId=this.data.notification.notificationId,this.updateNotification(i)):this.createNotification(i)}}createNotification(t){this.notificationService.createNotification(t).subscribe({next:i=>{this.snackBar.open("Notification created successfully","Close",{duration:3e3}),this.dialogRef.close(i)},error:i=>{console.error("Error creating notification:",i),this.snackBar.open("Error creating notification","Close",{duration:3e3}),this.isLoading=!1}})}updateNotification(t){this.notificationService.updateNotification(t.notificationId,t).subscribe({next:i=>{this.snackBar.open("Notification updated successfully","Close",{duration:3e3}),this.dialogRef.close(i)},error:i=>{console.error("Error updating notification:",i),this.snackBar.open("Error updating notification","Close",{duration:3e3}),this.isLoading=!1}})}static \u0275fac=function(i){return new(i||e)(f(at),f(x),f(k),f(Ut),f(Gt))};static \u0275cmp=M({type:e,selectors:[["app-notification-form"]],standalone:!0,features:[y],decls:54,vars:12,consts:[["startPicker",""],["expiryPicker",""],["mat-dialog-title",""],[3,"ngSubmit","formGroup"],["appearance","fill",1,"full-width"],["matInput","","formControlName","loginId","type","number","required",""],[4,"ngIf"],["matInput","","formControlName","title","required",""],["matInput","","formControlName","message","rows","4","required",""],["formControlName","notificationType","required",""],["value","push"],["value","email"],["matInput","","formControlName","startDate",3,"matDatepicker"],["matSuffix","",3,"for"],["matInput","","formControlName","expiryDate",3,"matDatepicker"],[1,"checkbox-container"],["formControlName","isRead"],[1,"button-container"],["mat-button","","type","button","mat-dialog-close",""],["mat-raised-button","","color","primary","type","submit",3,"disabled"]],template:function(i,m){if(i&1){let d=b();n(0,"h2",2),a(1),o(),n(2,"mat-dialog-content")(3,"form",3),h("ngSubmit",function(){return v(d),N(m.onSubmit())}),n(4,"mat-form-field",4)(5,"mat-label"),a(6,"Login ID"),o(),p(7,"input",5),c(8,me,2,0,"mat-error",6),o(),n(9,"mat-form-field",4)(10,"mat-label"),a(11,"Title"),o(),p(12,"input",7),c(13,le,2,0,"mat-error",6),o(),n(14,"mat-form-field",4)(15,"mat-label"),a(16,"Message"),o(),p(17,"textarea",8),c(18,ce,2,0,"mat-error",6),o(),n(19,"mat-form-field",4)(20,"mat-label"),a(21,"Notification Type"),o(),n(22,"mat-select",9)(23,"mat-option",10),a(24,"Push Notification"),o(),n(25,"mat-option",11),a(26,"Email"),o()(),c(27,pe,2,0,"mat-error",6),o(),n(28,"mat-form-field",4)(29,"mat-label"),a(30,"Start Date"),o(),p(31,"input",12),n(32,"mat-hint"),a(33,"Leave empty for immediate delivery"),o(),p(34,"mat-datepicker-toggle",13)(35,"mat-datepicker",null,0),o(),n(37,"mat-form-field",4)(38,"mat-label"),a(39,"Expiry Date"),o(),p(40,"input",14),n(41,"mat-hint"),a(42,"Leave empty for no expiry"),o(),p(43,"mat-datepicker-toggle",13)(44,"mat-datepicker",null,1),o(),n(46,"div",15)(47,"mat-checkbox",16),a(48,"Mark as Read"),o()(),n(49,"div",17)(50,"button",18),a(51,"Cancel"),o(),n(52,"button",19),a(53),o()()()()}if(i&2){let d,s,q,j,V=L(36),H=L(45);r(),u("",m.editMode?"Edit":"Create"," Notification"),r(2),l("formGroup",m.notificationForm),r(5),l("ngIf",(d=m.notificationForm.get("loginId"))==null?null:d.hasError("required")),r(5),l("ngIf",(s=m.notificationForm.get("title"))==null?null:s.hasError("required")),r(5),l("ngIf",(q=m.notificationForm.get("message"))==null?null:q.hasError("required")),r(9),l("ngIf",(j=m.notificationForm.get("notificationType"))==null?null:j.hasError("required")),r(4),l("matDatepicker",V),r(3),l("for",V),r(6),l("matDatepicker",H),r(3),l("for",H),r(9),l("disabled",m.notificationForm.invalid||m.isLoading),r(),u(" ",m.isLoading?"Saving...":m.editMode?"Update":"Create"," ")}},dependencies:[I,E,rt,tt,X,et,Y,Z,nt,it,ot,xt,ht,ut,_t,gt,Ct,Nt,vt,wt,kt,lt,P,T,F,Jt,Kt,Qt,w,Pt,Et,It,Tt,mt,Xt,Wt],styles:[".full-width[_ngcontent-%COMP%]{width:100%;margin-bottom:15px}.checkbox-container[_ngcontent-%COMP%]{margin:16px 0}.button-container[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:8px;margin-top:16px}mat-dialog-content[_ngcontent-%COMP%]{min-width:500px;max-width:600px}"]})};function de(e,t){e&1&&(n(0,"th",22),a(1," Login ID "),o())}function se(e,t){if(e&1&&(n(0,"td",23),a(1),o()),e&2){let i=t.$implicit;r(),u(" ",i.loginId," ")}}function fe(e,t){e&1&&(n(0,"th",22),a(1," Title "),o())}function ue(e,t){if(e&1&&(n(0,"td",23),a(1),o()),e&2){let i=t.$implicit;r(),u(" ",i.title," ")}}function ge(e,t){e&1&&(n(0,"th",22),a(1," Message "),o())}function _e(e,t){if(e&1&&(n(0,"td",23)(1,"span",24),a(2),D(3,"slice"),o()()),e&2){let i=t.$implicit;r(),l("matTooltip",i.message),r(),G(" ",z(3,3,i.message,0,50),"",i.message.length>50?"...":""," ")}}function Ce(e,t){e&1&&(n(0,"th",22),a(1," Type "),o())}function he(e,t){if(e&1&&(n(0,"td",23)(1,"span",25),a(2),o()()),e&2){let i=t.$implicit;r(),B("type-push",i.notificationType==="push")("type-email",i.notificationType==="email"),r(),u(" ",i.notificationType||"push"," ")}}function xe(e,t){e&1&&(n(0,"th",22),a(1," Start Date "),o())}function ve(e,t){if(e&1&&(n(0,"td",23),a(1),D(2,"date"),o()),e&2){let i=t.$implicit;r(),u(" ",i.startDate?$(2,1,i.startDate,"short"):"Immediate"," ")}}function Ne(e,t){e&1&&(n(0,"th",22),a(1," Expiry Date "),o())}function Me(e,t){if(e&1&&(n(0,"td",23),a(1),D(2,"date"),o()),e&2){let i=t.$implicit;r(),u(" ",i.expiryDate?$(2,1,i.expiryDate,"short"):"No expiry"," ")}}function be(e,t){e&1&&(n(0,"th",22),a(1," Status "),o())}function Se(e,t){if(e&1&&(n(0,"td",23)(1,"span",26),a(2),o()()),e&2){let i=t.$implicit;r(),B("read",i.isRead)("unread",!i.isRead),r(),u(" ",i.isRead?"Read":"Unread"," ")}}function ye(e,t){e&1&&(n(0,"th",22),a(1," Actions "),o())}function De(e,t){if(e&1){let i=b();n(0,"td",23)(1,"button",27),h("click",function(){let d=v(i).$implicit,s=S(2);return N(s.openNotificationForm(d))}),n(2,"mat-icon"),a(3,"edit"),o()(),n(4,"button",28),h("click",function(){let d=v(i).$implicit,s=S(2);return N(s.deleteNotification(d))}),n(5,"mat-icon"),a(6,"delete"),o()()()}}function Ee(e,t){e&1&&p(0,"tr",29)}function Ie(e,t){e&1&&p(0,"tr",30)}function Te(e,t){e&1&&(n(0,"div",31)(1,"mat-icon"),a(2,"notifications_off"),o(),n(3,"p"),a(4,"No notifications found."),o()())}function Pe(e,t){if(e&1&&(n(0,"div",7)(1,"table",8),g(2,9),c(3,de,2,0,"th",10)(4,se,2,1,"td",11),_(),g(5,12),c(6,fe,2,0,"th",10)(7,ue,2,1,"td",11),_(),g(8,13),c(9,ge,2,0,"th",10)(10,_e,4,7,"td",11),_(),g(11,14),c(12,Ce,2,0,"th",10)(13,he,3,5,"td",11),_(),g(14,15),c(15,xe,2,0,"th",10)(16,ve,3,4,"td",11),_(),g(17,16),c(18,Ne,2,0,"th",10)(19,Me,3,4,"td",11),_(),g(20,17),c(21,be,2,0,"th",10)(22,Se,3,5,"td",11),_(),g(23,18),c(24,ye,2,0,"th",10)(25,De,7,0,"td",11),_(),c(26,Ee,1,0,"tr",19)(27,Ie,1,0,"tr",20),o(),c(28,Te,5,0,"div",21),o()),e&2){let i=S();r(),l("dataSource",i.notifications),r(25),l("matHeaderRowDef",i.displayedColumns),r(),l("matRowDefColumns",i.displayedColumns),r(),l("ngIf",i.notifications.length===0)}}function ke(e,t){e&1&&(n(0,"div",32),p(1,"mat-spinner",33),n(2,"p"),a(3,"Loading notifications..."),o()())}var R=class e{constructor(t,i,m){this.notificationService=t;this.dialog=i;this.snackBar=m}notifications=[];displayedColumns=["loginId","title","message","notificationType","startDate","expiryDate","isRead","actions"];isLoading=!1;ngOnInit(){this.loadNotifications()}loadNotifications(){this.isLoading=!0,this.notificationService.getNotifications().subscribe({next:t=>{this.notifications=t,this.isLoading=!1},error:t=>{console.error("Error loading notifications:",t),this.snackBar.open("Error loading notifications","Close",{duration:3e3}),this.isLoading=!1}})}openNotificationForm(t){this.dialog.open(O,{width:"600px",data:{notification:t}}).afterClosed().subscribe(m=>{m&&this.loadNotifications()})}deleteNotification(t){confirm(`Are you sure you want to delete the notification "${t.title}"?`)&&this.notificationService.deleteNotification(t.notificationId).subscribe({next:()=>{this.snackBar.open("Notification deleted successfully","Close",{duration:3e3}),this.loadNotifications()},error:i=>{console.error("Error deleting notification:",i),this.snackBar.open("Error deleting notification","Close",{duration:3e3})}})}static \u0275fac=function(i){return new(i||e)(f(x),f(zt),f(k))};static \u0275cmp=M({type:e,selectors:[["app-notifications-page"]],standalone:!0,features:[y],decls:18,vars:2,consts:[[1,"container"],[1,"header-content"],[1,"header-actions"],["mat-icon-button","","color","primary","matTooltip","Refresh notifications",3,"click"],["mat-raised-button","","color","primary",3,"click"],["class","table-container",4,"ngIf"],["class","loading-container",4,"ngIf"],[1,"table-container"],["mat-table","",1,"mat-elevation-z2",3,"dataSource"],["matColumnDef","loginId"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","title"],["matColumnDef","message"],["matColumnDef","notificationType"],["matColumnDef","startDate"],["matColumnDef","expiryDate"],["matColumnDef","isRead"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["class","no-data",4,"ngIf"],["mat-header-cell",""],["mat-cell",""],[1,"message-preview",3,"matTooltip"],[1,"type-badge"],[1,"status-badge"],["mat-icon-button","","color","primary","matTooltip","Edit notification",3,"click"],["mat-icon-button","","color","warn","matTooltip","Delete notification",3,"click"],["mat-header-row",""],["mat-row",""],[1,"no-data"],[1,"loading-container"],["diameter","50"]],template:function(i,m){i&1&&(n(0,"div",0)(1,"mat-card")(2,"mat-card-header")(3,"mat-card-title")(4,"div",1)(5,"h2"),a(6,"Manage Notifications"),o(),n(7,"div",2)(8,"button",3),h("click",function(){return m.loadNotifications()}),n(9,"mat-icon"),a(10,"refresh"),o()(),n(11,"button",4),h("click",function(){return m.openNotificationForm()}),n(12,"mat-icon"),a(13,"add"),o(),a(14," Add New Notification "),o()()()()(),n(15,"mat-card-content"),c(16,Pe,29,4,"div",5)(17,ke,4,0,"div",6),o()()()),i&2&&(r(16),l("ngIf",!m.isLoading),r(),l("ngIf",m.isLoading))},dependencies:[I,E,K,J,At,Ft,Rt,qt,Bt,Ot,jt,Lt,$t,Vt,Ht,P,T,Mt,St,bt,w,F,ft,ct,dt,st,pt,Zt,Yt,Dt,yt],styles:[".container[_ngcontent-%COMP%]{padding:20px;max-width:1400px;margin:0 auto}.header-content[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;width:100%}.header-content[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;color:#333}.header-actions[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px}.table-container[_ngcontent-%COMP%]{overflow-x:auto;margin-top:20px}.mat-mdc-table[_ngcontent-%COMP%]{width:100%;background:#fff}.message-preview[_ngcontent-%COMP%]{display:inline-block;max-width:200px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;cursor:help}.type-badge[_ngcontent-%COMP%]{padding:4px 8px;border-radius:12px;font-size:12px;font-weight:500;text-transform:uppercase}.type-push[_ngcontent-%COMP%]{background-color:#e3f2fd;color:#1976d2}.type-email[_ngcontent-%COMP%]{background-color:#f3e5f5;color:#7b1fa2}.status-badge[_ngcontent-%COMP%]{padding:4px 8px;border-radius:12px;font-size:12px;font-weight:500;text-transform:uppercase}.read[_ngcontent-%COMP%]{background-color:#e8f5e8;color:#2e7d32}.unread[_ngcontent-%COMP%]{background-color:#fff3e0;color:#f57c00}.mat-mdc-cell[_ngcontent-%COMP%]{padding:8px}.mat-mdc-header-cell[_ngcontent-%COMP%]{font-weight:600;color:#333}.loading-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:40px;color:#666}.loading-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-top:16px;font-size:14px}.no-data[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:40px;color:#666}.no-data[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:48px;height:48px;width:48px;margin-bottom:16px}"]})};var Mi=[{path:"",component:R,title:"Notifications"}];export{Mi as NOTIFICATIONS_ROUTES};
