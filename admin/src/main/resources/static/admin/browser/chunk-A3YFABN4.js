import{a as Mt}from"./chunk-2DHXFBW7.js";import{a as ke,b as U}from"./chunk-HAVPMYEQ.js";import{a as St}from"./chunk-FSSHUOUS.js";import{a as ot,b as ye}from"./chunk-VBNLKD6U.js";import{a as xt,b as ht}from"./chunk-AUNNH457.js";import{a as j,b as $}from"./chunk-OZIBLGHY.js";import{a as xe,c as he}from"./chunk-5HYQUAWU.js";import{a as vt,b as Ct,c as kt}from"./chunk-2CMLN76B.js";import{a as A,b as F,c as D,e as V,g as B}from"./chunk-ZNL3IKF2.js";import{a as oe,c as L,d as ae}from"./chunk-FQ67QF65.js";import{a as _t,b as yt}from"./chunk-RNMBNA6J.js";import{a as at,b as rt,c as lt,d as st,e as ct,f as dt,g as mt,h as pt,i as gt,j as ut,k as ft,l as ve,m as Ce}from"./chunk-LZWXBBKL.js";import{b as pe,c as ge,d as E,e as H}from"./chunk-PNTWHU5I.js";import{l as fe,m as _e}from"./chunk-BYQJPZHC.js";import"./chunk-EFSOZXE7.js";import{a as ce,b as tt,c as nt,e as it,h as de,i as me}from"./chunk-TGCRKVSN.js";import{$ as Fe,$c as je,Ab as De,Bb as a,Ca as Ie,Cb as g,Db as y,Ea as r,Fa as f,Fb as ee,Gb as te,Hb as ne,Jb as P,Kb as Te,Lb as ie,Mb as Q,Nb as Ve,O as Le,Ob as Pe,Sc as re,Ua as m,Uc as I,V as Ae,Wc as le,Xc as Re,Za as s,_c as ze,ad as $e,bb as X,ca as T,cd as He,dd as Ue,ed as We,fc as Be,fd as Ge,gb as o,gc as O,gd as Qe,hb as n,hc as K,hd as Ze,he as se,ib as x,id as Ye,jb as k,jc as Ne,jd as Je,ka as h,kb as M,kd as Xe,la as v,lc as qe,ld as et,mb as S,ne as N,p as we,pb as _,pc as w,pe as ue,qe as q,rb as p,re as R,se as z}from"./chunk-7VMAUSLR.js";import{a as Y,b as J,g as G}from"./chunk-GAL4ENT6.js";var zt=()=>[],jt=()=>[5,10,20,50],$t=i=>["/keynotes",i];function Ht(i,e){if(i&1&&(o(0,"mat-option",17),a(1),n()),i&2){let t=e.$implicit;s("value",t.lessonId),r(),y(" ",t.title," ")}}function Ut(i,e){i&1&&(o(0,"div",18),x(1,"mat-spinner"),n())}function Wt(i,e){i&1&&(o(0,"th",34),a(1,"ID"),n())}function Gt(i,e){if(i&1&&(o(0,"td",35)(1,"span",36),a(2),n()()),i&2){let t=e.$implicit;r(2),g(t.keynoteId)}}function Qt(i,e){i&1&&(o(0,"th",34),a(1,"Order"),n())}function Zt(i,e){if(i&1&&(o(0,"td",35)(1,"span",37),a(2),n()()),i&2){let t=e.$implicit;r(2),g(t.orderSequence)}}function Yt(i,e){i&1&&(o(0,"th",34),a(1,"Title"),n())}function Jt(i,e){i&1&&(o(0,"mat-icon",41),a(1,"star"),n())}function Xt(i,e){if(i&1&&(o(0,"td",35)(1,"div",38)(2,"span",39),a(3),n(),m(4,Jt,2,0,"mat-icon",40),n()()),i&2){let t=e.$implicit;r(3),g(t.title),r(),s("ngIf",t.isImportant)}}function en(i,e){i&1&&(o(0,"th",34),a(1,"Lesson"),n())}function tn(i,e){if(i&1&&(o(0,"span",45),a(1),n()),i&2){let t=p().$implicit;r(),g(t.topicTitle)}}function nn(i,e){if(i&1&&(o(0,"td",35)(1,"div",42)(2,"span",43),a(3),n(),m(4,tn,2,1,"span",44),n()()),i&2){let t=e.$implicit;r(3),g(t.lessonTitle),r(),s("ngIf",t.topicTitle)}}function on(i,e){i&1&&(o(0,"th",34),a(1,"Type"),n())}function an(i,e){if(i&1&&(o(0,"td",35)(1,"mat-chip"),a(2),n()()),i&2){let t=e.$implicit,l=p(2);r(),X("content-type-chip content-type-",t.contentType,""),r(),y(" ",l.getContentTypeLabel(t.contentType)," ")}}function rn(i,e){i&1&&(o(0,"th",34),a(1,"Content Preview"),n())}function ln(i,e){if(i&1&&(o(0,"td",35)(1,"div",46),a(2),n()()),i&2){let t=e.$implicit;r(),s("matTooltip",t.content),r(),y(" ",t.content.length>100?t.content.substring(0,100)+"...":t.content," ")}}function sn(i,e){i&1&&(o(0,"th",34),a(1,"Features"),n())}function cn(i,e){i&1&&(o(0,"mat-chip",51)(1,"mat-icon"),a(2,"image"),n(),a(3," Visual Aid "),n())}function dn(i,e){if(i&1&&(o(0,"mat-chip",52),a(1),n()),i&2){let t=p().$implicit;r(),y(" ",t.relatedPlanet," ")}}function mn(i,e){if(i&1&&(o(0,"mat-chip",53),a(1),n()),i&2){let t=p().$implicit;r(),y(" ",t.relatedZodiac," ")}}function pn(i,e){if(i&1&&(o(0,"td",35)(1,"div",47),m(2,cn,4,0,"mat-chip",48)(3,dn,2,1,"mat-chip",49)(4,mn,2,1,"mat-chip",50),n()()),i&2){let t=e.$implicit;r(2),s("ngIf",t.hasVisualAid),r(),s("ngIf",t.relatedPlanet),r(),s("ngIf",t.relatedZodiac)}}function gn(i,e){i&1&&(o(0,"th",34),a(1,"Actions"),n())}function un(i,e){if(i&1){let t=S();o(0,"td",35)(1,"button",54)(2,"mat-icon"),a(3,"visibility"),n()(),o(4,"button",55),_("click",function(){let c=h(t).$implicit,d=p(2);return v(d.editKeynote(c.keynoteId))}),o(5,"mat-icon"),a(6,"edit"),n()(),o(7,"button",56),_("click",function(){let c=h(t).$implicit,d=p(2);return v(d.deleteKeynote(c))}),o(8,"mat-icon"),a(9,"delete"),n()()()}if(i&2){let t=e.$implicit;r(),s("routerLink",ie(1,$t,t.keynoteId))}}function fn(i,e){i&1&&x(0,"tr",57)}function _n(i,e){i&1&&x(0,"tr",58)}function yn(i,e){i&1&&(o(0,"div",59)(1,"mat-icon"),a(2,"note_alt"),n(),o(3,"p"),a(4,"No keynotes found"),n(),o(5,"button",2),a(6," Add First Keynote "),n()())}function xn(i,e){if(i&1){let t=S();o(0,"div")(1,"table",19),k(2,20),m(3,Wt,2,0,"th",21)(4,Gt,3,1,"td",22),M(),k(5,23),m(6,Qt,2,0,"th",21)(7,Zt,3,1,"td",22),M(),k(8,24),m(9,Yt,2,0,"th",21)(10,Xt,5,2,"td",22),M(),k(11,25),m(12,en,2,0,"th",21)(13,nn,5,2,"td",22),M(),k(14,26),m(15,on,2,0,"th",21)(16,an,3,4,"td",22),M(),k(17,27),m(18,rn,2,0,"th",21)(19,ln,3,2,"td",22),M(),k(20,28),m(21,sn,2,0,"th",21)(22,pn,5,3,"td",22),M(),k(23,29),m(24,gn,2,0,"th",21)(25,un,10,3,"td",22),M(),m(26,fn,1,0,"tr",30)(27,_n,1,0,"tr",31),n(),o(28,"mat-paginator",32),_("page",function(c){h(t);let d=p();return v(d.onPageChange(c))}),n(),m(29,yn,7,0,"div",33),n()}if(i&2){let t=p();r(),s("dataSource",t.keynotes||Te(7,zt)),r(25),s("matHeaderRowDef",t.displayedColumns),r(),s("matRowDefColumns",t.displayedColumns),r(),s("length",t.totalKeynotes||0)("pageSize",t.pageSize)("pageSizeOptions",Te(8,jt)),r(),s("ngIf",((t.keynotes==null?null:t.keynotes.length)||0)===0)}}var Me=class i{constructor(e,t,l,c){this.keynoteService=e;this.lessonService=t;this.router=l;this.snackBar=c}keynotes=[];totalKeynotes=0;pageSize=10;pageIndex=0;lessons=[];displayedColumns=["id","order","title","lesson","contentType","content","features","actions"];loading=!1;searchQuery="";selectedLessonId="";selectedContentType="";showImportantOnly=!1;ngOnInit(){this.loadLessons(),this.loadKeynotes()}loadLessons(){this.lessonService.getAllLessons().subscribe({next:e=>{this.lessons=e},error:e=>{console.error("Error loading lessons:",e)}})}loadKeynotes(){this.loading=!0,this.keynoteService.getKeynotesPaginated(this.pageIndex,this.pageSize,this.selectedLessonId?+this.selectedLessonId:void 0,this.selectedContentType||void 0,this.showImportantOnly||void 0,this.searchQuery.trim()||void 0).subscribe({next:e=>{this.keynotes=e.content,this.totalKeynotes=e.totalElements,this.loading=!1},error:e=>this.handleError(e)})}handleKeynotesResponse(e){let t=e;this.showImportantOnly&&!this.selectedLessonId&&(t=e.filter(l=>l.isImportant)),this.selectedContentType&&(t=t.filter(l=>l.contentType===this.selectedContentType)),this.keynotes=t,this.pageIndex=0,this.loading=!1}handleError(e){console.error("Error loading keynotes:",e),this.snackBar.open("Error loading keynotes","Close",{duration:3e3}),this.loading=!1}onSearchChange(){this.pageIndex=0,this.searchQuery.trim()?(this.selectedLessonId="",this.loadKeynotes()):this.loadKeynotes()}onLessonFilterChange(){this.pageIndex=0,this.searchQuery="",this.loadKeynotes()}onContentTypeFilterChange(){this.pageIndex=0,this.loadKeynotes()}onPageChange(e){this.pageIndex=e.pageIndex,this.pageSize=e.pageSize,this.loadKeynotes()}getContentTypeLabel(e){switch(e){case"text":return"Text";case"bullet_points":return"Bullet Points";case"quote":return"Quote";case"example":return"Example";default:return e}}editKeynote(e){this.router.navigate(["/keynotes/edit",e])}deleteKeynote(e){confirm(`Are you sure you want to delete the keynote "${e.title}"?`)&&this.keynoteService.deleteKeynote(e.keynoteId).subscribe({next:()=>{this.snackBar.open("Keynote deleted successfully","Close",{duration:3e3}),this.loadKeynotes()},error:t=>{console.error("Error deleting keynote:",t),this.snackBar.open("Error deleting keynote","Close",{duration:3e3})}})}static \u0275fac=function(t){return new(t||i)(f(U),f(ke),f(L),f(E))};static \u0275cmp=T({type:i,selectors:[["app-keynote-list"]],standalone:!0,features:[P],decls:47,vars:8,consts:[[1,"container"],[1,"header"],["mat-raised-button","","color","primary","routerLink","/keynotes/add"],[1,"filters-container"],["appearance","outline",1,"filter-field"],["matInput","","placeholder","Search by title or content...",3,"ngModelChange","input","ngModel"],["matSuffix",""],[3,"ngModelChange","selectionChange","ngModel"],["value",""],[3,"value",4,"ngFor","ngForOf"],["value","text"],["value","bullet_points"],["value","quote"],["value","example"],["mat-stroked-button","",3,"click","color"],["class","loading-container",4,"ngIf"],[4,"ngIf"],[3,"value"],[1,"loading-container"],["mat-table","",1,"full-width",3,"dataSource"],["matColumnDef","id"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","order"],["matColumnDef","title"],["matColumnDef","lesson"],["matColumnDef","contentType"],["matColumnDef","content"],["matColumnDef","features"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],[3,"page","length","pageSize","pageSizeOptions"],["class","no-data",4,"ngIf"],["mat-header-cell",""],["mat-cell",""],[1,"id-badge"],[1,"order-badge"],[1,"title-cell"],[1,"keynote-title"],["class","important-icon","color","warn",4,"ngIf"],["color","warn",1,"important-icon"],[1,"lesson-info"],[1,"lesson-title"],["class","topic-title",4,"ngIf"],[1,"topic-title"],[1,"content-preview",3,"matTooltip"],[1,"feature-chips"],["class","feature-chip visual-aid-chip",4,"ngIf"],["class","feature-chip planet-chip",4,"ngIf"],["class","feature-chip zodiac-chip",4,"ngIf"],[1,"feature-chip","visual-aid-chip"],[1,"feature-chip","planet-chip"],[1,"feature-chip","zodiac-chip"],["mat-icon-button","","color","primary","matTooltip","View Details",3,"routerLink"],["mat-icon-button","","color","accent","matTooltip","Edit Keynote",3,"click"],["mat-icon-button","","color","warn","matTooltip","Delete Keynote",3,"click"],["mat-header-row",""],["mat-row",""],[1,"no-data"]],template:function(t,l){t&1&&(o(0,"div",0)(1,"div",1)(2,"h1"),a(3,"Lesson Keynotes Management"),n(),o(4,"button",2)(5,"mat-icon"),a(6,"add"),n(),a(7," Add Keynote "),n()(),o(8,"mat-card")(9,"mat-card-header")(10,"mat-card-title"),a(11,"Keynotes"),n()(),o(12,"mat-card-content")(13,"div",3)(14,"mat-form-field",4)(15,"mat-label"),a(16,"Search keynotes"),n(),o(17,"input",5),ne("ngModelChange",function(d){return te(l.searchQuery,d)||(l.searchQuery=d),d}),_("input",function(){return l.onSearchChange()}),n(),o(18,"mat-icon",6),a(19,"search"),n()(),o(20,"mat-form-field",4)(21,"mat-label"),a(22,"Filter by Lesson"),n(),o(23,"mat-select",7),ne("ngModelChange",function(d){return te(l.selectedLessonId,d)||(l.selectedLessonId=d),d}),_("selectionChange",function(){return l.onLessonFilterChange()}),o(24,"mat-option",8),a(25,"All Lessons"),n(),m(26,Ht,2,2,"mat-option",9),n()(),o(27,"mat-form-field",4)(28,"mat-label"),a(29,"Content Type"),n(),o(30,"mat-select",7),ne("ngModelChange",function(d){return te(l.selectedContentType,d)||(l.selectedContentType=d),d}),_("selectionChange",function(){return l.onContentTypeFilterChange()}),o(31,"mat-option",8),a(32,"All Types"),n(),o(33,"mat-option",10),a(34,"Text"),n(),o(35,"mat-option",11),a(36,"Bullet Points"),n(),o(37,"mat-option",12),a(38,"Quote"),n(),o(39,"mat-option",13),a(40,"Example"),n()()(),o(41,"button",14),_("click",function(){return l.showImportantOnly=!l.showImportantOnly,l.loadKeynotes()}),o(42,"mat-icon"),a(43),n(),a(44," Important Only "),n()(),m(45,Ut,2,0,"div",15)(46,xn,30,9,"div",16),n()()()),t&2&&(r(17),ee("ngModel",l.searchQuery),r(6),ee("ngModel",l.selectedLessonId),r(3),s("ngForOf",l.lessons),r(4),ee("ngModel",l.selectedContentType),r(11),s("color",l.showImportantOnly?"primary":""),r(2),g(l.showImportantOnly?"star":"star_border"),r(2),s("ngIf",l.loading),r(),s("ngIf",!l.loading))},dependencies:[w,O,K,ae,Xe,re,le,ze,ft,at,lt,mt,st,rt,pt,ct,dt,gt,ut,B,A,D,V,F,q,N,ue,z,R,me,de,ce,it,ge,pe,_e,fe,se,he,xe,H,$,j,Ce,ve,yt,_t],styles:[".container[_ngcontent-%COMP%]{padding:20px}.header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px}.header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0}.filters-container[_ngcontent-%COMP%]{display:flex;gap:16px;margin-bottom:20px;align-items:center;flex-wrap:wrap}.filter-field[_ngcontent-%COMP%]{min-width:200px}.loading-container[_ngcontent-%COMP%]{display:flex;justify-content:center;padding:40px}.full-width[_ngcontent-%COMP%]{width:100%}.id-badge[_ngcontent-%COMP%]{background-color:#f3e5f5;color:#7b1fa2;padding:4px 8px;border-radius:12px;font-size:12px;font-weight:500;font-family:Courier New,monospace}.order-badge[_ngcontent-%COMP%]{background-color:#e3f2fd;color:#1565c0;padding:4px 8px;border-radius:12px;font-size:12px;font-weight:500}.title-cell[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.keynote-title[_ngcontent-%COMP%]{font-weight:500}.important-icon[_ngcontent-%COMP%]{font-size:16px;width:16px;height:16px}.lesson-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:4px}.lesson-title[_ngcontent-%COMP%]{font-weight:500;color:#333}.topic-title[_ngcontent-%COMP%]{font-size:12px;color:#666}.content-type-chip[_ngcontent-%COMP%]{font-size:11px;font-weight:500}.content-type-text[_ngcontent-%COMP%]{background-color:#e8f5e8;color:#2e7d32}.content-type-bullet_points[_ngcontent-%COMP%]{background-color:#fff3e0;color:#e65100}.content-type-quote[_ngcontent-%COMP%]{background-color:#f3e5f5;color:#7b1fa2}.content-type-example[_ngcontent-%COMP%]{background-color:#e3f2fd;color:#1565c0}.content-preview[_ngcontent-%COMP%]{max-width:300px;line-height:1.4;color:#666}.feature-chips[_ngcontent-%COMP%]{display:flex;gap:4px;flex-wrap:wrap}.feature-chip[_ngcontent-%COMP%]{font-size:10px;height:24px;display:flex;align-items:center;gap:4px}.visual-aid-chip[_ngcontent-%COMP%]{background-color:#fff9c4;color:#f57f17}.planet-chip[_ngcontent-%COMP%]{background-color:#fce4ec;color:#c2185b}.zodiac-chip[_ngcontent-%COMP%]{background-color:#e1f5fe;color:#0277bd}.feature-chip[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:12px;width:12px;height:12px}.no-data[_ngcontent-%COMP%]{text-align:center;padding:60px 20px;color:#666}.no-data[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:64px;width:64px;height:64px;margin-bottom:16px}.no-data[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:16px 0 24px;font-size:16px}.mat-mdc-cell[_ngcontent-%COMP%], .mat-mdc-header-cell[_ngcontent-%COMP%]{padding:12px 8px}.mat-mdc-row[_ngcontent-%COMP%]:hover{background-color:#0000000a}@media (max-width: 768px){.header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:12px}.filters-container[_ngcontent-%COMP%]{flex-direction:column;align-items:stretch}.filter-field[_ngcontent-%COMP%]{min-width:auto;width:100%}}"]})};var hn=i=>["/keynotes/edit",i];function vn(i,e){if(i&1&&(o(0,"button",8)(1,"mat-icon"),a(2,"edit"),n(),a(3," Edit Keynote "),n()),i&2){let t=p();s("routerLink",ie(1,hn,t.keynote.keynoteId))}}function Cn(i,e){i&1&&(o(0,"div",9),x(1,"mat-spinner"),n())}function kn(i,e){i&1&&(o(0,"mat-chip",31)(1,"mat-icon"),a(2,"star"),n(),a(3," Important "),n())}function Mn(i,e){if(i&1&&(o(0,"div",20)(1,"span",21),a(2,"Topic:"),n(),o(3,"span",24),a(4),n()()),i&2){let t=p(2);r(4),g(t.keynote.topicTitle)}}function Sn(i,e){if(i&1&&(o(0,"li"),a(1),n()),i&2){let t=e.$implicit;r(),g(t)}}function bn(i,e){if(i&1&&(o(0,"div",32)(1,"ul"),m(2,Sn,2,1,"li",33),n()()),i&2){let t=p(2);r(2),s("ngForOf",t.getBulletPoints(t.keynote.content))}}function En(i,e){if(i&1&&(o(0,"div",34)(1,"blockquote")(2,"mat-icon"),a(3,"format_quote"),n(),a(4),n()()),i&2){let t=p(2);r(4),y(" ",t.keynote.content," ")}}function In(i,e){if(i&1&&(o(0,"div",35)(1,"p"),a(2),n()()),i&2){let t=p(2);r(2),g(t.keynote.content)}}function Tn(i,e){if(i&1){let t=S();o(0,"mat-card",18)(1,"mat-card-header")(2,"mat-card-title"),a(3,"Visual Aid"),n()(),o(4,"mat-card-content")(5,"div",36)(6,"img",37),_("error",function(c){h(t);let d=p(2);return v(d.onImageError(c))}),n(),o(7,"div",38)(8,"span",21),a(9,"URL:"),n(),o(10,"a",39),a(11),o(12,"mat-icon"),a(13,"open_in_new"),n()()()()()()}if(i&2){let t=p(2);r(6),s("src",t.keynote.visualAidUrl,Ie)("alt",t.keynote.title),r(4),s("href",t.keynote.visualAidUrl,Ie),r(),y(" ",t.keynote.visualAidUrl," ")}}function Pn(i,e){if(i&1&&(o(0,"mat-chip",43)(1,"mat-icon"),a(2,"brightness_1"),n(),a(3),n()),i&2){let t=p(3);r(3),y(" ",t.keynote.relatedPlanet," ")}}function On(i,e){if(i&1&&(o(0,"mat-chip",44)(1,"mat-icon"),a(2,"stars"),n(),a(3),n()),i&2){let t=p(3);r(3),y(" ",t.keynote.relatedZodiac," ")}}function Kn(i,e){if(i&1&&(o(0,"mat-card",18)(1,"mat-card-header")(2,"mat-card-title"),a(3,"Astrological Relations"),n()(),o(4,"mat-card-content")(5,"div",40),m(6,Pn,4,1,"mat-chip",41)(7,On,4,1,"mat-chip",42),n()()()),i&2){let t=p(2);r(6),s("ngIf",t.keynote.relatedPlanet),r(),s("ngIf",t.keynote.relatedZodiac)}}function wn(i,e){if(i&1&&(o(0,"div",20)(1,"span",21),a(2,"Created:"),n(),o(3,"span",24),a(4),Q(5,"date"),n()()),i&2){let t=p(2);r(4),g(Pe(5,1,t.keynote.createdAt,"medium"))}}function Ln(i,e){if(i&1&&(o(0,"div",20)(1,"span",21),a(2,"Last Updated:"),n(),o(3,"span",24),a(4),Q(5,"date"),n()()),i&2){let t=p(2);r(4),g(Pe(5,1,t.keynote.updatedAt,"medium"))}}function An(i,e){if(i&1&&(o(0,"div",10)(1,"mat-card",11)(2,"mat-card-content")(3,"div",12)(4,"div",13)(5,"h2",14),a(6),n(),o(7,"div",15)(8,"mat-chip",16),a(9),n(),m(10,kn,4,0,"mat-chip",17),o(11,"mat-chip"),a(12),n()()()()()(),o(13,"mat-card",18)(14,"mat-card-header")(15,"mat-card-title"),a(16,"Lesson Information"),n()(),o(17,"mat-card-content")(18,"div",19)(19,"div",20)(20,"span",21),a(21,"Lesson:"),n(),o(22,"span",22),a(23),n()(),m(24,Mn,5,1,"div",23),o(25,"div",20)(26,"span",21),a(27,"Lesson ID:"),n(),o(28,"span",24),a(29),n()()()()(),o(30,"mat-card",25)(31,"mat-card-header")(32,"mat-card-title"),a(33,"Content"),n()(),o(34,"mat-card-content")(35,"div",26),m(36,bn,3,1,"div",27)(37,En,5,1,"div",28)(38,In,3,1,"div",29),n()()(),m(39,Tn,14,4,"mat-card",30)(40,Kn,8,2,"mat-card",30),o(41,"mat-card",18)(42,"mat-card-header")(43,"mat-card-title"),a(44,"System Information"),n()(),o(45,"mat-card-content")(46,"div",19)(47,"div",20)(48,"span",21),a(49,"Keynote ID:"),n(),o(50,"span",24),a(51),n()(),m(52,wn,6,4,"div",23)(53,Ln,6,4,"div",23),n()()()()),i&2){let t=p();r(6),g(t.keynote.title),r(3),y("Order: ",t.keynote.orderSequence,""),r(),s("ngIf",t.keynote.isImportant),r(),X("content-type-badge content-type-",t.keynote.contentType,""),r(),y(" ",t.getContentTypeLabel(t.keynote.contentType)," "),r(11),g(t.keynote.lessonTitle),r(),s("ngIf",t.keynote.topicTitle),r(5),g(t.keynote.lessonId),r(6),s("ngClass","content-type-"+t.keynote.contentType),r(),s("ngIf",t.keynote.contentType==="bullet_points"),r(),s("ngIf",t.keynote.contentType==="quote"),r(),s("ngIf",t.keynote.contentType==="text"||t.keynote.contentType==="example"),r(),s("ngIf",t.keynote.hasVisualAid&&t.keynote.visualAidUrl),r(),s("ngIf",t.keynote.relatedPlanet||t.keynote.relatedZodiac),r(11),g(t.keynote.keynoteId),r(),s("ngIf",t.keynote.createdAt),r(),s("ngIf",t.keynote.updatedAt)}}function Fn(i,e){if(i&1){let t=S();o(0,"div",45)(1,"mat-icon"),a(2,"note_alt"),n(),o(3,"h2"),a(4,"Keynote Not Found"),n(),o(5,"p"),a(6,"The keynote you're looking for doesn't exist or has been deleted."),n(),o(7,"button",46),_("click",function(){h(t);let c=p();return v(c.goBack())}),a(8," Go Back to Keynotes "),n()()}}var Se=class i{constructor(e,t,l,c){this.route=e;this.router=t;this.keynoteService=l;this.snackBar=c}keynoteId=null;keynote=null;loading=!1;ngOnInit(){this.route.params.subscribe(e=>{e.id&&(this.keynoteId=+e.id,this.loadKeynote())})}loadKeynote(){this.keynoteId&&(this.loading=!0,this.keynoteService.getKeynoteById(this.keynoteId).subscribe({next:e=>{this.keynote=e,this.loading=!1},error:e=>{console.error("Error loading keynote:",e),this.snackBar.open("Error loading keynote details","Close",{duration:3e3}),this.loading=!1}}))}getContentTypeLabel(e){switch(e){case"text":return"Text";case"bullet_points":return"Bullet Points";case"quote":return"Quote";case"example":return"Example";default:return e}}getBulletPoints(e){return e.split(`
`).map(t=>t.trim()).filter(t=>t.length>0).map(t=>t.replace(/^[â€¢\-\*]\s*/,""))}onImageError(e){e.target.style.display="none"}goBack(){this.router.navigate(["/keynotes"])}static \u0275fac=function(t){return new(t||i)(f(oe),f(L),f(U),f(E))};static \u0275cmp=T({type:i,selectors:[["app-keynote-details"]],standalone:!0,features:[P],decls:13,vars:4,consts:[[1,"container"],[1,"header"],[1,"actions"],["mat-button","",3,"click"],["mat-raised-button","","color","accent",3,"routerLink",4,"ngIf"],["class","loading-container",4,"ngIf"],["class","keynote-details",4,"ngIf"],["class","no-keynote",4,"ngIf"],["mat-raised-button","","color","accent",3,"routerLink"],[1,"loading-container"],[1,"keynote-details"],[1,"info-card","header-card"],[1,"keynote-header"],[1,"title-section"],[1,"keynote-title"],[1,"badges"],[1,"order-badge"],["class","important-badge",4,"ngIf"],[1,"info-card"],[1,"info-grid"],[1,"info-item"],[1,"label"],[1,"value","lesson-link"],["class","info-item",4,"ngIf"],[1,"value"],[1,"info-card","content-card"],[1,"content-display",3,"ngClass"],["class","bullet-content",4,"ngIf"],["class","quote-content",4,"ngIf"],["class","text-content",4,"ngIf"],["class","info-card",4,"ngIf"],[1,"important-badge"],[1,"bullet-content"],[4,"ngFor","ngForOf"],[1,"quote-content"],[1,"text-content"],[1,"visual-aid-container"],[1,"visual-aid-image",3,"error","src","alt"],[1,"visual-aid-url"],["target","_blank",1,"url-link",3,"href"],[1,"astro-chips"],["class","planet-chip",4,"ngIf"],["class","zodiac-chip",4,"ngIf"],[1,"planet-chip"],[1,"zodiac-chip"],[1,"no-keynote"],["mat-raised-button","","color","primary",3,"click"]],template:function(t,l){t&1&&(o(0,"div",0)(1,"div",1)(2,"h1"),a(3,"Keynote Details"),n(),o(4,"div",2)(5,"button",3),_("click",function(){return l.goBack()}),o(6,"mat-icon"),a(7,"arrow_back"),n(),a(8," Back to Keynotes "),n(),m(9,vn,4,3,"button",4),n()(),m(10,Cn,2,0,"div",5)(11,An,54,19,"div",6)(12,Fn,9,0,"div",7),n()),t&2&&(r(9),s("ngIf",l.keynote),r(),s("ngIf",l.loading),r(),s("ngIf",!l.loading&&l.keynote),r(),s("ngIf",!l.loading&&!l.keynote))},dependencies:[w,Be,O,K,qe,ae,B,A,D,V,F,q,N,z,R,ye,he,xe,$,j,H],styles:[".container[_ngcontent-%COMP%]{padding:20px;max-width:1000px;margin:0 auto}.header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px}.header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0}.actions[_ngcontent-%COMP%]{display:flex;gap:12px}.loading-container[_ngcontent-%COMP%]{display:flex;justify-content:center;padding:60px}.keynote-details[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:20px}.info-card[_ngcontent-%COMP%]{width:100%}.header-card[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2);color:#fff}.header-card[_ngcontent-%COMP%]   .mat-mdc-card-content[_ngcontent-%COMP%]{padding:24px}.keynote-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start}.keynote-title[_ngcontent-%COMP%]{font-size:28px;font-weight:600;margin:0 0 16px;color:#fff}.badges[_ngcontent-%COMP%]{display:flex;gap:8px;flex-wrap:wrap}.order-badge[_ngcontent-%COMP%]{background-color:#fff3;color:#fff}.important-badge[_ngcontent-%COMP%]{background-color:#ff6b6b;color:#fff}.content-type-badge[_ngcontent-%COMP%]{color:#fff;font-weight:500}.content-type-text[_ngcontent-%COMP%]{background-color:#4caf50cc}.content-type-bullet_points[_ngcontent-%COMP%]{background-color:#ff9800cc}.content-type-quote[_ngcontent-%COMP%]{background-color:#9c27b0cc}.content-type-example[_ngcontent-%COMP%]{background-color:#2196f3cc}.info-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:16px}.info-item[_ngcontent-%COMP%]{display:flex;align-items:center;min-height:40px}.label[_ngcontent-%COMP%]{font-weight:600;color:#666;min-width:100px;margin-right:12px}.value[_ngcontent-%COMP%]{color:#333;word-break:break-word}.lesson-link[_ngcontent-%COMP%]{color:#1976d2;cursor:pointer;text-decoration:underline}.content-card[_ngcontent-%COMP%]{min-height:150px}.content-display[_ngcontent-%COMP%]{font-size:16px;line-height:1.6}.bullet-content[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{margin:0;padding-left:20px}.bullet-content[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin-bottom:8px}.quote-content[_ngcontent-%COMP%]   blockquote[_ngcontent-%COMP%]{margin:0;padding:20px;background-color:#f5f5f5;border-left:4px solid #9c27b0;border-radius:4px;font-style:italic;position:relative}.quote-content[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{position:absolute;top:10px;left:10px;color:#9c27b0;opacity:.3;font-size:32px;width:32px;height:32px}.text-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:#333}.visual-aid-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px}.visual-aid-image[_ngcontent-%COMP%]{max-width:100%;max-height:400px;border-radius:8px;box-shadow:0 4px 8px #0000001a}.visual-aid-url[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.url-link[_ngcontent-%COMP%]{color:#1976d2;text-decoration:none;display:flex;align-items:center;gap:4px}.url-link[_ngcontent-%COMP%]:hover{text-decoration:underline}.url-link[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:16px;width:16px;height:16px}.astro-chips[_ngcontent-%COMP%]{display:flex;gap:12px;flex-wrap:wrap}.planet-chip[_ngcontent-%COMP%]{background-color:#fce4ec;color:#c2185b}.zodiac-chip[_ngcontent-%COMP%]{background-color:#e1f5fe;color:#0277bd}.planet-chip[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%], .zodiac-chip[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:16px;width:16px;height:16px}.no-keynote[_ngcontent-%COMP%]{text-align:center;padding:80px 20px;color:#666}.no-keynote[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:64px;width:64px;height:64px;margin-bottom:16px}.no-keynote[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:16px 0;color:#333}@media (max-width: 768px){.header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:12px}.actions[_ngcontent-%COMP%]{width:100%;justify-content:flex-start}.keynote-header[_ngcontent-%COMP%]{flex-direction:column;gap:16px}.info-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}.info-item[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start}.label[_ngcontent-%COMP%]{min-width:auto;margin-right:0;margin-bottom:4px}}"]})};var b=class{static extractErrorMessage(e,t="An error occurred. Please try again."){if(!e)return t;if(e.error&&e.error.fieldErrors){let l=e.error.fieldErrors;return Object.entries(l).map(([d,C])=>`${d}: ${C}`).join(", ")||e.error.message||t}if(e.error&&e.error.message)return e.error.message;if(e.error&&typeof e.error=="string")return e.error;if(e.error&&e.error.error)return e.error.error;if(e.message)return e.message;if(e.status)switch(e.status){case 400:return e.error?.message||"Invalid request. Please check your input data.";case 401:return"Authentication failed. Please log in again.";case 403:return"You do not have permission to perform this action.";case 404:return"The requested resource was not found.";case 409:return e.error?.message||"A conflict occurred. The resource may already exist.";case 422:return e.error?.message||"Validation failed. Please check your input data.";case 500:return e.error?.message||"Server error. Please try again later.";case 0:return"Unable to connect to the server. Please check your internet connection.";default:return e.error?.message||`Server error (${e.status}). Please try again later.`}return t}static formatValidationErrors(e){if(!e||typeof e!="object")return"Validation failed. Please check your input data.";let t=Object.entries(e).map(([l,c])=>`${l.replace(/([A-Z])/g," $1").replace(/^./,C=>C.toUpperCase()).trim()}: ${c}`);return t.length===1?t[0]:`Multiple validation errors: ${t.join("; ")}`}static isValidationError(e){return e?.error?.fieldErrors||e?.status===400||e?.status===422||e?.error?.message&&e.error.message.toLowerCase().includes("validation")}static isConflictError(e){return e?.status===409||e?.error?.message&&(e.error.message.toLowerCase().includes("duplicate")||e.error.message.toLowerCase().includes("already exists")||e.error.message.toLowerCase().includes("conflict"))}static getSnackbarClass(e){return this.isValidationError(e)?["warning-snackbar"]:this.isConflictError(e)?["warning-snackbar"]:["error-snackbar"]}};var be=class i{snackBar=Fe(E);showError(e,t="An error occurred. Please try again.",l=5e3){let c=b.extractErrorMessage(e,t),d=b.getSnackbarClass(e);this.snackBar.open(c,"Close",{duration:l,panelClass:d})}showSuccess(e,t=3e3){this.snackBar.open(e,"Close",{duration:t,panelClass:["success-snackbar"]})}showWarning(e,t=4e3){this.snackBar.open(e,"Close",{duration:t,panelClass:["warning-snackbar"]})}showInfo(e,t=3e3){this.snackBar.open(e,"Close",{duration:t,panelClass:["info-snackbar"]})}handleApiError(e,t="operation",l=5e3){let c=`Error ${t}. Please try again.`;b.isValidationError(e)?c=`Validation failed while ${t}. Please check your input data.`:b.isConflictError(e)?c=`A conflict occurred while ${t}. The resource may already exist.`:e?.status===404?c=`Resource not found while ${t}.`:e?.status===403?c=`You do not have permission to perform this ${t}.`:e?.status===401&&(c=`Authentication required to ${t}. Please log in again.`),this.showError(e,c,l)}handleFormError(e,t="form"){if(b.isValidationError(e)&&e?.error?.fieldErrors){let l=b.formatValidationErrors(e.error.fieldErrors);this.showWarning(l,6e3)}else this.handleApiError(e,`submitting ${t}`)}logError(e,t){console.error(`Error in ${t}:`,e),e?.error&&console.error("Error details:",e.error),e?.status&&console.error("HTTP Status:",e.status),e?.message&&console.error("Error message:",e.message)}static \u0275fac=function(t){return new(t||i)};static \u0275prov=Ae({token:i,factory:i.\u0275fac,providedIn:"root"})};function Vn(i,e){i&1&&(o(0,"div",6),x(1,"mat-spinner"),n())}function Bn(i,e){if(i&1&&(o(0,"mat-option",40)(1,"div",41)(2,"span",42),a(3),n(),o(4,"span",43),a(5),n()()()),i&2){let t=e.$implicit;s("value",t),r(3),g(t.title),r(2),g(t.topicTitle)}}function Nn(i,e){i&1&&(o(0,"mat-error"),a(1," Lesson is required "),n())}function qn(i,e){i&1&&(o(0,"mat-error"),a(1," Title is required "),n())}function Rn(i,e){i&1&&(o(0,"mat-error"),a(1," Content type is required "),n())}function zn(i,e){i&1&&(o(0,"span"),a(1," Use bullet points format (\u2022 item 1, \u2022 item 2, etc.) "),n())}function jn(i,e){i&1&&(o(0,"span"),a(1," Include quotation marks for quotes "),n())}function $n(i,e){i&1&&(o(0,"mat-error"),a(1," Content is required "),n())}function Hn(i,e){i&1&&(o(0,"mat-form-field",10)(1,"mat-label"),a(2,"Visual Aid URL"),n(),x(3,"input",44),o(4,"mat-hint"),a(5,"URL to image, diagram, or other visual content"),n()())}function Un(i,e){if(i&1&&(o(0,"mat-option",40),a(1),n()),i&2){let t=e.$implicit;s("value",t),r(),y(" ",t," ")}}function Wn(i,e){if(i&1&&(o(0,"mat-option",40),a(1),n()),i&2){let t=e.$implicit;s("value",t),r(),y(" ",t," ")}}function Gn(i,e){if(i&1&&(o(0,"mat-option",40),a(1),n()),i&2){let t=e.$implicit;s("value",t.tagId),r(),y(" ",t.tagName," ")}}function Qn(i,e){i&1&&(o(0,"mat-error"),a(1," Tag selection is required "),n())}function Zn(i,e){if(i&1){let t=S();o(0,"div",45)(1,"mat-form-field",46)(2,"mat-label"),a(3,"Tag"),n(),o(4,"mat-select",47),m(5,Gn,2,2,"mat-option",13),n(),m(6,Qn,2,0,"mat-error",14),n(),o(7,"mat-form-field",46)(8,"mat-label"),a(9,"Relevance Score"),n(),x(10,"input",48),o(11,"mat-hint"),a(12,"Enter a score from 1-10 indicating relevance to the keynote"),n()(),o(13,"div",49)(14,"button",50),_("click",function(){let c=h(t).index,d=p(2);return v(d.saveTag(c))}),o(15,"mat-icon"),a(16,"save"),n()(),o(17,"button",51),_("click",function(){let c=h(t).index,d=p(2);return v(d.removeTag(c))}),o(18,"mat-icon"),a(19,"delete"),n(),a(20," Remove "),n()()()}if(i&2){let t,l=e.$implicit,c=e.index,d=p(2);s("formGroupName",c),r(5),s("ngForOf",d.allTags),r(),s("ngIf",(t=l.get("tagId"))==null?null:t.hasError("required"))}}function Yn(i,e){i&1&&(o(0,"div",52)(1,"mat-icon"),a(2,"label_off"),n(),o(3,"p"),a(4,'No tags added yet. Click "Add Tag" to start tagging this keynote.'),n()())}function Jn(i,e){i&1&&x(0,"mat-spinner",53)}function Xn(i,e){if(i&1){let t=S();o(0,"form",7),_("ngSubmit",function(){h(t);let c=p();return v(c.onSubmit())}),o(1,"div",8)(2,"h3"),a(3,"Basic Information"),n(),o(4,"div",9)(5,"mat-form-field",10)(6,"mat-label"),a(7,"Lesson"),n(),x(8,"input",11),o(9,"mat-autocomplete",12,0),m(11,Bn,6,3,"mat-option",13),Q(12,"async"),n(),m(13,Nn,2,0,"mat-error",14),n(),o(14,"mat-form-field",10)(15,"mat-label"),a(16,"Order Sequence"),n(),x(17,"input",15),n()(),o(18,"mat-form-field",10)(19,"mat-label"),a(20,"Title"),n(),x(21,"input",16),m(22,qn,2,0,"mat-error",14),n(),o(23,"div",9)(24,"mat-form-field",10)(25,"mat-label"),a(26,"Content Type"),n(),o(27,"mat-select",17)(28,"mat-option",18),a(29,"Text"),n(),o(30,"mat-option",19),a(31,"Bullet Points"),n(),o(32,"mat-option",20),a(33,"Quote"),n(),o(34,"mat-option",21),a(35,"Example"),n()(),m(36,Rn,2,0,"mat-error",14),n(),o(37,"div",22)(38,"mat-checkbox",23)(39,"mat-icon"),a(40,"star"),n(),a(41," Mark as Important "),n()()()(),o(42,"div",8)(43,"h3"),a(44,"Content"),n(),o(45,"mat-form-field",10)(46,"mat-label"),a(47,"Content"),n(),o(48,"textarea",24),a(49,"                "),n(),o(50,"mat-hint"),m(51,zn,2,0,"span",14)(52,jn,2,0,"span",14),n(),m(53,$n,2,0,"mat-error",14),n()(),o(54,"div",8)(55,"h3"),a(56,"Visual Aid"),n(),o(57,"div",22)(58,"mat-checkbox",25),_("change",function(c){h(t);let d=p();return v(d.onVisualAidChange(c))}),o(59,"mat-icon"),a(60,"image"),n(),a(61," Has Visual Aid "),n()(),m(62,Hn,6,0,"mat-form-field",26),n(),o(63,"div",8)(64,"h3"),a(65,"Astrological Relations"),n(),o(66,"div",9)(67,"mat-form-field",10)(68,"mat-label"),a(69,"Related Planet"),n(),o(70,"mat-select",27)(71,"mat-option",28),a(72,"None"),n(),m(73,Un,2,2,"mat-option",13),n()(),o(74,"mat-form-field",10)(75,"mat-label"),a(76,"Related Zodiac Sign"),n(),o(77,"mat-select",29)(78,"mat-option",28),a(79,"None"),n(),m(80,Wn,2,2,"mat-option",13),n()()()(),x(81,"mat-divider"),o(82,"div",8)(83,"div",30)(84,"h3",31)(85,"mat-icon"),a(86,"label"),n(),a(87," Keynote Tags "),n(),o(88,"button",32),_("click",function(){h(t);let c=p();return v(c.addTag())}),o(89,"mat-icon"),a(90,"add"),n(),a(91," Add Tag "),n()(),o(92,"div",33),m(93,Zn,21,3,"div",34)(94,Yn,5,0,"div",35),n()(),o(95,"div",36)(96,"button",37),_("click",function(){h(t);let c=p();return v(c.goBack())}),a(97,"Cancel"),n(),o(98,"button",38),m(99,Jn,1,0,"mat-spinner",39),a(100),n()()()}if(i&2){let t,l,c,d,C,W,Ee,Ke=De(10),u=p();s("formGroup",u.keynoteForm),r(8),s("matAutocomplete",Ke),r(),s("displayWith",u.displayLessonFn),r(2),s("ngForOf",Ve(12,18,u.filteredLessons)),r(2),s("ngIf",(t=u.keynoteForm.get("lessonSearch"))==null?null:t.hasError("required")),r(9),s("ngIf",(l=u.keynoteForm.get("title"))==null?null:l.hasError("required")),r(14),s("ngIf",(c=u.keynoteForm.get("contentType"))==null?null:c.hasError("required")),r(15),s("ngIf",((d=u.keynoteForm.get("contentType"))==null?null:d.value)==="bullet_points"),r(),s("ngIf",((C=u.keynoteForm.get("contentType"))==null?null:C.value)==="quote"),r(),s("ngIf",(W=u.keynoteForm.get("content"))==null?null:W.hasError("required")),r(9),s("ngIf",(Ee=u.keynoteForm.get("hasVisualAid"))==null?null:Ee.value),r(11),s("ngForOf",u.planets),r(7),s("ngForOf",u.zodiacSigns),r(13),s("ngForOf",u.keynoteTags.controls),r(),s("ngIf",u.keynoteTags.length===0),r(4),s("disabled",u.keynoteForm.invalid||u.submitting),r(),s("ngIf",u.submitting),r(),y(" ",u.submitting?"Saving...":u.isEditMode?"Update Keynote":"Create Keynote"," ")}}var Z=class i{constructor(e,t,l,c,d,C,W,Ee,Ke){this.fb=e;this.keynoteService=t;this.lessonService=l;this.keynoteTagService=c;this.tagService=d;this.errorHandler=C;this.router=W;this.route=Ee;this.snackBar=Ke;this.keynoteForm=this.createForm(),this.filteredLessons=this.keynoteForm.get("lessonSearch").valueChanges.pipe(Le(""),we(u=>this.filterLessons(u)))}keynoteForm;isEditMode=!1;keynoteId=null;loading=!1;submitting=!1;lessons=[];filteredLessons;allTags=[];planets=["Sun","Moon","Mars","Mercury","Jupiter","Venus","Saturn","Rahu","Ketu"];zodiacSigns=["Aries","Taurus","Gemini","Cancer","Leo","Virgo","Libra","Scorpio","Sagittarius","Capricorn","Aquarius","Pisces"];ngOnInit(){this.loadLessons(),this.loadAllTags(),this.route.params.subscribe(e=>{e.id&&(this.isEditMode=!0,this.keynoteId=+e.id,this.loadKeynote())})}get keynoteTags(){return this.keynoteForm.get("keynoteTags")}createForm(){return this.fb.group({lessonSearch:["",[I.required]],lessonId:[""],title:["",[I.required]],content:["",[I.required]],contentType:["text",[I.required]],orderSequence:[""],isImportant:[!1],hasVisualAid:[!1],visualAidUrl:[""],relatedPlanet:[""],relatedZodiac:[""],keynoteTags:this.fb.array([])})}loadLessons(){this.lessonService.getAllLessons().subscribe({next:e=>{this.lessons=e},error:e=>{console.error("Error loading lessons:",e),this.errorHandler.handleApiError(e,"loading lessons")}})}loadKeynote(){this.keynoteId&&(this.loading=!0,this.keynoteService.getKeynoteById(this.keynoteId).subscribe({next:e=>{let t=this.lessons.find(l=>l.lessonId===e.lessonId);this.keynoteForm.patchValue(J(Y({},e),{lessonSearch:t})),this.loadKeynoteTags(),this.loading=!1},error:e=>{console.error("Error loading keynote:",e),this.errorHandler.handleApiError(e,"loading keynote details"),this.loading=!1}}))}filterLessons(e){if(!e||typeof e=="object")return this.lessons;let t=e.toLowerCase();return this.lessons.filter(l=>l.title.toLowerCase().includes(t)||l.topicTitle?.toLowerCase().includes(t))}displayLessonFn=e=>e?e.title:"";onVisualAidChange(e){e.checked||this.keynoteForm.patchValue({visualAidUrl:""})}onSubmit(){if(this.keynoteForm.invalid)return;this.submitting=!0;let e=this.keynoteForm.value,t=e.lessonSearch;if(!t||!t.lessonId){this.snackBar.open("Please select a valid lesson","Close",{duration:3e3}),this.submitting=!1;return}let l={lessonId:t.lessonId,title:e.title,content:e.content,contentType:e.contentType,orderSequence:e.orderSequence||void 0,isImportant:e.isImportant,hasVisualAid:e.hasVisualAid,visualAidUrl:e.hasVisualAid?e.visualAidUrl:null,relatedPlanet:e.relatedPlanet||null,relatedZodiac:e.relatedZodiac||null};(this.isEditMode?this.keynoteService.updateKeynote(this.keynoteId,l):this.keynoteService.createKeynote(l)).subscribe({next:d=>G(this,null,function*(){try{!this.isEditMode&&d.keynoteId&&(this.keynoteId=d.keynoteId),yield this.handleKeynoteTags();let C=this.isEditMode?`Keynote updated successfully with ${this.keynoteTags.length} tag(s)!`:`Keynote created successfully with ${this.keynoteTags.length} tag(s)!`;this.errorHandler.showSuccess(C),this.router.navigate(["/keynotes"])}catch(C){console.error("Error handling keynote tags:",C);let W=this.isEditMode?"Keynote updated but some tags failed to save":"Keynote created but some tags failed to save";this.errorHandler.showWarning(W),this.router.navigate(["/keynotes"])}}),error:d=>{console.error("Error saving keynote:",d),this.errorHandler.handleApiError(d,"saving keynote"),this.submitting=!1}})}handleKeynoteTags(){return G(this,null,function*(){if(!this.keynoteId)throw new Error("Keynote ID is required to handle tags");let e=this.keynoteTags.value||[];for(let t=0;t<e.length;t++){let l=e[t];if(!l.tagId||!l.relevanceScore)continue;let c={keynoteId:this.keynoteId,tagId:Number(l.tagId),relevanceScore:Number(l.relevanceScore)};try{if(l.keynoteTagId)yield this.keynoteTagService.updateKeynoteTag(l.keynoteTagId,J(Y({},c),{keynoteTagId:l.keynoteTagId})).toPromise();else{let d=yield this.keynoteTagService.createKeynoteTag(c).toPromise();d&&d.keynoteTagId&&this.keynoteTags.at(t).patchValue({keynoteTagId:d.keynoteTagId})}}catch(d){throw console.error(`Error handling keynote tag at index ${t}:`,d),d}}})}loadAllTags(){this.tagService.getTags().subscribe({next:e=>{this.allTags=e},error:e=>{this.errorHandler.handleApiError(e,"loading tags")}})}loadKeynoteTags(){this.keynoteId&&this.keynoteTagService.getTagsByKeynoteId(this.keynoteId).subscribe({next:e=>{for(;this.keynoteTags.length!==0;)this.keynoteTags.removeAt(0);e.forEach(t=>{let l=this.fb.group({keynoteTagId:[t.keynoteTagId],tagId:[t.tagId,I.required],relevanceScore:[t.relevanceScore||5]});this.keynoteTags.push(l)})},error:e=>{this.errorHandler.handleApiError(e,"loading keynote tags")}})}addTag(){let e=this.fb.group({keynoteTagId:[null],tagId:[null,I.required],relevanceScore:[5]});this.keynoteTags.push(e)}saveTag(e){return G(this,null,function*(){let t=this.keynoteTags.at(e);if(!t.valid){this.snackBar.open("Please select a tag and enter a valid relevance score.","Close",{duration:3e3});return}if(!this.keynoteId){this.snackBar.open("Keynote must be saved before adding tags.","Close",{duration:3e3});return}let l=t.value,c={keynoteId:this.keynoteId,tagId:Number(l.tagId),relevanceScore:Number(l.relevanceScore)};try{if(l.keynoteTagId)yield this.keynoteTagService.updateKeynoteTag(l.keynoteTagId,J(Y({},c),{keynoteTagId:l.keynoteTagId})).toPromise(),this.errorHandler.showSuccess("Tag updated successfully.");else{let d=yield this.keynoteTagService.createKeynoteTag(c).toPromise();d&&d.keynoteTagId&&t.patchValue({keynoteTagId:d.keynoteTagId}),this.errorHandler.showSuccess("Tag added successfully.")}this.loadKeynoteTags()}catch(d){this.errorHandler.handleApiError(d,"saving tag")}})}removeTag(e){return G(this,null,function*(){let l=this.keynoteTags.at(e).value;if(l.keynoteTagId)try{yield this.keynoteTagService.deleteKeynoteTag(l.keynoteTagId).toPromise(),this.errorHandler.showSuccess("Tag deleted successfully."),this.loadKeynoteTags()}catch(c){this.errorHandler.handleApiError(c,"deleting tag")}else this.keynoteTags.removeAt(e)})}goBack(){this.router.navigate(["/keynotes"])}static \u0275fac=function(t){return new(t||i)(f(Je),f(U),f(ke),f(Mt),f(St),f(be),f(L),f(oe),f(E))};static \u0275cmp=T({type:i,selectors:[["app-add-keynote"]],standalone:!0,features:[P],decls:15,vars:4,consts:[["lessonAuto","matAutocomplete"],[1,"container"],[1,"header"],["mat-button","",3,"click"],["class","loading-container",4,"ngIf"],["class","keynote-form",3,"formGroup","ngSubmit",4,"ngIf"],[1,"loading-container"],[1,"keynote-form",3,"ngSubmit","formGroup"],[1,"section"],[1,"form-row"],["appearance","outline"],["matInput","","formControlName","lessonSearch","placeholder","Search and select lesson",3,"matAutocomplete"],[3,"displayWith"],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],["matInput","","type","number","formControlName","orderSequence","placeholder","Auto-assigned if empty"],["matInput","","formControlName","title","placeholder","Enter keynote title"],["formControlName","contentType"],["value","text"],["value","bullet_points"],["value","quote"],["value","example"],[1,"checkbox-group"],["formControlName","isImportant"],["matInput","","formControlName","content","rows","6","placeholder","Enter keynote content"],["formControlName","hasVisualAid",3,"change"],["appearance","outline",4,"ngIf"],["formControlName","relatedPlanet"],["value",""],["formControlName","relatedZodiac"],[1,"section-header"],[1,"section-title"],["mat-raised-button","","color","accent","type","button",1,"add-tag-btn",3,"click"],["formArrayName","keynoteTags",1,"tags-container"],["class","tag-item",3,"formGroupName",4,"ngFor","ngForOf"],["class","no-tags",4,"ngIf"],[1,"form-actions"],["mat-button","","type","button",3,"click"],["mat-raised-button","","color","primary","type","submit",3,"disabled"],["diameter","20",4,"ngIf"],[3,"value"],[1,"lesson-option"],[1,"lesson-title"],[1,"topic-title"],["matInput","","formControlName","visualAidUrl","placeholder","Enter image/media URL"],[1,"tag-item",3,"formGroupName"],["appearance","outline",1,"full-width"],["formControlName","tagId","required",""],["matInput","","formControlName","relevanceScore","type","number","min","1","max","10"],[1,"tag-actions"],["mat-icon-button","","color","primary","type","button","matTooltip","Save this tag",1,"save-tag-btn",3,"click"],["mat-button","","color","warn","type","button","matTooltip","Remove this tag",3,"click"],[1,"no-tags"],["diameter","20"]],template:function(t,l){t&1&&(o(0,"div",1)(1,"div",2)(2,"h1"),a(3),n(),o(4,"button",3),_("click",function(){return l.goBack()}),o(5,"mat-icon"),a(6,"arrow_back"),n(),a(7," Back to Keynotes "),n()(),o(8,"mat-card")(9,"mat-card-header")(10,"mat-card-title"),a(11),n()(),o(12,"mat-card-content"),m(13,Vn,2,0,"div",4)(14,Xn,101,20,"form",5),n()()()),t&2&&(r(3),g(l.isEditMode?"Edit Keynote":"Add New Keynote"),r(8),g(l.isEditMode?"Edit Keynote Details":"Keynote Information"),r(2),s("ngIf",l.loading),r(),s("ngIf",!l.loading))},dependencies:[w,O,K,Ne,et,je,re,$e,le,Re,Ye,Ze,Qe,He,Ge,Ue,We,B,A,D,V,F,me,de,ce,nt,tt,ge,pe,q,N,ue,_e,fe,se,ht,xt,z,R,H,$,j,kt,vt,Ct,ye,ot,Ce,ve],styles:[".container[_ngcontent-%COMP%]{padding:20px;max-width:900px;margin:0 auto}.header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px}.header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0}.loading-container[_ngcontent-%COMP%]{display:flex;justify-content:center;padding:40px}.keynote-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:24px}.section[_ngcontent-%COMP%]{border:1px solid #e0e0e0;border-radius:8px;padding:20px;background-color:#fafafa}.section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 16px;color:#333;font-size:16px;font-weight:500}.form-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:16px;align-items:start}.form-row[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{width:100%}mat-form-field[_ngcontent-%COMP%]{width:100%}.checkbox-group[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;margin-top:8px}.checkbox-group[_ngcontent-%COMP%]   mat-checkbox[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.lesson-option[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:4px;padding:8px 0}.lesson-title[_ngcontent-%COMP%]{font-weight:500;color:#333}.topic-title[_ngcontent-%COMP%]{font-size:12px;color:#666}.form-actions[_ngcontent-%COMP%]{display:flex;gap:12px;justify-content:flex-end;padding-top:20px;border-top:1px solid #e0e0e0}.form-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{min-width:120px}.section-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px}.section-title[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;margin:0;color:#333;font-size:16px;font-weight:500}.add-tag-btn[_ngcontent-%COMP%]{min-width:auto}.tags-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px}.tag-item[_ngcontent-%COMP%]{display:grid;grid-template-columns:2fr 1fr auto;gap:12px;align-items:start;padding:16px;border:1px solid #e0e0e0;border-radius:8px;background-color:#fff}.tag-actions[_ngcontent-%COMP%]{display:flex;gap:8px;align-items:center}.save-tag-btn[_ngcontent-%COMP%]{background-color:#4caf50;color:#fff}.no-tags[_ngcontent-%COMP%]{text-align:center;padding:40px 20px;color:#666;border:2px dashed #e0e0e0;border-radius:8px;background-color:#f9f9f9}.no-tags[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:48px;width:48px;height:48px;color:#ccc;margin-bottom:8px}.no-tags[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:14px}@media (max-width: 768px){.form-row[_ngcontent-%COMP%]{grid-template-columns:1fr}.header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:12px}.form-actions[_ngcontent-%COMP%]{flex-direction:column}}"]})};var fo=[{path:"",component:Me},{path:"add",component:Z},{path:"edit/:id",component:Z},{path:":id",component:Se}];export{fo as KEYNOTES_ROUTES};
