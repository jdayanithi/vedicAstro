import{a as yt,b as Dt,c as Et,d as It}from"./chunk-INZWUBPP.js";import{a as Ht,b as At,c as Ut,d as Gt,e as zt,f as Jt,g as P}from"./chunk-SP3Z5TV7.js";import{a as Kt,b as Qt}from"./chunk-NI5FSVGM.js";import{a as Wt,b as Xt}from"./chunk-74LTD5PY.js";import{a as ct,b as pt,c as st,e as dt,g as ft}from"./chunk-WWQZTZCX.js";import{a as Pt,b as wt,c as Ft,d as Ot,e as Rt,f as Bt,g as $t,h as qt,i as Lt,j as Vt,k as jt}from"./chunk-OMNFHR7K.js";import{a as Tt,b as kt}from"./chunk-NNROVGUN.js";import{b as Nt,c as Mt,q as T,r as k}from"./chunk-HHRDAJVU.js";import"./chunk-NGDKZ7II.js";import{a as ut,b as gt,c as ht,e as Ct,h as _t,i as xt}from"./chunk-3Y56DFGH.js";import{Ab as u,Bb as U,Ca as r,Da as f,Gb as S,Ib as y,Kb as $,Lb as G,Mc as W,Oc as X,Qc as C,Sa as c,Sc as Y,Tc as Z,U as H,Ud as mt,Xa as l,Xc as tt,Yc as et,Z as A,Za as O,_c as it,ba as v,bd as ot,db as n,dc as z,de as lt,eb as o,ed as nt,fb as s,fd as at,gb as g,hb as h,hc as J,hd as rt,ja as N,jb as b,je as E,ka as M,kc as K,lc as D,le as vt,mb as _,me as I,ne as bt,ob as R,oc as Q,oe as St,xb as B,yb as a}from"./chunk-L74P3D6T.js";import"./chunk-GAL4ENT6.js";var x=class e{constructor(t){this.http=t}apiUrl=`${W.apiUrl}/notifications`;getNotifications(){return this.http.get(this.apiUrl)}getNotificationById(t){return this.http.get(`${this.apiUrl}/${t}`)}getNotificationsByLoginId(t){return this.http.get(`${this.apiUrl}/user/${t}`)}createNotification(t){return this.http.post(this.apiUrl,t)}updateNotification(t,i){return this.http.put(`${this.apiUrl}/${t}`,i)}deleteNotification(t){return this.http.delete(`${this.apiUrl}/${t}`)}static \u0275fac=function(i){return new(i||e)(A(Q))};static \u0275prov=H({token:e,factory:e.\u0275fac,providedIn:"root"})};function ae(e,t){e&1&&(n(0,"mat-error"),a(1," Login ID is required "),o())}function re(e,t){e&1&&(n(0,"mat-error"),a(1," Title is required "),o())}function me(e,t){e&1&&(n(0,"mat-error"),a(1," Message is required "),o())}function le(e,t){e&1&&(n(0,"mat-error"),a(1," Notification type is required "),o())}var w=class e{constructor(t,i,m,d,p){this.fb=t;this.notificationService=i;this.snackBar=m;this.dialogRef=d;this.data=p;this.editMode=!!p?.notification,this.notificationForm=this.createForm(),this.editMode&&p.notification&&this.populateForm(p.notification)}notificationForm;editMode=!1;isLoading=!1;createForm(){return this.fb.group({loginId:["",[C.required,C.min(1)]],title:["",[C.required,C.minLength(3)]],message:["",[C.required,C.minLength(10)]],notificationType:["push",C.required],startDate:[""],expiryDate:[""],isRead:[!1]})}populateForm(t){this.notificationForm.patchValue({loginId:t.loginId,title:t.title,message:t.message,notificationType:t.notificationType||"push",startDate:t.startDate?new Date(t.startDate):"",expiryDate:t.expiryDate?new Date(t.expiryDate):"",isRead:t.isRead||!1})}onSubmit(){if(this.notificationForm.valid&&!this.isLoading){this.isLoading=!0;let t=this.notificationForm.value,i={loginId:t.loginId,title:t.title,message:t.message,notificationType:t.notificationType,startDate:t.startDate?t.startDate.toISOString().split("T")[0]:void 0,expiryDate:t.expiryDate?t.expiryDate.toISOString().split("T")[0]:void 0,isRead:t.isRead};this.editMode&&this.data.notification?(i.notificationId=this.data.notification.notificationId,this.updateNotification(i)):this.createNotification(i)}}createNotification(t){this.notificationService.createNotification(t).subscribe({next:i=>{this.snackBar.open("Notification created successfully","Close",{duration:3e3}),this.dialogRef.close(i)},error:i=>{console.error("Error creating notification:",i),this.snackBar.open("Error creating notification","Close",{duration:3e3}),this.isLoading=!1}})}updateNotification(t){this.notificationService.updateNotification(t.notificationId,t).subscribe({next:i=>{this.snackBar.open("Notification updated successfully","Close",{duration:3e3}),this.dialogRef.close(i)},error:i=>{console.error("Error updating notification:",i),this.snackBar.open("Error updating notification","Close",{duration:3e3}),this.isLoading=!1}})}static \u0275fac=function(i){return new(i||e)(f(at),f(x),f(T),f(Ht),f(At))};static \u0275cmp=v({type:e,selectors:[["app-notification-form"]],standalone:!0,features:[S],decls:54,vars:12,consts:[["startPicker",""],["expiryPicker",""],["mat-dialog-title",""],[3,"ngSubmit","formGroup"],["appearance","fill",1,"full-width"],["matInput","","formControlName","loginId","type","number","required",""],[4,"ngIf"],["matInput","","formControlName","title","required",""],["matInput","","formControlName","message","rows","4","required",""],["formControlName","notificationType","required",""],["value","push"],["value","email"],["matInput","","formControlName","startDate",3,"matDatepicker"],["matSuffix","",3,"for"],["matInput","","formControlName","expiryDate",3,"matDatepicker"],[1,"checkbox-container"],["formControlName","isRead"],[1,"button-container"],["mat-button","","type","button","mat-dialog-close",""],["mat-raised-button","","color","primary","type","submit",3,"disabled"]],template:function(i,m){if(i&1){let d=b();n(0,"h2",2),a(1),o(),n(2,"mat-dialog-content")(3,"form",3),_("ngSubmit",function(){return N(d),M(m.onSubmit())}),n(4,"mat-form-field",4)(5,"mat-label"),a(6,"Login ID"),o(),s(7,"input",5),c(8,ae,2,0,"mat-error",6),o(),n(9,"mat-form-field",4)(10,"mat-label"),a(11,"Title"),o(),s(12,"input",7),c(13,re,2,0,"mat-error",6),o(),n(14,"mat-form-field",4)(15,"mat-label"),a(16,"Message"),o(),s(17,"textarea",8),c(18,me,2,0,"mat-error",6),o(),n(19,"mat-form-field",4)(20,"mat-label"),a(21,"Notification Type"),o(),n(22,"mat-select",9)(23,"mat-option",10),a(24,"Push Notification"),o(),n(25,"mat-option",11),a(26,"Email"),o()(),c(27,le,2,0,"mat-error",6),o(),n(28,"mat-form-field",4)(29,"mat-label"),a(30,"Start Date"),o(),s(31,"input",12),n(32,"mat-hint"),a(33,"Leave empty for immediate delivery"),o(),s(34,"mat-datepicker-toggle",13)(35,"mat-datepicker",null,0),o(),n(37,"mat-form-field",4)(38,"mat-label"),a(39,"Expiry Date"),o(),s(40,"input",14),n(41,"mat-hint"),a(42,"Leave empty for no expiry"),o(),s(43,"mat-datepicker-toggle",13)(44,"mat-datepicker",null,1),o(),n(46,"div",15)(47,"mat-checkbox",16),a(48,"Mark as Read"),o()(),n(49,"div",17)(50,"button",18),a(51,"Cancel"),o(),n(52,"button",19),a(53),o()()()()}if(i&2){let d,p,q,L,V=B(36),j=B(45);r(),u("",m.editMode?"Edit":"Create"," Notification"),r(2),l("formGroup",m.notificationForm),r(5),l("ngIf",(d=m.notificationForm.get("loginId"))==null?null:d.hasError("required")),r(5),l("ngIf",(p=m.notificationForm.get("title"))==null?null:p.hasError("required")),r(5),l("ngIf",(q=m.notificationForm.get("message"))==null?null:q.hasError("required")),r(9),l("ngIf",(L=m.notificationForm.get("notificationType"))==null?null:L.hasError("required")),r(4),l("matDatepicker",V),r(3),l("for",V),r(6),l("matDatepicker",j),r(3),l("for",j),r(9),l("disabled",m.notificationForm.invalid||m.isLoading),r(),u(" ",m.isLoading?"Saving...":m.editMode?"Update":"Create"," ")}},dependencies:[D,z,rt,tt,X,et,Y,Z,nt,it,ot,xt,_t,ut,ht,gt,Ct,Mt,Nt,kt,Tt,lt,I,E,P,Gt,zt,Jt,k,It,yt,Dt,Et,mt,Qt,Kt],styles:[".full-width[_ngcontent-%COMP%]{width:100%;margin-bottom:15px}.checkbox-container[_ngcontent-%COMP%]{margin:16px 0}.button-container[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:8px;margin-top:16px}mat-dialog-content[_ngcontent-%COMP%]{min-width:500px;max-width:600px}"]})};function ce(e,t){e&1&&(n(0,"th",17),a(1," Login ID "),o())}function pe(e,t){if(e&1&&(n(0,"td",18),a(1),o()),e&2){let i=t.$implicit;r(),u(" ",i.loginId," ")}}function se(e,t){e&1&&(n(0,"th",17),a(1," Title "),o())}function de(e,t){if(e&1&&(n(0,"td",18),a(1),o()),e&2){let i=t.$implicit;r(),u(" ",i.title," ")}}function fe(e,t){e&1&&(n(0,"th",17),a(1," Message "),o())}function ue(e,t){if(e&1&&(n(0,"td",18)(1,"span",19),a(2),y(3,"slice"),o()()),e&2){let i=t.$implicit;r(),l("matTooltip",i.message),r(),U(" ",G(3,3,i.message,0,50),"",i.message.length>50?"...":""," ")}}function ge(e,t){e&1&&(n(0,"th",17),a(1," Type "),o())}function he(e,t){if(e&1&&(n(0,"td",18)(1,"span",20),a(2),o()()),e&2){let i=t.$implicit;r(),O("type-push",i.notificationType==="push")("type-email",i.notificationType==="email"),r(),u(" ",i.notificationType||"push"," ")}}function Ce(e,t){e&1&&(n(0,"th",17),a(1," Start Date "),o())}function _e(e,t){if(e&1&&(n(0,"td",18),a(1),y(2,"date"),o()),e&2){let i=t.$implicit;r(),u(" ",i.startDate?$(2,1,i.startDate,"short"):"Immediate"," ")}}function xe(e,t){e&1&&(n(0,"th",17),a(1," Expiry Date "),o())}function Ne(e,t){if(e&1&&(n(0,"td",18),a(1),y(2,"date"),o()),e&2){let i=t.$implicit;r(),u(" ",i.expiryDate?$(2,1,i.expiryDate,"short"):"No expiry"," ")}}function Me(e,t){e&1&&(n(0,"th",17),a(1," Status "),o())}function ve(e,t){if(e&1&&(n(0,"td",18)(1,"span",21),a(2),o()()),e&2){let i=t.$implicit;r(),O("read",i.isRead)("unread",!i.isRead),r(),u(" ",i.isRead?"Read":"Unread"," ")}}function be(e,t){e&1&&(n(0,"th",17),a(1," Actions "),o())}function Se(e,t){if(e&1){let i=b();n(0,"td",18)(1,"button",22),_("click",function(){let d=N(i).$implicit,p=R();return M(p.openNotificationForm(d))}),n(2,"mat-icon"),a(3,"edit"),o()(),n(4,"button",23),_("click",function(){let d=N(i).$implicit,p=R();return M(p.deleteNotification(d))}),n(5,"mat-icon"),a(6,"delete"),o()()()}}function ye(e,t){e&1&&s(0,"tr",24)}function De(e,t){e&1&&s(0,"tr",25)}var F=class e{constructor(t,i,m){this.notificationService=t;this.dialog=i;this.snackBar=m}notifications=[];displayedColumns=["loginId","title","message","notificationType","startDate","expiryDate","isRead","actions"];ngOnInit(){this.loadNotifications()}loadNotifications(){this.notificationService.getNotifications().subscribe({next:t=>{this.notifications=t},error:t=>{console.error("Error loading notifications:",t),this.snackBar.open("Error loading notifications","Close",{duration:3e3})}})}openNotificationForm(t){this.dialog.open(w,{width:"600px",data:{notification:t}}).afterClosed().subscribe(m=>{m&&this.loadNotifications()})}deleteNotification(t){confirm(`Are you sure you want to delete the notification "${t.title}"?`)&&this.notificationService.deleteNotification(t.notificationId).subscribe({next:()=>{this.snackBar.open("Notification deleted successfully","Close",{duration:3e3}),this.loadNotifications()},error:i=>{console.error("Error deleting notification:",i),this.snackBar.open("Error deleting notification","Close",{duration:3e3})}})}static \u0275fac=function(i){return new(i||e)(f(x),f(Ut),f(T))};static \u0275cmp=v({type:e,selectors:[["app-notifications-page"]],standalone:!0,features:[S],decls:40,vars:3,consts:[[1,"container"],[1,"header-content"],["mat-raised-button","","color","primary",3,"click"],[1,"table-container"],["mat-table","",1,"mat-elevation-z2",3,"dataSource"],["matColumnDef","loginId"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","title"],["matColumnDef","message"],["matColumnDef","notificationType"],["matColumnDef","startDate"],["matColumnDef","expiryDate"],["matColumnDef","isRead"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],[1,"message-preview",3,"matTooltip"],[1,"type-badge"],[1,"status-badge"],["mat-icon-button","","color","primary","matTooltip","Edit notification",3,"click"],["mat-icon-button","","color","warn","matTooltip","Delete notification",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(i,m){i&1&&(n(0,"div",0)(1,"mat-card")(2,"mat-card-header")(3,"mat-card-title")(4,"div",1)(5,"h2"),a(6,"Manage Notifications"),o(),n(7,"button",2),_("click",function(){return m.openNotificationForm()}),n(8,"mat-icon"),a(9,"add"),o(),a(10," Add New Notification "),o()()()(),n(11,"mat-card-content")(12,"div",3)(13,"table",4),g(14,5),c(15,ce,2,0,"th",6)(16,pe,2,1,"td",7),h(),g(17,8),c(18,se,2,0,"th",6)(19,de,2,1,"td",7),h(),g(20,9),c(21,fe,2,0,"th",6)(22,ue,4,7,"td",7),h(),g(23,10),c(24,ge,2,0,"th",6)(25,he,3,5,"td",7),h(),g(26,11),c(27,Ce,2,0,"th",6)(28,_e,3,4,"td",7),h(),g(29,12),c(30,xe,2,0,"th",6)(31,Ne,3,4,"td",7),h(),g(32,13),c(33,Me,2,0,"th",6)(34,ve,3,5,"td",7),h(),g(35,14),c(36,be,2,0,"th",6)(37,Se,7,0,"td",7),h(),c(38,ye,1,0,"tr",15)(39,De,1,0,"tr",16),o()()()()()),i&2&&(r(13),l("dataSource",m.notifications),r(25),l("matHeaderRowDef",m.displayedColumns),r(),l("matRowDefColumns",m.displayedColumns))},dependencies:[D,K,J,jt,Pt,Ft,$t,Ot,wt,qt,Rt,Bt,Lt,Vt,I,E,vt,St,bt,k,P,ft,ct,st,dt,pt,Xt,Wt],styles:[".container[_ngcontent-%COMP%]{padding:20px;max-width:1400px;margin:0 auto}.header-content[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;width:100%}.header-content[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;color:#333}.table-container[_ngcontent-%COMP%]{overflow-x:auto;margin-top:20px}.mat-mdc-table[_ngcontent-%COMP%]{width:100%;background:#fff}.message-preview[_ngcontent-%COMP%]{display:inline-block;max-width:200px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;cursor:help}.type-badge[_ngcontent-%COMP%]{padding:4px 8px;border-radius:12px;font-size:12px;font-weight:500;text-transform:uppercase}.type-push[_ngcontent-%COMP%]{background-color:#e3f2fd;color:#1976d2}.type-email[_ngcontent-%COMP%]{background-color:#f3e5f5;color:#7b1fa2}.status-badge[_ngcontent-%COMP%]{padding:4px 8px;border-radius:12px;font-size:12px;font-weight:500;text-transform:uppercase}.read[_ngcontent-%COMP%]{background-color:#e8f5e8;color:#2e7d32}.unread[_ngcontent-%COMP%]{background-color:#fff3e0;color:#f57c00}.mat-mdc-cell[_ngcontent-%COMP%]{padding:8px}.mat-mdc-header-cell[_ngcontent-%COMP%]{font-weight:600;color:#333}"]})};var gi=[{path:"",component:F,title:"Notifications"}];export{gi as NOTIFICATIONS_ROUTES};
