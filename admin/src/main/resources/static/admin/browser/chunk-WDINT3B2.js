import{a as Oe,b as Ne}from"./chunk-PXUWE5VQ.js";import{a as Ee,b as Te,c as we,d as Fe,e as Pe,f as ke,h as H}from"./chunk-N242QITP.js";import{a as $}from"./chunk-CTIDPCH7.js";import{a as De,b as Le}from"./chunk-RNMBNA6J.js";import{a as fe,b as Ce,c as ye,d as _e,e as he,f as be,g as xe,h as Me,i as Se,j as ve,k as Ie}from"./chunk-LZWXBBKL.js";import{b as O,c as N,d as j,e as A}from"./chunk-PNTWHU5I.js";import{l as ge,m as ue}from"./chunk-BYQJPZHC.js";import"./chunk-EFSOZXE7.js";import{a as k,b as se,c as de,h as D,i as L}from"./chunk-TGCRKVSN.js";import{$c as oe,Ab as Y,Bb as r,Ca as I,Cb as M,Db as b,Ea as m,Fa as f,Fb as J,Gb as K,Hb as Q,Jb as E,Kb as X,Sc as F,Ua as s,Uc as ee,Wc as P,Xc as te,Za as p,_c as ie,ab as W,ca as v,cd as ne,fd as re,gb as n,gc as Z,hb as o,hc as T,he as pe,ib as h,id as ae,jb as C,jd as le,ka as g,kb as y,kd as me,la as u,ld as ce,mb as x,ne as R,pb as d,pc as w,pe as B,qe as V,rb as _,re as U,se as z}from"./chunk-7VMAUSLR.js";import"./chunk-GAL4ENT6.js";function We(t,e){t&1&&(n(0,"mat-error"),r(1," Name is required "),o())}function Ye(t,e){if(t&1){let i=x();n(0,"div",22)(1,"img",23),d("error",function(c){g(i);let l=_();return u(l.onImageError(c))}),o(),n(2,"button",24),d("click",function(){g(i);let c=_();return u(c.removeThumbnail())}),n(3,"mat-icon"),r(4,"close"),o()()()}if(t&2){let i,a=_();m(),p("src",(i=a.categoryForm.get("thumbnailUrl"))==null?null:i.value,I)}}function Je(t,e){if(t&1&&(n(0,"mat-option",17),r(1),o()),t&2){let i=e.$implicit;p("value",i.categoryId),m(),b(" ",i.name," ")}}var G=class t{constructor(e,i,a,c,l){this.fb=e;this.categoryService=i;this.snackBar=a;this.dialogRef=c;this.data=l;this.editMode=!!l.category,this.availableParentCategories=l.categories.filter(S=>!this.editMode||S.categoryId!==l.category?.categoryId),this.categoryForm=this.fb.group({name:[l.category?.name||"",ee.required],description:[l.category?.description||""],categoryType:[l.category?.categoryType||""],isPublished:[l.category?.isPublished!==void 0?l.category.isPublished:!0],thumbnailUrl:[l.category?.thumbnailUrl||""],parentCategoryId:[l.category?.parentCategoryId||null]})}categoryForm;editMode=!1;availableParentCategories=[];onFileSelected(e){let i=e.target.files[0];if(i){let a=new FileReader;a.onload=c=>{this.categoryForm.patchValue({thumbnailUrl:c.target.result})},a.readAsDataURL(i)}}onImageError(e){console.error("Image failed to load:",e),this.snackBar.open("Failed to load image. Please check the URL.","Close",{duration:3e3})}removeThumbnail(){this.categoryForm.patchValue({thumbnailUrl:""})}onSubmit(){if(this.categoryForm.valid){let e=this.categoryForm.value;this.editMode?this.categoryService.updateCategory(this.data.category.categoryId,e).subscribe({next:()=>{this.snackBar.open("Category updated successfully","Close",{duration:3e3}),this.dialogRef.close(!0)},error:()=>{this.snackBar.open("Error updating category","Close",{duration:3e3})}}):this.categoryService.createCategory(e).subscribe({next:()=>{this.snackBar.open("Category created successfully","Close",{duration:3e3}),this.dialogRef.close(!0)},error:()=>{this.snackBar.open("Error creating category","Close",{duration:3e3})}})}}static \u0275fac=function(i){return new(i||t)(f(le),f($),f(j),f(Ee),f(Te))};static \u0275cmp=v({type:t,selectors:[["app-category-form"]],standalone:!0,features:[E],decls:49,vars:8,consts:[["fileInput",""],["mat-dialog-title",""],[3,"ngSubmit","formGroup"],["appearance","fill",1,"full-width"],["matInput","","formControlName","name","required",""],[4,"ngIf"],["matInput","","formControlName","description","rows","3"],["matInput","","formControlName","categoryType","placeholder","e.g., Astro, IT, Student Project, Academic, Professional"],[1,"toggle-section"],["formControlName","isPublished","color","primary"],[1,"thumbnail-section"],["matInput","","formControlName","thumbnailUrl","placeholder","Enter image URL or upload file"],[1,"file-upload-section"],["type","file","accept","image/*",2,"display","none",3,"change"],["mat-stroked-button","","type","button",3,"click"],["class","thumbnail-preview",4,"ngIf"],["formControlName","parentCategoryId"],[3,"value"],[3,"value",4,"ngFor","ngForOf"],[1,"button-container"],["mat-button","","type","button","mat-dialog-close",""],["mat-raised-button","","color","primary","type","submit",3,"disabled"],[1,"thumbnail-preview"],["alt","Thumbnail preview",1,"preview-image",3,"error","src"],["mat-icon-button","","type","button",1,"remove-thumbnail",3,"click"]],template:function(i,a){if(i&1){let c=x();n(0,"h2",1),r(1),o(),n(2,"mat-dialog-content")(3,"form",2),d("ngSubmit",function(){return g(c),u(a.onSubmit())}),n(4,"mat-form-field",3)(5,"mat-label"),r(6,"Name"),o(),h(7,"input",4),s(8,We,2,0,"mat-error",5),o(),n(9,"mat-form-field",3)(10,"mat-label"),r(11,"Description"),o(),h(12,"textarea",6),o(),n(13,"mat-form-field",3)(14,"mat-label"),r(15,"Category Type"),o(),h(16,"input",7),n(17,"mat-hint"),r(18,"Enter the type/domain of this category (dynamic field)"),o()(),n(19,"div",8)(20,"mat-slide-toggle",9),r(21," Published "),o(),n(22,"mat-hint"),r(23,"Toggle to control whether this category is visible to users"),o()(),n(24,"div",10)(25,"mat-form-field",3)(26,"mat-label"),r(27,"Thumbnail URL"),o(),h(28,"input",11),o(),n(29,"div",12)(30,"input",13,0),d("change",function(S){return g(c),u(a.onFileSelected(S))}),o(),n(32,"button",14),d("click",function(){g(c);let S=Y(31);return u(S.click())}),n(33,"mat-icon"),r(34,"upload"),o(),r(35," Upload Image "),o()(),s(36,Ye,5,1,"div",15),o(),n(37,"mat-form-field",3)(38,"mat-label"),r(39,"Parent Category"),o(),n(40,"mat-select",16)(41,"mat-option",17),r(42,"None"),o(),s(43,Je,2,2,"mat-option",18),o()(),n(44,"div",19)(45,"button",20),r(46,"Cancel"),o(),n(47,"button",21),r(48),o()()()()}if(i&2){let c,l;m(),b("",a.editMode?"Edit":"Create"," Category"),m(2),p("formGroup",a.categoryForm),m(5),p("ngIf",(c=a.categoryForm.get("name"))==null?null:c.hasError("required")),m(28),p("ngIf",(l=a.categoryForm.get("thumbnailUrl"))==null?null:l.value),m(5),p("value",null),m(2),p("ngForOf",a.availableParentCategories),m(4),p("disabled",a.categoryForm.invalid),m(),b(" ",a.editMode?"Update":"Create"," ")}},dependencies:[w,Z,T,ce,oe,F,P,te,ae,ne,re,L,D,k,de,se,N,O,ue,ge,pe,V,R,B,H,Fe,Pe,ke,A,z,U,Ne,Oe],styles:[".full-width[_ngcontent-%COMP%]{width:100%;margin-bottom:15px}.toggle-section[_ngcontent-%COMP%]{margin:15px 0;padding:12px 0}.toggle-section[_ngcontent-%COMP%]   mat-hint[_ngcontent-%COMP%]{font-size:12px;color:#0009;margin-top:4px;display:block}.button-container[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:8px;margin-top:16px}.thumbnail-section[_ngcontent-%COMP%]{margin:16px 0;padding:16px;border:1px solid #ddd;border-radius:4px;background-color:#fafafa}.file-upload-section[_ngcontent-%COMP%]{margin:12px 0}.thumbnail-preview[_ngcontent-%COMP%]{position:relative;display:inline-block;margin-top:12px}.preview-image[_ngcontent-%COMP%]{max-width:200px;max-height:150px;border:1px solid #ddd;border-radius:4px;object-fit:cover}.remove-thumbnail[_ngcontent-%COMP%]{position:absolute;top:-8px;right:-8px;background-color:#f44336;color:#fff}.remove-thumbnail[_ngcontent-%COMP%]:hover{background-color:#d32f2f}"]})};var Ke=()=>[5,10,20];function Qe(t,e){t&1&&(n(0,"th",19),r(1,"ID"),o())}function Xe(t,e){if(t&1&&(n(0,"td",20)(1,"span",21),r(2),o()()),t&2){let i=e.$implicit;m(2),M(i.categoryId)}}function Ze(t,e){t&1&&(n(0,"th",19),r(1,"Thumbnail"),o())}function et(t,e){if(t&1){let i=x();n(0,"img",25),d("error",function(c){g(i);let l=_(2);return u(l.onImageError(c))}),o()}if(t&2){let i=_().$implicit;p("src",i.thumbnailUrl,I)("alt",i.name+" thumbnail")}}function tt(t,e){t&1&&(n(0,"div",26)(1,"mat-icon"),r(2,"image"),o()())}function it(t,e){if(t&1&&(n(0,"td",20)(1,"div",22),s(2,et,1,2,"img",23)(3,tt,3,0,"div",24),o()()),t&2){let i=e.$implicit;m(2),p("ngIf",i.thumbnailUrl),m(),p("ngIf",!i.thumbnailUrl)}}function ot(t,e){t&1&&(n(0,"th",19),r(1,"Name"),o())}function nt(t,e){if(t&1&&(n(0,"td",20),r(1),o()),t&2){let i=e.$implicit;m(),M(i.name)}}function rt(t,e){t&1&&(n(0,"th",19),r(1,"Category Type"),o())}function at(t,e){if(t&1&&(n(0,"td",20)(1,"span",27),r(2),o()()),t&2){let i=e.$implicit;m(),W("type-"+(i.categoryType||"none")),m(),b(" ",i.categoryType||"Not Set"," ")}}function lt(t,e){t&1&&(n(0,"th",19),r(1,"Status"),o())}function mt(t,e){if(t&1&&(n(0,"td",20)(1,"span",28)(2,"mat-icon"),r(3),o(),r(4),o()()),t&2){let i=e.$implicit;m(),W(i.isPublished?"status-published":"status-draft"),m(2),M(i.isPublished?"check_circle":"unpublished"),m(),b(" ",i.isPublished?"Published":"Draft"," ")}}function ct(t,e){t&1&&(n(0,"th",19),r(1,"Description"),o())}function pt(t,e){if(t&1&&(n(0,"td",20),r(1),o()),t&2){let i=e.$implicit;m(),M(i.description)}}function st(t,e){t&1&&(n(0,"th",19),r(1,"Parent Category"),o())}function dt(t,e){if(t&1&&(n(0,"td",20),r(1),o()),t&2){let i=e.$implicit;m(),M(i.parentCategoryName||"-")}}function gt(t,e){t&1&&(n(0,"th",19),r(1,"Actions"),o())}function ut(t,e){if(t&1){let i=x();n(0,"td",20)(1,"button",29),d("click",function(){let c=g(i).$implicit,l=_();return u(l.editCategory(c))}),n(2,"mat-icon"),r(3,"edit"),o()(),n(4,"button",30),d("click",function(){let c=g(i).$implicit,l=_();return u(l.deleteCategory(c))}),n(5,"mat-icon"),r(6,"delete"),o()()()}}function ft(t,e){t&1&&h(0,"tr",31)}function Ct(t,e){t&1&&h(0,"tr",32)}var q=class t{constructor(e,i,a){this.categoryService=e;this.dialog=i;this.snackBar=a}categories=[];displayedColumns=["id","thumbnail","name","categoryType","description","parentCategory","actions"];pageIndex=0;pageSize=10;filterText="";filteredCategories=[];get pagedCategories(){let e=this.pageIndex*this.pageSize;return this.filteredCategories.slice(e,e+this.pageSize)}ngOnInit(){this.loadCategories()}loadCategories(){this.categoryService.getCategories().subscribe(e=>{this.categories=e,this.onFilterChange()})}openCategoryForm(e){this.dialog.open(G,{width:"500px",data:{category:e,categories:this.categories}}).afterClosed().subscribe(a=>{a&&this.loadCategories()})}editCategory(e){this.openCategoryForm(e)}deleteCategory(e){confirm("Are you sure you want to delete this category?")&&this.categoryService.deleteCategory(e.categoryId).subscribe({next:()=>{this.loadCategories(),this.snackBar.open("Category deleted successfully","Close",{duration:3e3})},error:()=>{this.snackBar.open("Error deleting category","Close",{duration:3e3})}})}onPageChange(e){this.pageIndex=e.pageIndex,this.pageSize=e.pageSize}onFilterChange(){this.pageIndex=0;let e=this.filterText.trim().toLowerCase();e?this.filteredCategories=this.categories.filter(i=>i.name&&i.name.toLowerCase().includes(e)||i.description&&i.description.toLowerCase().includes(e)||i.categoryType&&i.categoryType.toLowerCase().includes(e)):this.filteredCategories=this.categories.slice()}onImageError(e){e.target.style.display="none";let i=e.target.parentNode;if(i&&!i.querySelector(".no-thumbnail")){let a=document.createElement("div");a.className="no-thumbnail",a.innerHTML="<mat-icon>broken_image</mat-icon>",i.appendChild(a)}}static \u0275fac=function(i){return new(i||t)(f($),f(we),f(j))};static \u0275cmp=v({type:t,selectors:[["app-category-list"]],standalone:!0,features:[E],decls:40,vars:9,consts:[[1,"container"],[1,"header"],["mat-raised-button","","color","primary",3,"click"],["appearance","outline",2,"width","300px","margin-bottom","16px"],["matInput","","placeholder","Type to filter by name, type, or description...",3,"ngModelChange","input","ngModel"],["mat-table","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","id"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","thumbnail"],["matColumnDef","name"],["matColumnDef","categoryType"],["matColumnDef","isPublished"],["matColumnDef","description"],["matColumnDef","parentCategory"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],[3,"page","length","pageSize","pageIndex","pageSizeOptions"],["mat-header-cell",""],["mat-cell",""],[1,"id-badge"],[1,"thumbnail-cell"],["class","category-thumbnail",3,"src","alt","error",4,"ngIf"],["class","no-thumbnail",4,"ngIf"],[1,"category-thumbnail",3,"error","src","alt"],[1,"no-thumbnail"],[1,"category-type-badge"],[1,"status-badge"],["mat-icon-button","","color","primary",3,"click"],["mat-icon-button","","color","warn",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(i,a){i&1&&(n(0,"div",0)(1,"div",1)(2,"h1"),r(3,"Categories"),o(),n(4,"button",2),d("click",function(){return a.openCategoryForm()}),n(5,"mat-icon"),r(6,"add"),o(),r(7," Add Category "),o()(),n(8,"mat-form-field",3)(9,"mat-label"),r(10,"Filter categories"),o(),n(11,"input",4),Q("ngModelChange",function(l){return K(a.filterText,l)||(a.filterText=l),l}),d("input",function(){return a.onFilterChange()}),o()(),n(12,"table",5),C(13,6),s(14,Qe,2,0,"th",7)(15,Xe,3,1,"td",8),y(),C(16,9),s(17,Ze,2,0,"th",7)(18,it,4,2,"td",8),y(),C(19,10),s(20,ot,2,0,"th",7)(21,nt,2,1,"td",8),y(),C(22,11),s(23,rt,2,0,"th",7)(24,at,3,3,"td",8),y(),C(25,12),s(26,lt,2,0,"th",7)(27,mt,5,4,"td",8),y(),C(28,13),s(29,ct,2,0,"th",7)(30,pt,2,1,"td",8),y(),C(31,14),s(32,st,2,0,"th",7)(33,dt,2,1,"td",8),y(),C(34,15),s(35,gt,2,0,"th",7)(36,ut,7,0,"td",8),y(),s(37,ft,1,0,"tr",16)(38,Ct,1,0,"tr",17),o(),n(39,"mat-paginator",18),d("page",function(l){return a.onPageChange(l)}),o()()),i&2&&(m(11),J("ngModel",a.filterText),m(),p("dataSource",a.pagedCategories),m(25),p("matHeaderRowDef",a.displayedColumns),m(),p("matRowDefColumns",a.displayedColumns),m(),p("length",a.categories.length)("pageSize",a.pageSize)("pageIndex",a.pageIndex)("pageSizeOptions",X(8,Ke)))},dependencies:[w,T,Ie,fe,ye,xe,_e,Ce,Me,he,be,Se,ve,V,R,B,z,U,H,A,Le,De,L,D,k,N,O,me,F,P,ie],styles:[".container[_ngcontent-%COMP%]{padding:20px}.header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px}table[_ngcontent-%COMP%]{width:100%}.id-badge[_ngcontent-%COMP%]{background-color:#e3f2fd;color:#1976d2;padding:4px 8px;border-radius:12px;font-size:12px;font-weight:500;font-family:Courier New,monospace}.thumbnail-cell[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:60px;height:60px}.category-thumbnail[_ngcontent-%COMP%]{width:50px;height:50px;object-fit:cover;border-radius:4px;border:1px solid #ddd}.no-thumbnail[_ngcontent-%COMP%]{width:50px;height:50px;display:flex;align-items:center;justify-content:center;background-color:#f5f5f5;border:1px solid #ddd;border-radius:4px;color:#999}.category-type-badge[_ngcontent-%COMP%]{padding:4px 8px;border-radius:12px;font-size:12px;font-weight:500;text-transform:capitalize}.type-Astro[_ngcontent-%COMP%]{background-color:#e8f5e8;color:#2e7d32}.type-IT[_ngcontent-%COMP%]{background-color:#e3f2fd;color:#1976d2}.type-Student[_ngcontent-%COMP%]{background-color:#fff3e0;color:#f57c00}.type-none[_ngcontent-%COMP%]{background-color:#f5f5f5;color:#666}.type-Academic[_ngcontent-%COMP%]{background-color:#f3e5f5;color:#7b1fa2}.type-Professional[_ngcontent-%COMP%]{background-color:#fce4ec;color:#c2185b}"]})};var Zt=[{path:"",component:q}];export{Zt as CATEGORY_ROUTES};
