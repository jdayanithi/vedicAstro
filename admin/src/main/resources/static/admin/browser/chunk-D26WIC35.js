import{a as O}from"./chunk-FSSHUOUS.js";import{a as D,b as k}from"./chunk-PXUWE5VQ.js";import{a as vt,b as bt,c as xt,d as Ft,e as Pt,f as Et,h as y}from"./chunk-N242QITP.js";import{a as st,b as gt}from"./chunk-OZIBLGHY.js";import{a as Q,b as W,c as X,e as Y,g as Z}from"./chunk-ZNL3IKF2.js";import{a as yt,b as Dt}from"./chunk-RNMBNA6J.js";import{a as dt,b as ct,c as pt,d as ut,e as ft,f as _t,g as Tt,h as Ct,i as ht,j as Mt,k as St,l as wt,m as It}from"./chunk-LZWXBBKL.js";import{b as nt,c as ot,d as w,e as I}from"./chunk-PNTWHU5I.js";import"./chunk-BYQJPZHC.js";import"./chunk-EFSOZXE7.js";import{a as tt,b as et,h as at,i as it}from"./chunk-TGCRKVSN.js";import{$c as H,Bb as r,Db as _,Ea as m,Fa as d,Jb as b,Kb as z,Sc as j,Ua as c,Uc as R,Wc as A,Xc as G,Za as s,ca as S,cd as $,fd as q,gb as i,hb as o,hc as x,ib as u,id as U,jb as h,jd as J,ka as T,kb as M,la as C,ld as K,mb as v,ne as P,pb as p,pc as F,pe as rt,qe as E,rb as f,re as lt,se as mt}from"./chunk-7VMAUSLR.js";import{a as L,b as V}from"./chunk-GAL4ENT6.js";function At(a,t){a&1&&(i(0,"mat-error"),r(1," Tag name is required "),o())}var N=class a{constructor(t,e,n,l,g){this.fb=t;this.tagService=e;this.snackBar=n;this.dialogRef=l;this.data=g;this.editMode=!!g?.tag,this.tagForm=this.createForm(),this.editMode&&g.tag&&this.populateForm(g.tag)}tagForm;editMode=!1;isLoading=!1;createForm(){return this.fb.group({tagName:["",[R.required,R.minLength(2)]],description:[""],statusFlag:[!0]})}populateForm(t){console.log("Populating form with tag data:",t),this.tagForm.patchValue({tagName:t.tagName,description:t.description||"",statusFlag:t.statusFlag!==void 0?t.statusFlag:!0}),console.log("Form values after population:",this.tagForm.value)}onSubmit(){if(this.tagForm.valid&&!this.isLoading){this.isLoading=!0;let t=this.tagForm.value;console.log("Form submission - form value:",t);let e={tagName:t.tagName,description:t.description,statusFlag:t.statusFlag};console.log("Form submission - tag data being sent:",e),this.editMode&&this.data.tag?(e.tagId=this.data.tag.tagId,this.updateTag(e)):this.createTag(e)}else console.log("Form is invalid or loading:",{valid:this.tagForm.valid,loading:this.isLoading,formErrors:this.tagForm.errors,formValue:this.tagForm.value})}createTag(t){console.log("Creating tag with data:",t),this.tagService.createTag(t).subscribe({next:e=>{console.log("Tag created successfully:",e),this.snackBar.open("Tag created successfully","Close",{duration:3e3}),this.dialogRef.close(e)},error:e=>{console.error("Error creating tag:",e),this.snackBar.open("Error creating tag","Close",{duration:3e3}),this.isLoading=!1}})}updateTag(t){console.log("Updating tag with data:",t),this.tagService.updateTag(t.tagId,t).subscribe({next:e=>{console.log("Tag updated successfully:",e),this.snackBar.open("Tag updated successfully","Close",{duration:3e3}),this.dialogRef.close(e)},error:e=>{console.error("Error updating tag:",e),this.snackBar.open("Error updating tag","Close",{duration:3e3}),this.isLoading=!1}})}static \u0275fac=function(e){return new(e||a)(d(J),d(O),d(w),d(vt),d(bt))};static \u0275cmp=S({type:a,selectors:[["app-tag-form"]],standalone:!0,features:[b],decls:21,vars:5,consts:[["mat-dialog-title",""],[3,"ngSubmit","formGroup"],["appearance","fill",1,"full-width"],["matInput","","formControlName","tagName","required",""],[4,"ngIf"],["matInput","","formControlName","description","rows","3"],[1,"status-toggle"],["formControlName","statusFlag"],[1,"button-container"],["mat-button","","type","button","mat-dialog-close",""],["mat-raised-button","","color","primary","type","submit",3,"disabled"]],template:function(e,n){if(e&1&&(i(0,"h2",0),r(1),o(),i(2,"mat-dialog-content")(3,"form",1),p("ngSubmit",function(){return n.onSubmit()}),i(4,"mat-form-field",2)(5,"mat-label"),r(6,"Tag Name"),o(),u(7,"input",3),c(8,At,2,0,"mat-error",4),o(),i(9,"mat-form-field",2)(10,"mat-label"),r(11,"Description"),o(),u(12,"textarea",5),o(),i(13,"div",6)(14,"mat-slide-toggle",7),r(15," Enable Tag "),o()(),i(16,"div",8)(17,"button",9),r(18,"Cancel"),o(),i(19,"button",10),r(20),o()()()()),e&2){let l;m(),_("",n.editMode?"Edit":"Create"," Tag"),m(2),s("formGroup",n.tagForm),m(5),s("ngIf",(l=n.tagForm.get("tagName"))==null?null:l.hasError("required")),m(11),s("disabled",n.tagForm.invalid||n.isLoading),m(),_(" ",n.isLoading?"Saving...":n.editMode?"Update":"Create"," ")}},dependencies:[F,x,K,H,j,A,G,U,$,q,it,at,tt,et,ot,nt,E,P,y,Ft,Pt,Et,I,k,D],styles:[".full-width[_ngcontent-%COMP%]{width:100%;margin-bottom:15px}.status-toggle[_ngcontent-%COMP%]{margin:16px 0}.button-container[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:8px;margin-top:16px}mat-dialog-content[_ngcontent-%COMP%]{min-width:400px;max-width:500px}"]})};var Gt=()=>[5,10,20];function Ht(a,t){a&1&&(i(0,"div",10),u(1,"mat-spinner",11),i(2,"p"),r(3,"Loading tags..."),o()())}function $t(a,t){a&1&&(i(0,"th",21),r(1," Name "),o())}function qt(a,t){if(a&1&&(i(0,"td",22),r(1),o()),a&2){let e=t.$implicit;m(),_(" ",e.tagName," ")}}function Ut(a,t){a&1&&(i(0,"th",21),r(1," Description "),o())}function Jt(a,t){if(a&1&&(i(0,"td",22),r(1),o()),a&2){let e=t.$implicit;m(),_(" ",e.description||"-"," ")}}function Kt(a,t){a&1&&(i(0,"th",21),r(1," Status "),o())}function Qt(a,t){if(a&1){let e=v();i(0,"td",22)(1,"mat-slide-toggle",23),p("change",function(l){let g=T(e).$implicit,kt=f(2);return C(kt.toggleTagStatus(g,l))}),o()()}if(a&2){let e=t.$implicit;m(),s("checked",e.statusFlag!==!1)}}function Wt(a,t){a&1&&(i(0,"th",21),r(1," Actions "),o())}function Xt(a,t){if(a&1){let e=v();i(0,"td",22)(1,"button",24),p("click",function(){let l=T(e).$implicit,g=f(2);return C(g.editTag(l))}),i(2,"mat-icon"),r(3,"edit"),o()(),i(4,"button",25),p("click",function(){let l=T(e).$implicit,g=f(2);return C(g.deleteTag(l))}),i(5,"mat-icon"),r(6,"delete"),o()()()}}function Yt(a,t){a&1&&u(0,"tr",26)}function Zt(a,t){a&1&&u(0,"tr",27)}function te(a,t){if(a&1&&(i(0,"table",12),h(1,13),c(2,$t,2,0,"th",14)(3,qt,2,1,"td",15),M(),h(4,16),c(5,Ut,2,0,"th",14)(6,Jt,2,1,"td",15),M(),h(7,17),c(8,Kt,2,0,"th",14)(9,Qt,2,1,"td",15),M(),h(10,18),c(11,Wt,2,0,"th",14)(12,Xt,7,0,"td",15),M(),c(13,Yt,1,0,"tr",19)(14,Zt,1,0,"tr",20),o()),a&2){let e=f();s("dataSource",e.pagedTags),m(13),s("matHeaderRowDef",e.displayedColumns),m(),s("matRowDefColumns",e.displayedColumns)}}function ee(a,t){if(a&1){let e=v();i(0,"div",28)(1,"mat-icon"),r(2,"local_offer"),o(),i(3,"p"),r(4,"No tags found."),o(),i(5,"button",4),p("click",function(){T(e);let l=f();return C(l.openTagForm())}),r(6," Create First Tag "),o()()}}var B=class a{constructor(t,e,n){this.tagService=t;this.snackBar=e;this.dialog=n}tags=[];pageIndex=0;pageSize=10;isLoading=!1;displayedColumns=["tagName","description","statusFlag","actions"];get pagedTags(){let t=this.pageIndex*this.pageSize;return this.tags.slice(t,t+this.pageSize)}ngOnInit(){this.loadTags()}loadTags(){this.isLoading=!0,this.tagService.getTags().subscribe({next:t=>{this.tags=t,this.pageIndex=0,this.isLoading=!1},error:t=>{console.error("Error loading tags:",t),this.snackBar.open("Error loading tags","Close",{duration:3e3}),this.isLoading=!1}})}openTagForm(t){this.dialog.open(N,{width:"500px",data:{tag:t}}).afterClosed().subscribe(n=>{n&&this.loadTags()})}editTag(t){this.openTagForm(t)}toggleTagStatus(t,e){let n=e.checked,l=V(L({},t),{statusFlag:n});this.tagService.updateTag(t.tagId,l).subscribe({next:()=>{this.snackBar.open(`Tag ${n?"enabled":"disabled"}`,"Close",{duration:2e3}),this.loadTags()},error:g=>{console.error("Error updating tag status:",g),this.snackBar.open("Error updating tag status","Close",{duration:3e3}),this.loadTags()}})}deleteTag(t){confirm(`Are you sure you want to delete the tag "${t.tagName}"?`)&&this.tagService.deleteTag(t.tagId).subscribe({next:()=>{this.snackBar.open("Tag deleted successfully","Close",{duration:3e3}),this.loadTags()},error:e=>{console.error("Error deleting tag:",e),this.snackBar.open("Error deleting tag","Close",{duration:3e3})}})}onPageChange(t){this.pageIndex=t.pageIndex,this.pageSize=t.pageSize}static \u0275fac=function(e){return new(e||a)(d(O),d(w),d(xt))};static \u0275cmp=S({type:a,selectors:[["app-tags-page"]],standalone:!0,features:[b],decls:21,vars:9,consts:[[1,"container"],[1,"header-content"],[1,"header-actions"],["mat-icon-button","","color","primary","matTooltip","Refresh tags",3,"click","disabled"],["mat-raised-button","","color","primary",3,"click"],[1,"table-container"],["class","loading-container",4,"ngIf"],["mat-table","","class","mat-elevation-z2",3,"dataSource",4,"ngIf"],[3,"page","length","pageSize","pageIndex","pageSizeOptions"],["class","no-data",4,"ngIf"],[1,"loading-container"],["diameter","50"],["mat-table","",1,"mat-elevation-z2",3,"dataSource"],["matColumnDef","tagName"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","description"],["matColumnDef","statusFlag"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],[3,"change","checked"],["mat-icon-button","","aria-label","Edit",3,"click"],["mat-icon-button","","aria-label","Delete","color","warn",3,"click"],["mat-header-row",""],["mat-row",""],[1,"no-data"]],template:function(e,n){e&1&&(i(0,"div",0)(1,"mat-card")(2,"mat-card-header")(3,"mat-card-title")(4,"div",1)(5,"h2"),r(6,"Manage Tags"),o(),i(7,"div",2)(8,"button",3),p("click",function(){return n.loadTags()}),i(9,"mat-icon"),r(10,"refresh"),o()(),i(11,"button",4),p("click",function(){return n.openTagForm()}),i(12,"mat-icon"),r(13,"add"),o(),r(14," Add New Tag "),o()()()()(),i(15,"mat-card-content")(16,"div",5),c(17,Ht,4,0,"div",6)(18,te,15,3,"table",7),i(19,"mat-paginator",8),p("page",function(g){return n.onPageChange(g)}),o(),c(20,ee,7,0,"div",9),o()()()()),e&2&&(m(8),s("disabled",n.isLoading),m(9),s("ngIf",n.isLoading),m(),s("ngIf",!n.isLoading),m(),s("length",n.tags.length)("pageSize",n.pageSize)("pageIndex",n.pageIndex)("pageSizeOptions",z(8,Gt)),m(),s("ngIf",!n.isLoading&&n.tags.length===0))},dependencies:[F,x,St,dt,pt,Tt,ut,ct,Ct,ft,_t,ht,Mt,E,P,rt,mt,lt,I,y,k,D,Z,Q,X,Y,W,It,wt,gt,st,Dt,yt],styles:[".container[_ngcontent-%COMP%]{padding:20px;max-width:1200px;margin:0 auto}.header-content[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;width:100%}.header-content[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;color:#333}.header-actions[_ngcontent-%COMP%]{display:flex;gap:8px;align-items:center}.table-container[_ngcontent-%COMP%]{width:100%;overflow-x:auto;margin-top:20px}.loading-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:40px;text-align:center}.loading-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-top:16px;color:#666}.no-data[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:40px;text-align:center;color:#666}.no-data[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:48px;height:48px;width:48px;margin-bottom:16px;opacity:.6}.no-data[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-bottom:16px;font-size:16px}table[_ngcontent-%COMP%]{width:100%}th.mat-header-cell[_ngcontent-%COMP%]{font-weight:600;color:#333}.mat-mdc-button[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{margin-right:8px}.mat-mdc-table[_ngcontent-%COMP%]{width:100%;background:#fff}"]})};var He=[{path:"",component:B}];export{He as TAGS_ROUTES};
