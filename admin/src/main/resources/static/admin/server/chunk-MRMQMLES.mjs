import './polyfills.server.mjs';
import{a as Wt,b as Jt}from"./chunk-NM3F3CRQ.mjs";import{a as Tt,b as wt,c as Ot,d as kt}from"./chunk-5ENVL3KB.mjs";import{a as gt,b as _t,c as xt,e as ht,g as Ct}from"./chunk-AF37YSCE.mjs";import{a as Vt,b as qt,c as Bt,d as $t,e as Ht,f as Ut,g as At,h as Lt,i as Gt,j as jt,k as zt}from"./chunk-NOOZMP64.mjs";import{a as Ft,b as Rt}from"./chunk-MICQ7PJR.mjs";import{b as yt,c as vt,q as It,r as Pt}from"./chunk-APT5JAT6.mjs";import"./chunk-BCKEUEDZ.mjs";import{a as Nt,b as bt,c as St,e as Mt,h as Et,i as Dt}from"./chunk-ORGMSSGI.mjs";import{Aa as pt,Ca as dt,Da as ft,Ea as st,Fa as ut,M as K,X as Q,ba as X,da as Y,ea as Z,ga as tt,ia as u,ka as et,la as it,pa as nt,qa as ot,sa as at,va as rt,xa as mt,ya as lt,za as ct}from"./chunk-5MMNTMZA.mjs";import{$ as q,Cc as L,Fc as G,Gc as j,Ib as I,Jb as o,Jc as z,Kb as s,Kc as W,Lb as N,Ma as r,Rb as H,Rc as J,Tb as b,Ub as U,Vb as D,W as V,Wb as A,aa as S,bb as l,da as B,gb as c,jb as $,la as x,ma as h,ob as i,pb as n,qb as _,rb as d,sb as f,ub as M,xb as C,zb as E}from"./chunk-Y2VJ442J.mjs";import{a as R}from"./chunk-5XUXGTUW.mjs";var y=class t{constructor(e){this.http=e}apiUrl=`${ut.apiUrl}/notifications`;getNotifications(){return this.http.get(this.apiUrl)}getNotificationById(e){return this.http.get(`${this.apiUrl}/${e}`)}getNotificationsByLoginId(e){return this.http.get(`${this.apiUrl}/user/${e}`)}createNotification(e){return this.http.post(this.apiUrl,e)}updateNotification(e,a){return this.http.put(`${this.apiUrl}/${e}`,a)}deleteNotification(e){return this.http.delete(`${this.apiUrl}/${e}`)}static \u0275fac=function(a){return new(a||t)(q(J))};static \u0275prov=V({token:t,factory:t.\u0275fac,providedIn:"root"})};function Qt(t,e){t&1&&(i(0,"mat-error"),o(1," Login ID is required "),n())}function Xt(t,e){t&1&&(i(0,"mat-error"),o(1," Login ID must be greater than 0 "),n())}function Yt(t,e){t&1&&(i(0,"mat-error"),o(1," Notification type is required "),n())}function Zt(t,e){t&1&&(i(0,"mat-error"),o(1," Title is required "),n())}function te(t,e){t&1&&(i(0,"mat-error"),o(1," Message is required "),n())}function ee(t,e){t&1&&(i(0,"mat-error"),o(1," Start date is required "),n())}function ie(t,e){if(t&1){let a=M();i(0,"button",39),C("click",function(){x(a);let p=E();return h(p.cancelEdit())}),o(1," Cancel "),n()}}function ne(t,e){t&1&&(i(0,"th",40),o(1,"ID"),n())}function oe(t,e){if(t&1&&(i(0,"td",41),o(1),n()),t&2){let a=e.$implicit;r(),s(a.notificationId)}}function ae(t,e){t&1&&(i(0,"th",40),o(1,"Login ID"),n())}function re(t,e){if(t&1&&(i(0,"td",41),o(1),n()),t&2){let a=e.$implicit;r(),s(a.loginId)}}function me(t,e){t&1&&(i(0,"th",40),o(1,"Type"),n())}function le(t,e){if(t&1&&(i(0,"td",41)(1,"span",42)(2,"mat-icon"),o(3),n(),o(4),b(5,"titlecase"),n()()),t&2){let a=e.$implicit;r(),$("type-"+a.notificationType),r(2),s(a.notificationType==="push"?"notifications":"email"),r(),N(" ",U(5,4,a.notificationType)," ")}}function ce(t,e){t&1&&(i(0,"th",40),o(1,"Title"),n())}function pe(t,e){if(t&1&&(i(0,"td",41),o(1),n()),t&2){let a=e.$implicit;r(),s(a.title)}}function de(t,e){t&1&&(i(0,"th",40),o(1,"Message"),n())}function fe(t,e){if(t&1&&(i(0,"td",41),o(1),b(2,"slice"),n()),t&2){let a=e.$implicit;r(),N(" ",a.message.length>50?A(2,1,a.message,0,50)+"...":a.message," ")}}function se(t,e){t&1&&(i(0,"th",40),o(1,"Start Date"),n())}function ue(t,e){if(t&1&&(i(0,"td",41),o(1),b(2,"date"),n()),t&2){let a=e.$implicit;r(),s(D(2,1,a.startDate,"short"))}}function ge(t,e){t&1&&(i(0,"th",40),o(1,"Expiry Date"),n())}function _e(t,e){if(t&1&&(i(0,"td",41),o(1),b(2,"date"),n()),t&2){let a=e.$implicit;r(),s(a.expiryDate?D(2,1,a.expiryDate,"short"):"No expiry")}}function xe(t,e){t&1&&(i(0,"th",40),o(1,"Status"),n())}function he(t,e){if(t&1&&(i(0,"td",41)(1,"mat-icon",43),o(2),n(),o(3),n()),t&2){let a=e.$implicit;r(),c("color",a.isRead?"primary":"warn"),r(),N(" ",a.isRead?"mark_email_read":"mark_email_unread"," "),r(),N(" ",a.isRead?"Read":"Unread"," ")}}function Ce(t,e){t&1&&(i(0,"th",40),o(1,"Created"),n())}function Ne(t,e){if(t&1&&(i(0,"td",41),o(1),b(2,"date"),n()),t&2){let a=e.$implicit;r(),s(D(2,1,a.createdAt,"short"))}}function be(t,e){t&1&&(i(0,"th",40),o(1,"Actions"),n())}function Se(t,e){if(t&1){let a=M();i(0,"td",41)(1,"button",44),C("click",function(){let p=x(a).$implicit,g=E();return h(g.editNotification(p))}),i(2,"mat-icon"),o(3,"edit"),n()(),i(4,"button",45),C("click",function(){let p=x(a).$implicit,g=E();return h(g.deleteNotification(p))}),i(5,"mat-icon"),o(6,"delete"),n()()()}}function Me(t,e){t&1&&_(0,"tr",46)}function Ee(t,e){t&1&&_(0,"tr",47)}function De(t,e){t&1&&(i(0,"div",48)(1,"mat-icon"),o(2,"notifications_off"),n(),i(3,"p"),o(4,"No notifications found."),n()())}var v=class t{notifications=[];displayedColumns=["notificationId","loginId","notificationType","title","message","startDate","expiryDate","isRead","createdAt","actions"];notificationForm;editMode=!1;editingId=null;notificationService=S(y);fb=S(pt);snackBar=S(It);constructor(){this.notificationForm=this.fb.group({loginId:["",[u.required,u.min(1)]],title:["",[u.required,u.maxLength(100)]],message:["",[u.required,u.maxLength(500)]],notificationType:["push",u.required],startDate:[new Date,u.required],expiryDate:[""]})}ngOnInit(){this.loadNotifications()}loadNotifications(){this.notificationService.getNotifications().subscribe(e=>this.notifications=e)}onSubmit(){if(this.notificationForm.invalid)return;let e=R({},this.notificationForm.value);e.startDate instanceof Date&&(e.startDate=e.startDate.toISOString()),e.expiryDate instanceof Date&&(e.expiryDate=e.expiryDate.toISOString());let a=e;this.editMode&&this.editingId?this.notificationService.updateNotification(this.editingId,a).subscribe({next:()=>{this.snackBar.open("Notification updated successfully","Close",{duration:3e3}),this.loadNotifications(),this.cancelEdit()},error:m=>{console.error("Error updating notification:",m);let p=m.error?.message||"Error updating notification";this.snackBar.open(p,"Close",{duration:5e3})}}):this.notificationService.createNotification(a).subscribe({next:()=>{this.snackBar.open("Notification created successfully","Close",{duration:3e3}),this.loadNotifications(),this.notificationForm.reset({notificationType:"push",startDate:new Date})},error:m=>{console.error("Error creating notification:",m);let p=m.error?.message||"Error creating notification";this.snackBar.open(p,"Close",{duration:5e3})}})}editNotification(e){this.editMode=!0,this.editingId=e.notificationId,this.notificationForm.patchValue({loginId:e.loginId,title:e.title,message:e.message,notificationType:e.notificationType,startDate:e.startDate?new Date(e.startDate):new Date,expiryDate:e.expiryDate?new Date(e.expiryDate):null})}cancelEdit(){this.editMode=!1,this.editingId=null,this.notificationForm.reset({notificationType:"push",startDate:new Date})}deleteNotification(e){confirm(`Delete notification titled "${e.title}"?`)&&this.notificationService.deleteNotification(e.notificationId).subscribe({next:()=>{this.snackBar.open("Notification deleted","Close",{duration:2e3}),this.loadNotifications()},error:()=>this.snackBar.open("Error deleting notification","Close",{duration:3e3})})}static \u0275fac=function(a){return new(a||t)};static \u0275cmp=B({type:t,selectors:[["app-notifications-page"]],standalone:!0,features:[H],decls:120,vars:20,consts:[["startPicker",""],["expiryPicker",""],[1,"container"],[1,"form-card"],[1,"notification-form",3,"ngSubmit","formGroup"],[1,"form-section"],[1,"form-row"],["appearance","outline",1,"full-width"],["matInput","","formControlName","loginId","required","","type","number","min","1"],[4,"ngIf"],["formControlName","notificationType","required",""],["value","push"],["value","email"],["matInput","","formControlName","title","required","","maxlength","100"],["matInput","","formControlName","message","required","","rows","4","maxlength","500"],["matInput","","formControlName","startDate","required","",3,"matDatepicker"],["matSuffix","",3,"for"],["matInput","","formControlName","expiryDate",3,"matDatepicker"],[1,"form-actions"],["mat-button","","type","button",3,"click",4,"ngIf"],["mat-icon-button","","type","button","matTooltip","Refresh notifications",3,"click"],["mat-raised-button","","color","primary","type","submit",3,"disabled"],[1,"table-card"],["mat-table","",1,"full-width",3,"dataSource"],["matColumnDef","notificationId"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","loginId"],["matColumnDef","notificationType"],["matColumnDef","title"],["matColumnDef","message"],["matColumnDef","startDate"],["matColumnDef","expiryDate"],["matColumnDef","isRead"],["matColumnDef","createdAt"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["class","no-data",4,"ngIf"],["mat-button","","type","button",3,"click"],["mat-header-cell",""],["mat-cell",""],[1,"notification-type-badge"],[3,"color"],["mat-icon-button","","color","primary","matTooltip","Edit notification",3,"click"],["mat-icon-button","","color","warn","matTooltip","Delete notification",3,"click"],["mat-header-row",""],["mat-row",""],[1,"no-data"]],template:function(a,m){if(a&1){let p=M();i(0,"div",2)(1,"h2"),o(2,"Manage Notifications"),n(),i(3,"mat-card",3)(4,"mat-card-header")(5,"mat-card-title"),o(6),n()(),i(7,"mat-card-content")(8,"form",4),C("ngSubmit",function(){return x(p),h(m.onSubmit())}),i(9,"div",5)(10,"h3"),o(11,"Basic Information"),n(),i(12,"div",6)(13,"mat-form-field",7)(14,"mat-label"),o(15,"Login ID"),n(),_(16,"input",8),l(17,Qt,2,0,"mat-error",9)(18,Xt,2,0,"mat-error",9),n(),i(19,"mat-form-field",7)(20,"mat-label"),o(21,"Notification Type"),n(),i(22,"mat-select",10)(23,"mat-option",11),o(24,"Push Notification"),n(),i(25,"mat-option",12),o(26,"Email"),n()(),l(27,Yt,2,0,"mat-error",9),i(28,"mat-hint"),o(29,"Choose how to deliver this notification"),n()()()(),i(30,"div",5)(31,"h3"),o(32,"Content"),n(),i(33,"div",6)(34,"mat-form-field",7)(35,"mat-label"),o(36,"Title"),n(),_(37,"input",13),l(38,Zt,2,0,"mat-error",9),i(39,"mat-hint"),o(40,"Maximum 100 characters"),n()()(),i(41,"div",6)(42,"mat-form-field",7)(43,"mat-label"),o(44,"Message"),n(),_(45,"textarea",14),l(46,te,2,0,"mat-error",9),i(47,"mat-hint"),o(48,"Maximum 500 characters"),n()()()(),i(49,"div",5)(50,"h3"),o(51,"Schedule"),n(),i(52,"div",6)(53,"mat-form-field",7)(54,"mat-label"),o(55,"Start Date"),n(),_(56,"input",15)(57,"mat-datepicker-toggle",16)(58,"mat-datepicker",null,0),l(60,ee,2,0,"mat-error",9),i(61,"mat-hint"),o(62,"When the notification becomes active"),n()(),i(63,"mat-form-field",7)(64,"mat-label"),o(65,"Expiry Date"),n(),_(66,"input",17)(67,"mat-datepicker-toggle",16)(68,"mat-datepicker",null,1),i(70,"mat-hint"),o(71,"Optional: When the notification expires"),n()()()(),i(72,"div",18),l(73,ie,2,0,"button",19),i(74,"button",20),C("click",function(){return x(p),h(m.loadNotifications())}),i(75,"mat-icon"),o(76,"refresh"),n()(),i(77,"button",21)(78,"mat-icon"),o(79),n(),o(80),n()()()()(),i(81,"mat-card",22)(82,"mat-card-header")(83,"mat-card-title"),o(84,"Notifications List"),n()(),i(85,"mat-card-content")(86,"table",23),d(87,24),l(88,ne,2,0,"th",25)(89,oe,2,1,"td",26),f(),d(90,27),l(91,ae,2,0,"th",25)(92,re,2,1,"td",26),f(),d(93,28),l(94,me,2,0,"th",25)(95,le,6,6,"td",26),f(),d(96,29),l(97,ce,2,0,"th",25)(98,pe,2,1,"td",26),f(),d(99,30),l(100,de,2,0,"th",25)(101,fe,3,5,"td",26),f(),d(102,31),l(103,se,2,0,"th",25)(104,ue,3,4,"td",26),f(),d(105,32),l(106,ge,2,0,"th",25)(107,_e,3,4,"td",26),f(),d(108,33),l(109,xe,2,0,"th",25)(110,he,4,3,"td",26),f(),d(111,34),l(112,Ce,2,0,"th",25)(113,Ne,3,4,"td",26),f(),d(114,35),l(115,be,2,0,"th",25)(116,Se,7,0,"td",26),f(),l(117,Me,1,0,"tr",36)(118,Ee,1,0,"tr",37),n(),l(119,De,5,0,"div",38),n()()()}if(a&2){let p,g,P,T,w,O,k=I(59),F=I(69);r(6),s(m.editMode?"Edit Notification":"Add New Notification"),r(2),c("formGroup",m.notificationForm),r(9),c("ngIf",(p=m.notificationForm.get("loginId"))==null?null:p.hasError("required")),r(),c("ngIf",(g=m.notificationForm.get("loginId"))==null?null:g.hasError("min")),r(9),c("ngIf",(P=m.notificationForm.get("notificationType"))==null?null:P.hasError("required")),r(11),c("ngIf",(T=m.notificationForm.get("title"))==null?null:T.hasError("required")),r(8),c("ngIf",(w=m.notificationForm.get("message"))==null?null:w.hasError("required")),r(10),c("matDatepicker",k),r(),c("for",k),r(3),c("ngIf",(O=m.notificationForm.get("startDate"))==null?null:O.hasError("required")),r(6),c("matDatepicker",F),r(),c("for",F),r(6),c("ngIf",m.editMode),r(4),c("disabled",m.notificationForm.invalid),r(2),s(m.editMode?"update":"add"),r(),N(" ",m.editMode?"Update":"Add"," Notification "),r(6),c("dataSource",m.notifications),r(31),c("matHeaderRowDef",m.displayedColumns),r(),c("matRowDefColumns",m.displayedColumns),r(),c("ngIf",m.notifications.length===0)}},dependencies:[W,L,z,G,j,dt,nt,tt,ot,et,it,lt,ct,mt,at,rt,zt,Vt,Bt,At,$t,qt,Lt,Ht,Ut,Gt,jt,Dt,Et,Nt,St,bt,Mt,vt,yt,Z,X,Y,st,ft,Rt,Ft,Q,kt,Tt,wt,Ot,K,Ct,gt,xt,ht,_t,Jt,Wt,Pt],styles:[".container[_ngcontent-%COMP%]{max-width:1200px;margin:0 auto;padding:24px}.form-card[_ngcontent-%COMP%], .table-card[_ngcontent-%COMP%]{margin-bottom:24px;box-shadow:0 2px 4px #0000001a}.notification-form[_ngcontent-%COMP%]{padding:20px 0}.form-section[_ngcontent-%COMP%]{margin-bottom:24px}.form-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin-bottom:16px;color:#333;font-size:1.1rem;font-weight:500;border-bottom:2px solid #e0e0e0;padding-bottom:8px}.form-row[_ngcontent-%COMP%]{display:flex;gap:16px;margin-bottom:16px}.form-row[_ngcontent-%COMP%]   .full-width[_ngcontent-%COMP%]{flex:1}.full-width[_ngcontent-%COMP%]{width:100%}.form-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:12px;margin-top:24px;padding-top:16px;border-top:1px solid #e0e0e0}.notification-type-badge[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:4px;padding:4px 8px;border-radius:12px;font-size:12px;font-weight:500}.type-push[_ngcontent-%COMP%]{background-color:#e3f2fd;color:#1976d2}.type-email[_ngcontent-%COMP%]{background-color:#f3e5f5;color:#7b1fa2}.no-data[_ngcontent-%COMP%]{text-align:center;padding:40px;color:#666}.no-data[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:48px;height:48px;width:48px;margin-bottom:16px}table[_ngcontent-%COMP%]{width:100%;margin-top:16px}th.mat-header-cell[_ngcontent-%COMP%], td.mat-cell[_ngcontent-%COMP%]{text-align:left}button[mat-icon-button][_ngcontent-%COMP%]{margin-right:8px}@media (max-width: 768px){.container[_ngcontent-%COMP%]{padding:16px}.form-row[_ngcontent-%COMP%]{flex-direction:column;gap:0}.form-actions[_ngcontent-%COMP%]{flex-direction:column}.form-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%}}"]})};var pi=[{path:"",component:v,title:"Notifications"}];export{pi as NOTIFICATIONS_ROUTES};
