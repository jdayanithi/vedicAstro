import './polyfills.server.mjs';
import{a as G}from"./chunk-53ZRGH3M.mjs";import{a as Z,b as ee}from"./chunk-NXD5BTRF.mjs";import{a as Ce,b as be,c as xe,d as ye}from"./chunk-AYVQKEXB.mjs";import{a as V,b as j,c as U,e as H,g as z}from"./chunk-QQHXRZGA.mjs";import{d as y,e as E}from"./chunk-23SLAFQR.mjs";import{a as Ee,b as Ie}from"./chunk-QJLSOKHB.mjs";import{b as X,c as Y,q as te,r as re}from"./chunk-TRHFPAUI.mjs";import"./chunk-Y3IL6YFO.mjs";import{a as $,b as J,e as K,h as Q,i as W}from"./chunk-WPGK3LCN.mjs";import{Ba as D,Ca as A,Da as O,M as Me,X as Se,ba as I,ca as F,da as P,ea as w,ga as k,ia as d,ka as L,la as N,pa as T,sa as R,va as q,za as B}from"./chunk-YEGN3WNK.mjs";import{Cc as b,Ib as ve,Jb as a,Kb as _,Kc as x,Lb as S,Ma as n,Na as c,Rb as C,bb as p,da as v,gb as l,la as ne,ma as oe,ob as r,pb as t,qb as u,ub as he,xb as g,zb as M}from"./chunk-Y2VJ442J.mjs";import"./chunk-5XUXGTUW.mjs";function Ge(i,m){if(i&1&&(r(0,"div",12)(1,"mat-icon",13),a(2,"error"),t(),r(3,"span",14),a(4),t()()),i&2){let o=M();n(4),_(o.errorMessage)}}function Ve(i,m){i&1&&(r(0,"mat-error"),a(1,"Email is required"),t())}function je(i,m){i&1&&(r(0,"mat-error"),a(1,"Please enter a valid email"),t())}function Ue(i,m){i&1&&(r(0,"mat-error"),a(1,"Password is required"),t())}function He(i,m){i&1&&u(0,"mat-spinner",15)}var ie=class i{constructor(m,o,e,s){this.fb=m;this.router=o;this.authService=e;this.snackBar=s;this.loginForm=this.fb.group({email:["",[d.required,d.email]],password:["",[d.required]]})}loginForm;hidePassword=!0;isLoading=!1;errorMessage="";onSubmit(){if(this.loginForm.valid){this.isLoading=!0,this.errorMessage="";let{email:m,password:o}=this.loginForm.value;this.authService.login(m,o).subscribe({next:()=>{this.isLoading=!1,this.snackBar.open("Login successful!","Close",{duration:3e3,panelClass:["success-snackbar"]}),this.router.navigate(["/dashboard"])},error:e=>{this.isLoading=!1,console.error("Login failed:",e);let s="Login failed. Please try again.";e.error?typeof e.error=="string"?s=e.error:e.error.message?s=e.error.message:e.error.error&&(s=e.error.error):e.message&&(s=e.message),s.toLowerCase().includes("invalid username or password")||s.toLowerCase().includes("authentication failed")||e.status===401?s="Invalid email or password. Please check your credentials and try again.":e.status===0?s="Unable to connect to the server. Please check your internet connection.":e.status>=500&&(s="Server error. Please try again later."),this.errorMessage=s,this.snackBar.open(s,"Close",{duration:5e3,panelClass:["error-snackbar"]})}})}}static \u0275fac=function(o){return new(o||i)(c(B),c(y),c(G),c(te))};static \u0275cmp=v({type:i,selectors:[["app-login"]],standalone:!0,features:[C],decls:28,vars:10,consts:[[1,"container","flex","justify-center","align-center",2,"min-height","100vh"],[1,"p-20",2,"max-width","400px","width","100%"],["class","error-container",4,"ngIf"],[1,"flex","flex-column","gap-20",3,"ngSubmit","formGroup"],["matInput","","type","email","formControlName","email","placeholder","Enter your email"],[4,"ngIf"],["matInput","","formControlName","password",3,"type"],["mat-icon-button","","matSuffix","","type","button",3,"click"],["mat-raised-button","","color","primary","type","submit",3,"disabled"],["diameter","20",4,"ngIf"],[1,"text-center"],["mat-button","","routerLink","/register"],[1,"error-container"],["color","warn"],[1,"error-text"],["diameter","20"]],template:function(o,e){if(o&1&&(r(0,"div",0)(1,"mat-card",1)(2,"mat-card-header")(3,"mat-card-title"),a(4,"Login"),t()(),r(5,"mat-card-content"),p(6,Ge,5,1,"div",2),r(7,"form",3),g("ngSubmit",function(){return e.onSubmit()}),r(8,"mat-form-field")(9,"mat-label"),a(10,"Email"),t(),u(11,"input",4),p(12,Ve,2,0,"mat-error",5)(13,je,2,0,"mat-error",5),t(),r(14,"mat-form-field")(15,"mat-label"),a(16,"Password"),t(),u(17,"input",6),r(18,"button",7),g("click",function(){return e.hidePassword=!e.hidePassword}),r(19,"mat-icon"),a(20),t()(),p(21,Ue,2,0,"mat-error",5),t(),r(22,"button",8),p(23,He,1,0,"mat-spinner",9),a(24),t(),r(25,"div",10)(26,"a",11),a(27,"Need to register?"),t()()()()()()),o&2){let s,f,h;n(6),l("ngIf",e.errorMessage),n(),l("formGroup",e.loginForm),n(5),l("ngIf",(s=e.loginForm.get("email"))==null?null:s.hasError("required")),n(),l("ngIf",(f=e.loginForm.get("email"))==null?null:f.hasError("email")),n(4),l("type",e.hidePassword?"password":"text"),n(3),_(e.hidePassword?"visibility_off":"visibility"),n(),l("ngIf",(h=e.loginForm.get("password"))==null?null:h.hasError("required")),n(),l("disabled",e.loginForm.invalid||e.isLoading),n(),l("ngIf",e.isLoading),n(),S(" ",e.isLoading?"Signing in...":"Login"," ")}},dependencies:[x,b,D,T,k,L,N,R,q,E,z,V,U,H,j,W,Q,$,J,K,Y,X,w,F,I,P,O,A,ee,Z,re],styles:["[_nghost-%COMP%]{display:block;height:100%}.error-container[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;background-color:#ffebee;border:1px solid #f44336;border-radius:4px;padding:12px;margin-bottom:20px}.error-text[_ngcontent-%COMP%]{color:#d32f2f;font-size:14px}.flex[_ngcontent-%COMP%]{display:flex}.flex-column[_ngcontent-%COMP%]{flex-direction:column}.gap-20[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] + *[_ngcontent-%COMP%]{margin-top:20px}.text-center[_ngcontent-%COMP%]{text-align:center}"]})};function ze(i,m){if(i&1&&(r(0,"div",27)(1,"mat-icon",28),a(2,"error"),t(),r(3,"span",29),a(4),t()()),i&2){let o=M();n(4),_(o.errorMessage)}}function $e(i,m){i&1&&(r(0,"mat-error"),a(1,"First name is required"),t())}function Je(i,m){i&1&&(r(0,"mat-error"),a(1,"Last name is required"),t())}function Ke(i,m){i&1&&(r(0,"mat-error"),a(1,"Email is required"),t())}function Qe(i,m){i&1&&(r(0,"mat-error"),a(1,"Please enter a valid email"),t())}function We(i,m){i&1&&(r(0,"mat-error"),a(1,"Password is required"),t())}function Xe(i,m){i&1&&(r(0,"mat-error"),a(1,"Password must be at least 6 characters"),t())}function Ye(i,m){i&1&&(r(0,"mat-error"),a(1,"Phone number is required"),t())}function Ze(i,m){i&1&&(r(0,"mat-error"),a(1,"Please enter a valid phone number"),t())}function et(i,m){i&1&&(r(0,"mat-error"),a(1,"Birth date is required"),t())}function tt(i,m){i&1&&(r(0,"mat-error"),a(1,"Birth time is required"),t())}function rt(i,m){i&1&&(r(0,"mat-error"),a(1,"Birth place is required"),t())}function it(i,m){i&1&&(r(0,"mat-error"),a(1,"User type is required"),t())}function at(i,m){i&1&&u(0,"mat-spinner",30)}var ae=class i{constructor(m,o,e,s){this.fb=m;this.router=o;this.authService=e;this.snackBar=s;this.registerForm=this.fb.group({firstName:["",d.required],lastName:["",d.required],email:["",[d.required,d.email]],password:["",[d.required,d.minLength(6)]],phoneNumber:["",[d.required,d.pattern("^[0-9]{10}$")]],birthDate:["",d.required],birthTime:["",d.required],birthPlace:["",d.required],bio:[""],userType:["student",d.required]})}registerForm;hidePassword=!0;isLoading=!1;errorMessage="";onSubmit(){if(this.registerForm.valid){this.isLoading=!0,this.errorMessage="";let m=this.registerForm.value;m.birthDate=m.birthDate.toISOString().split("T")[0],this.authService.register(m).subscribe({next:()=>{this.isLoading=!1,this.snackBar.open("Registration successful! Please login.","Close",{duration:5e3,panelClass:["success-snackbar"]}),this.router.navigate(["/login"])},error:o=>{this.isLoading=!1,console.error("Registration failed:",o);let e="Registration failed. Please try again.";o.error?typeof o.error=="string"?e=o.error:o.error.message?e=o.error.message:o.error.error&&(e=o.error.error):o.message&&(e=o.message),e.toLowerCase().includes("username already exists")||e.toLowerCase().includes("user already exists")?e="An account with this email already exists. Please use a different email or try logging in.":e.toLowerCase().includes("email")?e="Please provide a valid email address.":o.status===400?e="Invalid registration data. Please check all fields and try again.":o.status===0?e="Unable to connect to the server. Please check your internet connection.":o.status>=500&&(e="Server error. Please try again later."),this.errorMessage=e,this.snackBar.open(e,"Close",{duration:5e3,panelClass:["error-snackbar"]})}})}}static \u0275fac=function(o){return new(o||i)(c(B),c(y),c(G),c(te))};static \u0275cmp=v({type:i,selectors:[["app-register"]],standalone:!0,features:[C],decls:79,vars:21,consts:[["picker",""],[1,"container","flex","justify-center","align-center",2,"min-height","100vh"],[1,"p-20",2,"max-width","600px","width","100%"],["class","error-container",4,"ngIf"],[1,"flex","flex-column","gap-20",3,"ngSubmit","formGroup"],[1,"flex","gap-20"],[1,"flex-1"],["matInput","","formControlName","firstName"],[4,"ngIf"],["matInput","","formControlName","lastName"],["matInput","","type","email","formControlName","email"],["matInput","","formControlName","password",3,"type"],["mat-icon-button","","matSuffix","","type","button",3,"click"],["matInput","","type","tel","formControlName","phoneNumber"],["matInput","","formControlName","birthDate",3,"matDatepicker"],["matIconSuffix","",3,"for"],["matInput","","type","time","formControlName","birthTime"],["matInput","","formControlName","birthPlace"],["matInput","","rows","3","formControlName","bio"],["formControlName","userType"],["value","student"],["value","instructor"],["value","admin"],["mat-raised-button","","color","primary","type","submit",3,"disabled"],["diameter","20",4,"ngIf"],[1,"text-center"],["mat-button","","routerLink","/login"],[1,"error-container"],["color","warn"],[1,"error-text"],["diameter","20"]],template:function(o,e){if(o&1){let s=he();r(0,"div",1)(1,"mat-card",2)(2,"mat-card-header")(3,"mat-card-title"),a(4,"Register"),t()(),r(5,"mat-card-content"),p(6,ze,5,1,"div",3),r(7,"form",4),g("ngSubmit",function(){return ne(s),oe(e.onSubmit())}),r(8,"div",5)(9,"mat-form-field",6)(10,"mat-label"),a(11,"First Name"),t(),u(12,"input",7),p(13,$e,2,0,"mat-error",8),t(),r(14,"mat-form-field",6)(15,"mat-label"),a(16,"Last Name"),t(),u(17,"input",9),p(18,Je,2,0,"mat-error",8),t()(),r(19,"mat-form-field")(20,"mat-label"),a(21,"Email"),t(),u(22,"input",10),p(23,Ke,2,0,"mat-error",8)(24,Qe,2,0,"mat-error",8),t(),r(25,"mat-form-field")(26,"mat-label"),a(27,"Password"),t(),u(28,"input",11),r(29,"button",12),g("click",function(){return ne(s),oe(e.hidePassword=!e.hidePassword)}),r(30,"mat-icon"),a(31),t()(),p(32,We,2,0,"mat-error",8)(33,Xe,2,0,"mat-error",8),t(),r(34,"mat-form-field")(35,"mat-label"),a(36,"Phone Number"),t(),u(37,"input",13),p(38,Ye,2,0,"mat-error",8)(39,Ze,2,0,"mat-error",8),t(),r(40,"mat-form-field")(41,"mat-label"),a(42,"Birth Date"),t(),u(43,"input",14)(44,"mat-datepicker-toggle",15)(45,"mat-datepicker",null,0),p(47,et,2,0,"mat-error",8),t(),r(48,"mat-form-field")(49,"mat-label"),a(50,"Birth Time"),t(),u(51,"input",16),p(52,tt,2,0,"mat-error",8),t(),r(53,"mat-form-field")(54,"mat-label"),a(55,"Birth Place"),t(),u(56,"input",17),p(57,rt,2,0,"mat-error",8),t(),r(58,"mat-form-field")(59,"mat-label"),a(60,"Bio"),t(),u(61,"textarea",18),t(),r(62,"mat-form-field")(63,"mat-label"),a(64,"User Type"),t(),r(65,"mat-select",19)(66,"mat-option",20),a(67,"Student"),t(),r(68,"mat-option",21),a(69,"Instructor"),t(),r(70,"mat-option",22),a(71,"Admin"),t()(),p(72,it,2,0,"mat-error",8),t(),r(73,"button",23),p(74,at,1,0,"mat-spinner",24),a(75),t(),r(76,"div",25)(77,"a",26),a(78,"Already have an account?"),t()()()()()()}if(o&2){let s,f,h,me,le,se,pe,de,ue,ce,fe,ge,_e=ve(46);n(6),l("ngIf",e.errorMessage),n(),l("formGroup",e.registerForm),n(6),l("ngIf",(s=e.registerForm.get("firstName"))==null?null:s.hasError("required")),n(5),l("ngIf",(f=e.registerForm.get("lastName"))==null?null:f.hasError("required")),n(5),l("ngIf",(h=e.registerForm.get("email"))==null?null:h.hasError("required")),n(),l("ngIf",(me=e.registerForm.get("email"))==null?null:me.hasError("email")),n(4),l("type",e.hidePassword?"password":"text"),n(3),_(e.hidePassword?"visibility_off":"visibility"),n(),l("ngIf",(le=e.registerForm.get("password"))==null?null:le.hasError("required")),n(),l("ngIf",(se=e.registerForm.get("password"))==null?null:se.hasError("minlength")),n(5),l("ngIf",(pe=e.registerForm.get("phoneNumber"))==null?null:pe.hasError("required")),n(),l("ngIf",(de=e.registerForm.get("phoneNumber"))==null?null:de.hasError("pattern")),n(4),l("matDatepicker",_e),n(),l("for",_e),n(3),l("ngIf",(ue=e.registerForm.get("birthDate"))==null?null:ue.hasError("required")),n(5),l("ngIf",(ce=e.registerForm.get("birthTime"))==null?null:ce.hasError("required")),n(5),l("ngIf",(fe=e.registerForm.get("birthPlace"))==null?null:fe.hasError("required")),n(15),l("ngIf",(ge=e.registerForm.get("userType"))==null?null:ge.hasError("required")),n(),l("disabled",e.registerForm.invalid||e.isLoading),n(),l("ngIf",e.isLoading),n(),S(" ",e.isLoading?"Creating account...":"Register"," ")}},dependencies:[x,b,D,T,k,L,N,R,q,E,z,V,U,H,j,W,Q,$,J,K,Y,X,w,F,I,P,O,A,ye,Ce,be,xe,Me,Ie,Ee,Se,ee,Z,re],styles:["[_nghost-%COMP%]{display:block;height:100%}.flex-1[_ngcontent-%COMP%]{flex:1}"]})};var Vt=[{path:"",redirectTo:"login",pathMatch:"full"},{path:"login",component:ie},{path:"register",component:ae}];export{Vt as AUTH_ROUTES};
