import './polyfills.server.mjs';
import{a as st}from"./chunk-H3GLWUZ5.mjs";import{a as rt,b as nt,c as at}from"./chunk-RLI34NWK.mjs";import{a as ct}from"./chunk-KVNV5NHR.mjs";import{a as U,b as z,c as J,e as K,g as Q}from"./chunk-AF37YSCE.mjs";import{a as Ct,d as P}from"./chunk-23SLAFQR.mjs";import{a as Dt,b as Nt,c as Ot,d as kt,e as Bt,f as Vt,g as Lt,h as Rt,i as Pt,j as $t,k as Ht}from"./chunk-NOOZMP64.mjs";import{b as At}from"./chunk-MICQ7PJR.mjs";import{b as tt,c as et,q as it,r as ot}from"./chunk-APT5JAT6.mjs";import"./chunk-BCKEUEDZ.mjs";import{a as X,c as Ft,h as Y,i as Z}from"./chunk-ORGMSSGI.mjs";import{Aa as yt,Ca as q,Da as Et,Ea as wt,X as $,ba as H,da as _t,ea as j,ga as G,ia as pt,ka as W,la as ht,na as gt,pa as vt,qa as St,ra as Tt,sa as Mt,va as bt,xa as xt,ya as It}from"./chunk-5MMNTMZA.mjs";import{B as E,Bc as B,Cc as V,Ec as L,G as w,Gc as ft,Ib as N,Jb as n,Kb as S,Kc as R,Lb as T,Ma as c,Na as b,P as F,Q as A,Rb as O,Tb as I,Ub as k,Vb as ut,aa as _,bb as l,da as D,gb as s,j as M,la as d,ma as u,ob as r,pb as o,qb as p,rb as h,sb as g,ub as x,xb as f,zb as v}from"./chunk-Y2VJ442J.mjs";import{a as dt}from"./chunk-5XUXGTUW.mjs";function Yt(i,t){if(i&1&&(r(0,"mat-option",11),n(1),o()),i&2){let e=t.$implicit,a=v();s("value",e),c(),T(" ",a.displayCourseFn(e)," ")}}function Zt(i,t){i&1&&(r(0,"th",24),n(1,"ID"),o())}function te(i,t){if(i&1&&(r(0,"td",25),n(1),o()),i&2){let e=t.$implicit;c(),S(e.topicId)}}function ee(i,t){i&1&&(r(0,"th",24),n(1,"Order"),o())}function ie(i,t){if(i&1&&(r(0,"td",25),n(1),o()),i&2){let e=t.$implicit;c(),S(e.orderNumber)}}function oe(i,t){i&1&&(r(0,"th",24),n(1,"Title"),o())}function re(i,t){if(i&1&&(r(0,"td",25),n(1),o()),i&2){let e=t.$implicit;c(),S(e.title)}}function ne(i,t){i&1&&(r(0,"th",24),n(1,"Description"),o())}function ae(i,t){if(i&1&&(r(0,"td",25),n(1),o()),i&2){let e=t.$implicit;c(),T(" ",e.description?e.description.length>100?e.description.substring(0,100)+"...":e.description:"-"," ")}}function ce(i,t){i&1&&(r(0,"th",24),n(1,"Created"),o())}function se(i,t){if(i&1&&(r(0,"td",25),n(1),I(2,"date"),o()),i&2){let e=t.$implicit;c(),S(ut(2,1,e.createdAt,"short"))}}function me(i,t){i&1&&(r(0,"th",24),n(1,"Actions"),o())}function le(i,t){if(i&1){let e=x();r(0,"td",25)(1,"button",26),f("click",function(){let m=d(e).$implicit,C=v(2);return u(C.navigateToEditTopic(m.topicId))}),r(2,"mat-icon"),n(3,"edit"),o()(),r(4,"button",27),f("click",function(){let m=d(e).$implicit,C=v(2);return u(C.deleteTopic(m.topicId))}),r(5,"mat-icon"),n(6,"delete"),o()()()}}function pe(i,t){i&1&&p(0,"tr",28)}function de(i,t){i&1&&p(0,"tr",29)}function ue(i,t){i&1&&(r(0,"div",30)(1,"p"),n(2,"No topics found for this course."),o()())}function fe(i,t){if(i&1&&(r(0,"mat-card")(1,"mat-card-header")(2,"mat-card-title"),n(3),o()(),r(4,"mat-card-content")(5,"table",12),h(6,13),l(7,Zt,2,0,"th",14)(8,te,2,1,"td",15),g(),h(9,16),l(10,ee,2,0,"th",14)(11,ie,2,1,"td",15),g(),h(12,17),l(13,oe,2,0,"th",14)(14,re,2,1,"td",15),g(),h(15,18),l(16,ne,2,0,"th",14)(17,ae,2,1,"td",15),g(),h(18,19),l(19,ce,2,0,"th",14)(20,se,3,4,"td",15),g(),h(21,20),l(22,me,2,0,"th",14)(23,le,7,0,"td",15),g(),l(24,pe,1,0,"tr",21)(25,de,1,0,"tr",22),o(),l(26,ue,3,0,"div",23),o()()),i&2){let e=v();c(3),T("Topics for: ",e.selectedCourse.title,""),c(2),s("dataSource",e.topics),c(19),s("matHeaderRowDef",e.displayedColumns),c(),s("matRowDefColumns",e.displayedColumns),c(),s("ngIf",e.topics.length===0)}}function Ce(i,t){i&1&&(r(0,"mat-card",31)(1,"mat-card-content")(2,"div",30)(3,"mat-icon"),n(4,"school"),o(),r(5,"p"),n(6,"Please select a course to view its topics."),o()()()())}var mt=class i{constructor(t,e,a,m){this.topicService=t;this.courseService=e;this.snackBar=a;this.router=m}topics=[];selectedCourse=null;courseSearchControl=new gt("");filteredCourses=M([]);displayedColumns=["topicId","orderNumber","title","description","createdAt","actions"];ngOnInit(){this.setupCourseAutocomplete(),this.restoreSelectedCourse()}restoreSelectedCourse(){let t=history.state;if(t&&t.selectedCourse){let e=t.selectedCourse;this.selectedCourse=e,this.courseSearchControl.setValue(e),this.loadTopics()}}setupCourseAutocomplete(){this.filteredCourses=this.courseSearchControl.valueChanges.pipe(F(""),E(300),w(),A(t=>this._filterCourses(t||"")))}_filterCourses(t){let e=typeof t=="string"?t:t?.title||"";return!e||e.trim()===""?this.courseService.getAllCourses():this.courseService.getAllCourses()}displayCourseFn=t=>{if(!t)return"";let e=t.title||"Untitled",a=t.courseId||"N/A";return`${e} (ID: ${a})`};onCourseSelected(t){let e=t.option.value;this.selectedCourse=e,this.loadTopics()}loadTopics(){this.selectedCourse&&this.topicService.getTopicsByCourseId(this.selectedCourse.courseId).subscribe({next:t=>{this.topics=t},error:()=>{this.snackBar.open("Error loading topics","Close",{duration:3e3})}})}deleteTopic(t){confirm("Are you sure you want to delete this topic?")&&this.topicService.deleteTopic(t).subscribe({next:()=>{this.loadTopics(),this.snackBar.open("Topic deleted successfully","Close",{duration:3e3})},error:()=>{this.snackBar.open("Error deleting topic","Close",{duration:3e3})}})}navigateToAddTopic(){this.selectedCourse&&this.router.navigate(["topics/add"],{state:{selectedCourse:this.selectedCourse}})}navigateToEditTopic(t){this.router.navigate(["topics/update",t],{state:{selectedCourse:this.selectedCourse}})}static \u0275fac=function(e){return new(e||i)(b(st),b(ct),b(it),b(P))};static \u0275cmp=D({type:i,selectors:[["app-topic-list"]],standalone:!0,features:[O],decls:20,vars:9,consts:[["auto","matAutocomplete"],[1,"container"],[1,"header"],["mat-raised-button","","color","primary",3,"click","disabled"],[1,"filter-card"],[1,"full-width"],["type","text","matInput","","placeholder","Type to search courses...",3,"formControl","matAutocomplete"],[3,"optionSelected","displayWith"],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],["class","placeholder-card",4,"ngIf"],[3,"value"],["mat-table","",1,"full-width",3,"dataSource"],["matColumnDef","topicId"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","orderNumber"],["matColumnDef","title"],["matColumnDef","description"],["matColumnDef","createdAt"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["class","no-data",4,"ngIf"],["mat-header-cell",""],["mat-cell",""],["mat-icon-button","","color","primary",3,"click"],["mat-icon-button","","color","warn",3,"click"],["mat-header-row",""],["mat-row",""],[1,"no-data"],[1,"placeholder-card"]],template:function(e,a){if(e&1){let m=x();r(0,"div",1)(1,"div",2)(2,"h1"),n(3,"Topics"),o(),r(4,"button",3),f("click",function(){return d(m),u(a.navigateToAddTopic())}),r(5,"mat-icon"),n(6,"add"),o(),n(7," Add Topic "),o()(),r(8,"mat-card",4)(9,"mat-card-content")(10,"mat-form-field",5)(11,"mat-label"),n(12,"Search Course"),o(),p(13,"input",6),r(14,"mat-autocomplete",7,0),f("optionSelected",function(lt){return d(m),u(a.onCourseSelected(lt))}),l(16,Yt,2,2,"mat-option",8),I(17,"async"),o()()()(),l(18,fe,27,5,"mat-card",9)(19,Ce,7,0,"mat-card",10),o()}if(e&2){let m=N(15);c(4),s("disabled",!a.selectedCourse),c(9),s("formControl",a.courseSearchControl)("matAutocomplete",m),c(),s("displayWith",a.displayCourseFn),c(2),s("ngForOf",k(17,7,a.filteredCourses)),c(2),s("ngIf",a.selectedCourse),c(),s("ngIf",!a.selectedCourse)}},dependencies:[R,B,V,L,ft,Ht,Dt,Ot,Lt,kt,Nt,Rt,Bt,Vt,Pt,$t,j,H,_t,wt,Et,Q,U,J,K,z,Z,Y,X,At,$,at,rt,nt,et,tt,ot,q,G,W,Tt],styles:[".container[_ngcontent-%COMP%]{padding:20px}.header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px}.full-width[_ngcontent-%COMP%]{width:100%}.filter-card[_ngcontent-%COMP%]{margin-bottom:20px}.no-data[_ngcontent-%COMP%]{text-align:center;padding:40px;color:#666}.no-data[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:48px;height:48px;width:48px;margin-bottom:16px}.placeholder-card[_ngcontent-%COMP%]{margin-top:20px}"]})};function _e(i,t){if(i&1&&(r(0,"mat-option",14),n(1),o()),i&2){let e=t.$implicit,a=v();s("value",e),c(),T(" ",a.displayCourseFn(e)," ")}}function he(i,t){i&1&&(r(0,"mat-form-field",3)(1,"mat-label"),n(2,"Order Number"),o(),p(3,"input",15),o())}var y=class i{topicForm;filteredCourses=M([]);isEditMode=!1;topicId=null;fb=_(yt);topicService=_(st);courseService=_(ct);router=_(P);route=_(Ct);snackBar=_(it);constructor(){this.topicForm=this.fb.group({title:["",pt.required],description:[""],courseId:["",pt.required],courseSearch:[""],orderNumber:[1]})}ngOnInit(){this.setupCourseAutocomplete(),this.checkEditMode(),this.handleNavigationState()}handleNavigationState(){let e=this.router.getCurrentNavigation()?.extras?.state||window.history.state;if(e&&e.selectedCourse&&!this.isEditMode){let a=e.selectedCourse;this.topicForm.patchValue({courseId:a.courseId,courseSearch:a})}}setupCourseAutocomplete(){this.filteredCourses=this.topicForm.get("courseSearch").valueChanges.pipe(F(""),E(300),w(),A(t=>this._filterCourses(t)))}_filterCourses(t){return typeof t!="string"?M([]):!t||t.trim()===""?this.courseService.getAllCourses():this.courseService.getAllCourses()}displayCourseFn=t=>t?`${t.title} (ID: ${t.courseId})`:"";onCourseSelected(t){let e=t.option.value;this.topicForm.patchValue({courseId:e.courseId})}checkEditMode(){let t=this.route.snapshot.paramMap.get("id");t&&(this.isEditMode=!0,this.topicId=+t,this.loadTopic())}loadTopic(){this.topicId&&this.topicService.getTopicById(this.topicId).subscribe({next:t=>{this.topicForm.patchValue({title:t.title,description:t.description,courseId:t.courseId,orderNumber:t.orderNumber}),this.courseService.getCourseById(t.courseId).subscribe({next:e=>{this.topicForm.patchValue({courseSearch:e})}})},error:()=>{this.snackBar.open("Error loading topic","Close",{duration:3e3})}})}onSubmit(){if(this.topicForm.valid){let t=this.topicForm.value,e=dt({title:t.title,description:t.description,courseId:t.courseId},this.isEditMode&&{orderNumber:t.orderNumber});this.isEditMode&&this.topicId?this.topicService.updateTopic(this.topicId,e).subscribe({next:()=>{this.snackBar.open("Topic updated successfully","Close",{duration:3e3}),this.goBack()},error:()=>{this.snackBar.open("Error updating topic","Close",{duration:3e3})}}):this.topicService.createTopic(e).subscribe({next:()=>{this.snackBar.open("Topic created successfully","Close",{duration:3e3}),this.goBack()},error:()=>{this.snackBar.open("Error creating topic","Close",{duration:3e3})}})}}goBack(){let t=this.topicForm.get("courseId")?.value,e=this.topicForm.get("courseSearch")?.value;t&&e?this.router.navigate(["/topics"],{state:{selectedCourse:e}}):this.router.navigate(["/topics"])}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=D({type:i,selectors:[["app-add-topic"]],standalone:!0,features:[O],decls:35,vars:10,consts:[["auto","matAutocomplete"],[1,"container"],[3,"ngSubmit","formGroup"],["appearance","fill",1,"full-width"],["type","text","matInput","","formControlName","courseSearch","placeholder","Type to search courses...",3,"matAutocomplete"],[3,"optionSelected","displayWith"],[3,"value",4,"ngFor","ngForOf"],["matInput","","formControlName","courseId","required","","readonly",""],["matInput","","formControlName","title","required",""],["matInput","","formControlName","description","rows","4"],["appearance","fill","class","full-width",4,"ngIf"],[1,"button-container"],["mat-button","","type","button",3,"click"],["mat-raised-button","","color","primary","type","submit",3,"disabled"],[3,"value"],["matInput","","type","number","formControlName","orderNumber","min","1"]],template:function(e,a){if(e&1){let m=x();r(0,"div",1)(1,"mat-card")(2,"mat-card-header")(3,"mat-card-title"),n(4),o()(),r(5,"mat-card-content")(6,"form",2),f("ngSubmit",function(){return d(m),u(a.onSubmit())}),r(7,"mat-form-field",3)(8,"mat-label"),n(9,"Search Course"),o(),p(10,"input",4),r(11,"mat-autocomplete",5,0),f("optionSelected",function(lt){return d(m),u(a.onCourseSelected(lt))}),l(13,_e,2,2,"mat-option",6),I(14,"async"),o()(),r(15,"mat-form-field",3)(16,"mat-label"),n(17,"Course ID"),o(),p(18,"input",7),r(19,"mat-hint"),n(20,"Selected from course search above"),o()(),r(21,"mat-form-field",3)(22,"mat-label"),n(23,"Title"),o(),p(24,"input",8),o(),r(25,"mat-form-field",3)(26,"mat-label"),n(27,"Description"),o(),p(28,"textarea",9),o(),l(29,he,4,0,"mat-form-field",10),r(30,"div",11)(31,"button",12),f("click",function(){return d(m),u(a.goBack())}),n(32,"Cancel"),o(),r(33,"button",13),n(34),o()()()()()()}if(e&2){let m=N(12);c(4),S(a.isEditMode?"Edit Topic"+(a.topicId?" (ID: "+a.topicId+")":""):"Add New Topic"),c(2),s("formGroup",a.topicForm),c(4),s("matAutocomplete",m),c(),s("displayWith",a.displayCourseFn),c(2),s("ngForOf",k(14,8,a.filteredCourses)),c(16),s("ngIf",a.isEditMode),c(4),s("disabled",a.topicForm.invalid),c(),T(" ",a.isEditMode?"Update":"Create"," ")}},dependencies:[R,B,V,L,q,vt,G,St,W,ht,It,xt,Mt,bt,Z,Y,X,Ft,et,tt,j,H,Q,U,J,K,z,at,rt,$,nt,ot],styles:[".container[_ngcontent-%COMP%]{padding:20px;max-width:800px;margin:0 auto}.full-width[_ngcontent-%COMP%]{width:100%;margin-bottom:15px}.button-container[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:8px;margin-top:20px}"]})};var si=[{path:"",component:mt},{path:"add",component:y},{path:"update/:id",component:y}];export{si as TOPICS_ROUTES};
