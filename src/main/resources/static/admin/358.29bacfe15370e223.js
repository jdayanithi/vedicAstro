"use strict";(self.webpackChunkadmin=self.webpackChunkadmin||[]).push([[358],{2358:(E,C,s)=>{s.r(C),s.d(C,{CATEGORY_ROUTES:()=>Z});var f=s(177),m=s(9159),d=s(8834),h=s(9213),g=s(5351),p=s(9417),c=s(2102),u=s(9631),_=s(2798),b=s(5416),F=s(450),t=s(4438),k=s(4354),T=s(6600);function j(o,r){1&o&&(t.j41(0,"mat-error"),t.EFF(1," Name is required "),t.k0s())}function v(o,r){if(1&o){const e=t.RV6();t.j41(0,"div",22)(1,"img",23),t.bIt("error",function(n){t.eBV(e);const l=t.XpG();return t.Njj(l.onImageError(n))}),t.k0s(),t.j41(2,"button",24),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.removeThumbnail())}),t.j41(3,"mat-icon"),t.EFF(4,"close"),t.k0s()()()}if(2&o){let e;const a=t.XpG();t.R7$(),t.Y8G("src",null==(e=a.categoryForm.get("thumbnailUrl"))?null:e.value,t.B4B)}}function I(o,r){if(1&o&&(t.j41(0,"mat-option",17),t.EFF(1),t.k0s()),2&o){const e=r.$implicit;t.Y8G("value",e.categoryId),t.R7$(),t.SpI(" ",e.name," ")}}let R=(()=>{class o{fb;categoryService;snackBar;dialogRef;data;categoryForm;editMode=!1;availableParentCategories=[];constructor(e,a,n,l,i){this.fb=e,this.categoryService=a,this.snackBar=n,this.dialogRef=l,this.data=i,this.editMode=!!i.category,this.availableParentCategories=i.categories.filter(y=>!this.editMode||y.categoryId!==i.category?.categoryId),this.categoryForm=this.fb.group({name:[i.category?.name||"",p.k0.required],description:[i.category?.description||""],categoryType:[i.category?.categoryType||""],isPublished:[void 0===i.category?.isPublished||i.category.isPublished],thumbnailUrl:[i.category?.thumbnailUrl||""],parentCategoryId:[i.category?.parentCategoryId||null]})}onFileSelected(e){const a=e.target.files[0];if(a){const n=new FileReader;n.onload=l=>{this.categoryForm.patchValue({thumbnailUrl:l.target.result})},n.readAsDataURL(a)}}onImageError(e){console.error("Image failed to load:",e),this.snackBar.open("Failed to load image. Please check the URL.","Close",{duration:3e3})}removeThumbnail(){this.categoryForm.patchValue({thumbnailUrl:""})}onSubmit(){if(this.categoryForm.valid){const e=this.categoryForm.value;this.editMode?this.categoryService.updateCategory(this.data.category.categoryId,e).subscribe({next:()=>{this.snackBar.open("Category updated successfully","Close",{duration:3e3}),this.dialogRef.close(!0)},error:()=>{this.snackBar.open("Error updating category","Close",{duration:3e3})}}):this.categoryService.createCategory(e).subscribe({next:()=>{this.snackBar.open("Category created successfully","Close",{duration:3e3}),this.dialogRef.close(!0)},error:()=>{this.snackBar.open("Error creating category","Close",{duration:3e3})}})}}static \u0275fac=function(a){return new(a||o)(t.rXU(p.ok),t.rXU(k.M),t.rXU(b.UG),t.rXU(g.CP),t.rXU(g.Vh))};static \u0275cmp=t.VBU({type:o,selectors:[["app-category-form"]],standalone:!0,features:[t.aNF],decls:49,vars:8,consts:[["fileInput",""],["mat-dialog-title",""],[3,"ngSubmit","formGroup"],["appearance","fill",1,"full-width"],["matInput","","formControlName","name","required",""],[4,"ngIf"],["matInput","","formControlName","description","rows","3"],["matInput","","formControlName","categoryType","placeholder","e.g., Astro, IT, Student Project, Academic, Professional"],[1,"toggle-section"],["formControlName","isPublished","color","primary"],[1,"thumbnail-section"],["matInput","","formControlName","thumbnailUrl","placeholder","Enter image URL or upload file"],[1,"file-upload-section"],["type","file","accept","image/*",2,"display","none",3,"change"],["mat-stroked-button","","type","button",3,"click"],["class","thumbnail-preview",4,"ngIf"],["formControlName","parentCategoryId"],[3,"value"],[3,"value",4,"ngFor","ngForOf"],[1,"button-container"],["mat-button","","type","button","mat-dialog-close",""],["mat-raised-button","","color","primary","type","submit",3,"disabled"],[1,"thumbnail-preview"],["alt","Thumbnail preview",1,"preview-image",3,"error","src"],["mat-icon-button","","type","button",1,"remove-thumbnail",3,"click"]],template:function(a,n){if(1&a){const l=t.RV6();t.j41(0,"h2",1),t.EFF(1),t.k0s(),t.j41(2,"mat-dialog-content")(3,"form",2),t.bIt("ngSubmit",function(){return t.eBV(l),t.Njj(n.onSubmit())}),t.j41(4,"mat-form-field",3)(5,"mat-label"),t.EFF(6,"Name"),t.k0s(),t.nrm(7,"input",4),t.DNE(8,j,2,0,"mat-error",5),t.k0s(),t.j41(9,"mat-form-field",3)(10,"mat-label"),t.EFF(11,"Description"),t.k0s(),t.nrm(12,"textarea",6),t.k0s(),t.j41(13,"mat-form-field",3)(14,"mat-label"),t.EFF(15,"Category Type"),t.k0s(),t.nrm(16,"input",7),t.j41(17,"mat-hint"),t.EFF(18,"Enter the type/domain of this category (dynamic field)"),t.k0s()(),t.j41(19,"div",8)(20,"mat-slide-toggle",9),t.EFF(21," Published "),t.k0s(),t.j41(22,"mat-hint"),t.EFF(23,"Toggle to control whether this category is visible to users"),t.k0s()(),t.j41(24,"div",10)(25,"mat-form-field",3)(26,"mat-label"),t.EFF(27,"Thumbnail URL"),t.k0s(),t.nrm(28,"input",11),t.k0s(),t.j41(29,"div",12)(30,"input",13,0),t.bIt("change",function(y){return t.eBV(l),t.Njj(n.onFileSelected(y))}),t.k0s(),t.j41(32,"button",14),t.bIt("click",function(){t.eBV(l);const y=t.sdS(31);return t.Njj(y.click())}),t.j41(33,"mat-icon"),t.EFF(34,"upload"),t.k0s(),t.EFF(35," Upload Image "),t.k0s()(),t.DNE(36,v,5,1,"div",15),t.k0s(),t.j41(37,"mat-form-field",3)(38,"mat-label"),t.EFF(39,"Parent Category"),t.k0s(),t.j41(40,"mat-select",16)(41,"mat-option",17),t.EFF(42,"None"),t.k0s(),t.DNE(43,I,2,2,"mat-option",18),t.k0s()(),t.j41(44,"div",19)(45,"button",20),t.EFF(46,"Cancel"),t.k0s(),t.j41(47,"button",21),t.EFF(48),t.k0s()()()()}if(2&a){let l,i;t.R7$(),t.SpI("",n.editMode?"Edit":"Create"," Category"),t.R7$(2),t.Y8G("formGroup",n.categoryForm),t.R7$(5),t.Y8G("ngIf",null==(l=n.categoryForm.get("name"))?null:l.hasError("required")),t.R7$(28),t.Y8G("ngIf",null==(i=n.categoryForm.get("thumbnailUrl"))?null:i.value),t.R7$(5),t.Y8G("value",null),t.R7$(2),t.Y8G("ngForOf",n.availableParentCategories),t.R7$(4),t.Y8G("disabled",n.categoryForm.invalid),t.R7$(),t.SpI(" ",n.editMode?"Update":"Create"," ")}},dependencies:[f.MD,f.Sq,f.bT,p.X1,p.qT,p.me,p.BC,p.cb,p.YS,p.j4,p.JD,c.RG,c.rl,c.nJ,c.MV,c.TL,u.fS,u.fg,_.Ve,_.VO,T.wT,d.Hl,d.$z,d.iY,g.hM,g.tx,g.BI,g.Yi,b._T,h.m_,h.An,F.mV,F.sG],styles:[".full-width[_ngcontent-%COMP%]{width:100%;margin-bottom:15px}.toggle-section[_ngcontent-%COMP%]{margin:15px 0;padding:12px 0}.toggle-section[_ngcontent-%COMP%]   mat-hint[_ngcontent-%COMP%]{font-size:12px;color:#0009;margin-top:4px;display:block}.button-container[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:8px;margin-top:16px}.thumbnail-section[_ngcontent-%COMP%]{margin:16px 0;padding:16px;border:1px solid #ddd;border-radius:4px;background-color:#fafafa}.file-upload-section[_ngcontent-%COMP%]{margin:12px 0}.thumbnail-preview[_ngcontent-%COMP%]{position:relative;display:inline-block;margin-top:12px}.preview-image[_ngcontent-%COMP%]{max-width:200px;max-height:150px;border:1px solid #ddd;border-radius:4px;object-fit:cover}.remove-thumbnail[_ngcontent-%COMP%]{position:absolute;top:-8px;right:-8px;background-color:#f44336;color:#fff}.remove-thumbnail[_ngcontent-%COMP%]:hover{background-color:#d32f2f}"]})}return o})();var x=s(6695);const P=()=>[5,10,20];function M(o,r){1&o&&(t.j41(0,"th",19),t.EFF(1,"ID"),t.k0s())}function $(o,r){if(1&o&&(t.j41(0,"td",20)(1,"span",21),t.EFF(2),t.k0s()()),2&o){const e=r.$implicit;t.R7$(2),t.JRh(e.categoryId)}}function S(o,r){1&o&&(t.j41(0,"th",19),t.EFF(1,"Thumbnail"),t.k0s())}function D(o,r){if(1&o){const e=t.RV6();t.j41(0,"img",25),t.bIt("error",function(n){t.eBV(e);const l=t.XpG(2);return t.Njj(l.onImageError(n))}),t.k0s()}if(2&o){const e=t.XpG().$implicit;t.Y8G("src",e.thumbnailUrl,t.B4B)("alt",e.name+" thumbnail")}}function L(o,r){1&o&&(t.j41(0,"div",26)(1,"mat-icon"),t.EFF(2,"image"),t.k0s()())}function O(o,r){if(1&o&&(t.j41(0,"td",20)(1,"div",22),t.DNE(2,D,1,2,"img",23)(3,L,3,0,"div",24),t.k0s()()),2&o){const e=r.$implicit;t.R7$(2),t.Y8G("ngIf",e.thumbnailUrl),t.R7$(),t.Y8G("ngIf",!e.thumbnailUrl)}}function U(o,r){1&o&&(t.j41(0,"th",19),t.EFF(1,"Name"),t.k0s())}function N(o,r){if(1&o&&(t.j41(0,"td",20),t.EFF(1),t.k0s()),2&o){const e=r.$implicit;t.R7$(),t.JRh(e.name)}}function B(o,r){1&o&&(t.j41(0,"th",19),t.EFF(1,"Category Type"),t.k0s())}function G(o,r){if(1&o&&(t.j41(0,"td",20)(1,"span",27),t.EFF(2),t.k0s()()),2&o){const e=r.$implicit;t.R7$(),t.HbH("type-"+(e.categoryType||"none")),t.R7$(),t.SpI(" ",e.categoryType||"Not Set"," ")}}function V(o,r){1&o&&(t.j41(0,"th",19),t.EFF(1,"Status"),t.k0s())}function w(o,r){if(1&o&&(t.j41(0,"td",20)(1,"span",28)(2,"mat-icon"),t.EFF(3),t.k0s(),t.EFF(4),t.k0s()()),2&o){const e=r.$implicit;t.R7$(),t.HbH(e.isPublished?"status-published":"status-draft"),t.R7$(2),t.JRh(e.isPublished?"check_circle":"unpublished"),t.R7$(),t.SpI(" ",e.isPublished?"Published":"Draft"," ")}}function Y(o,r){1&o&&(t.j41(0,"th",19),t.EFF(1,"Description"),t.k0s())}function z(o,r){if(1&o&&(t.j41(0,"td",20),t.EFF(1),t.k0s()),2&o){const e=r.$implicit;t.R7$(),t.JRh(e.description)}}function X(o,r){1&o&&(t.j41(0,"th",19),t.EFF(1,"Parent Category"),t.k0s())}function A(o,r){if(1&o&&(t.j41(0,"td",20),t.EFF(1),t.k0s()),2&o){const e=r.$implicit;t.R7$(),t.JRh(e.parentCategoryName||"-")}}function H(o,r){1&o&&(t.j41(0,"th",19),t.EFF(1,"Actions"),t.k0s())}function J(o,r){if(1&o){const e=t.RV6();t.j41(0,"td",20)(1,"button",29),t.bIt("click",function(){const n=t.eBV(e).$implicit,l=t.XpG();return t.Njj(l.editCategory(n))}),t.j41(2,"mat-icon"),t.EFF(3,"edit"),t.k0s()(),t.j41(4,"button",30),t.bIt("click",function(){const n=t.eBV(e).$implicit,l=t.XpG();return t.Njj(l.deleteCategory(n))}),t.j41(5,"mat-icon"),t.EFF(6,"delete"),t.k0s()()()}}function K(o,r){1&o&&t.nrm(0,"tr",31)}function W(o,r){1&o&&t.nrm(0,"tr",32)}const Z=[{path:"",component:(()=>{class o{categoryService;dialog;snackBar;categories=[];displayedColumns=["id","thumbnail","name","categoryType","description","parentCategory","actions"];pageIndex=0;pageSize=10;filterText="";filteredCategories=[];get pagedCategories(){const e=this.pageIndex*this.pageSize;return this.filteredCategories.slice(e,e+this.pageSize)}constructor(e,a,n){this.categoryService=e,this.dialog=a,this.snackBar=n}ngOnInit(){this.loadCategories()}loadCategories(){this.categoryService.getCategories().subscribe(e=>{this.categories=e,this.onFilterChange()})}openCategoryForm(e){this.dialog.open(R,{width:"500px",data:{category:e,categories:this.categories}}).afterClosed().subscribe(n=>{n&&this.loadCategories()})}editCategory(e){this.openCategoryForm(e)}deleteCategory(e){confirm("Are you sure you want to delete this category?")&&this.categoryService.deleteCategory(e.categoryId).subscribe({next:()=>{this.loadCategories(),this.snackBar.open("Category deleted successfully","Close",{duration:3e3})},error:()=>{this.snackBar.open("Error deleting category","Close",{duration:3e3})}})}onPageChange(e){this.pageIndex=e.pageIndex,this.pageSize=e.pageSize}onFilterChange(){this.pageIndex=0;const e=this.filterText.trim().toLowerCase();this.filteredCategories=e?this.categories.filter(a=>a.name&&a.name.toLowerCase().includes(e)||a.description&&a.description.toLowerCase().includes(e)||a.categoryType&&a.categoryType.toLowerCase().includes(e)):this.categories.slice()}onImageError(e){e.target.style.display="none";const a=e.target.parentNode;if(a&&!a.querySelector(".no-thumbnail")){const n=document.createElement("div");n.className="no-thumbnail",n.innerHTML="<mat-icon>broken_image</mat-icon>",a.appendChild(n)}}static \u0275fac=function(a){return new(a||o)(t.rXU(k.M),t.rXU(g.bZ),t.rXU(b.UG))};static \u0275cmp=t.VBU({type:o,selectors:[["app-category-list"]],standalone:!0,features:[t.aNF],decls:40,vars:9,consts:[[1,"container"],[1,"header"],["mat-raised-button","","color","primary",3,"click"],["appearance","outline",2,"width","300px","margin-bottom","16px"],["matInput","","placeholder","Type to filter by name, type, or description...",3,"ngModelChange","input","ngModel"],["mat-table","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","id"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","thumbnail"],["matColumnDef","name"],["matColumnDef","categoryType"],["matColumnDef","isPublished"],["matColumnDef","description"],["matColumnDef","parentCategory"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],[3,"page","length","pageSize","pageIndex","pageSizeOptions"],["mat-header-cell",""],["mat-cell",""],[1,"id-badge"],[1,"thumbnail-cell"],["class","category-thumbnail",3,"src","alt","error",4,"ngIf"],["class","no-thumbnail",4,"ngIf"],[1,"category-thumbnail",3,"error","src","alt"],[1,"no-thumbnail"],[1,"category-type-badge"],[1,"status-badge"],["mat-icon-button","","color","primary",3,"click"],["mat-icon-button","","color","warn",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(a,n){1&a&&(t.j41(0,"div",0)(1,"div",1)(2,"h1"),t.EFF(3,"Categories"),t.k0s(),t.j41(4,"button",2),t.bIt("click",function(){return n.openCategoryForm()}),t.j41(5,"mat-icon"),t.EFF(6,"add"),t.k0s(),t.EFF(7," Add Category "),t.k0s()(),t.j41(8,"mat-form-field",3)(9,"mat-label"),t.EFF(10,"Filter categories"),t.k0s(),t.j41(11,"input",4),t.mxI("ngModelChange",function(i){return t.DH7(n.filterText,i)||(n.filterText=i),i}),t.bIt("input",function(){return n.onFilterChange()}),t.k0s()(),t.j41(12,"table",5),t.qex(13,6),t.DNE(14,M,2,0,"th",7)(15,$,3,1,"td",8),t.bVm(),t.qex(16,9),t.DNE(17,S,2,0,"th",7)(18,O,4,2,"td",8),t.bVm(),t.qex(19,10),t.DNE(20,U,2,0,"th",7)(21,N,2,1,"td",8),t.bVm(),t.qex(22,11),t.DNE(23,B,2,0,"th",7)(24,G,3,3,"td",8),t.bVm(),t.qex(25,12),t.DNE(26,V,2,0,"th",7)(27,w,5,4,"td",8),t.bVm(),t.qex(28,13),t.DNE(29,Y,2,0,"th",7)(30,z,2,1,"td",8),t.bVm(),t.qex(31,14),t.DNE(32,X,2,0,"th",7)(33,A,2,1,"td",8),t.bVm(),t.qex(34,15),t.DNE(35,H,2,0,"th",7)(36,J,7,0,"td",8),t.bVm(),t.DNE(37,K,1,0,"tr",16)(38,W,1,0,"tr",17),t.k0s(),t.j41(39,"mat-paginator",18),t.bIt("page",function(i){return n.onPageChange(i)}),t.k0s()()),2&a&&(t.R7$(11),t.R50("ngModel",n.filterText),t.R7$(),t.Y8G("dataSource",n.pagedCategories),t.R7$(25),t.Y8G("matHeaderRowDef",n.displayedColumns),t.R7$(),t.Y8G("matRowDefColumns",n.displayedColumns),t.R7$(),t.Y8G("length",n.categories.length)("pageSize",n.pageSize)("pageIndex",n.pageIndex)("pageSizeOptions",t.lJ4(8,P)))},dependencies:[f.MD,f.bT,m.tP,m.Zl,m.tL,m.ji,m.cC,m.YV,m.iL,m.KS,m.$R,m.YZ,m.NB,d.Hl,d.$z,d.iY,h.m_,h.An,g.hM,b._T,x.Ou,x.iy,c.RG,c.rl,c.nJ,u.fS,u.fg,p.YN,p.me,p.BC,p.vS],styles:[".container[_ngcontent-%COMP%]{padding:20px}.header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px}table[_ngcontent-%COMP%]{width:100%}.id-badge[_ngcontent-%COMP%]{background-color:#e3f2fd;color:#1976d2;padding:4px 8px;border-radius:12px;font-size:12px;font-weight:500;font-family:Courier New,monospace}.thumbnail-cell[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:60px;height:60px}.category-thumbnail[_ngcontent-%COMP%]{width:50px;height:50px;object-fit:cover;border-radius:4px;border:1px solid #ddd}.no-thumbnail[_ngcontent-%COMP%]{width:50px;height:50px;display:flex;align-items:center;justify-content:center;background-color:#f5f5f5;border:1px solid #ddd;border-radius:4px;color:#999}.category-type-badge[_ngcontent-%COMP%]{padding:4px 8px;border-radius:12px;font-size:12px;font-weight:500;text-transform:capitalize}.type-Astro[_ngcontent-%COMP%]{background-color:#e8f5e8;color:#2e7d32}.type-IT[_ngcontent-%COMP%]{background-color:#e3f2fd;color:#1976d2}.type-Student[_ngcontent-%COMP%]{background-color:#fff3e0;color:#f57c00}.type-none[_ngcontent-%COMP%]{background-color:#f5f5f5;color:#666}.type-Academic[_ngcontent-%COMP%]{background-color:#f3e5f5;color:#7b1fa2}.type-Professional[_ngcontent-%COMP%]{background-color:#fce4ec;color:#c2185b}"]})}return o})()}]},4354:(E,C,s)=>{s.d(C,{M:()=>h});var f=s(5312),m=s(4438),d=s(1626);let h=(()=>{class g{http;apiUrl=`${f.c.apiUrl}/secure/categories`;constructor(c){this.http=c}getCategories(){return this.http.post(`${this.apiUrl}/get-all`,{})}getCategoryById(c){return this.http.post(`${this.apiUrl}/get-by-id`,{id:c})}getRootCategories(){return this.http.post(`${this.apiUrl}/get-root`,{})}getCategoriesByParent(c){return this.http.post(`${this.apiUrl}/get-by-parent`,{parentId:c})}createCategory(c){return this.http.post(this.apiUrl,c)}updateCategory(c,u){return this.http.put(`${this.apiUrl}/${c}`,u)}deleteCategory(c){return this.http.delete(`${this.apiUrl}/${c}`)}static \u0275fac=function(u){return new(u||g)(m.KVO(d.Qq))};static \u0275prov=m.jDH({token:g,factory:g.\u0275fac,providedIn:"root"})}return g})()}}]);