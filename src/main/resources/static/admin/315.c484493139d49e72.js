"use strict";(self.webpackChunkadmin=self.webpackChunkadmin||[]).push([[315],{7315:(Y,F,i)=>{i.r(F),i.d(F,{TAGS_ROUTES:()=>V});var u=i(177),g=i(9159),m=i(8834),b=i(9213),f=i(5416),d=i(5351),h=i(450),p=i(5596),_=i(4823),C=i(9183),v=i(6695),l=i(9417),T=i(2102),k=i(9631),t=i(4438),x=i(6538);function P(e,s){1&e&&(t.j41(0,"mat-error"),t.EFF(1," Tag name is required "),t.k0s())}let E=(()=>{class e{fb;tagService;snackBar;dialogRef;data;tagForm;editMode=!1;isLoading=!1;constructor(a,n,o,r,c){this.fb=a,this.tagService=n,this.snackBar=o,this.dialogRef=r,this.data=c,this.editMode=!!c?.tag,this.tagForm=this.createForm(),this.editMode&&c.tag&&this.populateForm(c.tag)}createForm(){return this.fb.group({tagName:["",[l.k0.required,l.k0.minLength(2)]],description:[""],statusFlag:[!0]})}populateForm(a){console.log("Populating form with tag data:",a),this.tagForm.patchValue({tagName:a.tagName,description:a.description||"",statusFlag:void 0===a.statusFlag||a.statusFlag}),console.log("Form values after population:",this.tagForm.value)}onSubmit(){if(this.tagForm.valid&&!this.isLoading){this.isLoading=!0;const a=this.tagForm.value;console.log("Form submission - form value:",a);const n={tagName:a.tagName,description:a.description,statusFlag:a.statusFlag};console.log("Form submission - tag data being sent:",n),this.editMode&&this.data.tag?(n.tagId=this.data.tag.tagId,this.updateTag(n)):this.createTag(n)}else console.log("Form is invalid or loading:",{valid:this.tagForm.valid,loading:this.isLoading,formErrors:this.tagForm.errors,formValue:this.tagForm.value})}createTag(a){console.log("Creating tag with data:",a),this.tagService.createTag(a).subscribe({next:n=>{console.log("Tag created successfully:",n),this.snackBar.open("Tag created successfully","Close",{duration:3e3}),this.dialogRef.close(n)},error:n=>{console.error("Error creating tag:",n),this.snackBar.open("Error creating tag","Close",{duration:3e3}),this.isLoading=!1}})}updateTag(a){console.log("Updating tag with data:",a),this.tagService.updateTag(a.tagId,a).subscribe({next:n=>{console.log("Tag updated successfully:",n),this.snackBar.open("Tag updated successfully","Close",{duration:3e3}),this.dialogRef.close(n)},error:n=>{console.error("Error updating tag:",n),this.snackBar.open("Error updating tag","Close",{duration:3e3}),this.isLoading=!1}})}static \u0275fac=function(n){return new(n||e)(t.rXU(l.ok),t.rXU(x.w),t.rXU(f.UG),t.rXU(d.CP),t.rXU(d.Vh))};static \u0275cmp=t.VBU({type:e,selectors:[["app-tag-form"]],standalone:!0,features:[t.aNF],decls:21,vars:5,consts:[["mat-dialog-title",""],[3,"ngSubmit","formGroup"],["appearance","fill",1,"full-width"],["matInput","","formControlName","tagName","required",""],[4,"ngIf"],["matInput","","formControlName","description","rows","3"],[1,"status-toggle"],["formControlName","statusFlag"],[1,"button-container"],["mat-button","","type","button","mat-dialog-close",""],["mat-raised-button","","color","primary","type","submit",3,"disabled"]],template:function(n,o){if(1&n&&(t.j41(0,"h2",0),t.EFF(1),t.k0s(),t.j41(2,"mat-dialog-content")(3,"form",1),t.bIt("ngSubmit",function(){return o.onSubmit()}),t.j41(4,"mat-form-field",2)(5,"mat-label"),t.EFF(6,"Tag Name"),t.k0s(),t.nrm(7,"input",3),t.DNE(8,P,2,0,"mat-error",4),t.k0s(),t.j41(9,"mat-form-field",2)(10,"mat-label"),t.EFF(11,"Description"),t.k0s(),t.nrm(12,"textarea",5),t.k0s(),t.j41(13,"div",6)(14,"mat-slide-toggle",7),t.EFF(15," Enable Tag "),t.k0s()(),t.j41(16,"div",8)(17,"button",9),t.EFF(18,"Cancel"),t.k0s(),t.j41(19,"button",10),t.EFF(20),t.k0s()()()()),2&n){let r;t.R7$(),t.SpI("",o.editMode?"Edit":"Create"," Tag"),t.R7$(2),t.Y8G("formGroup",o.tagForm),t.R7$(5),t.Y8G("ngIf",null==(r=o.tagForm.get("tagName"))?null:r.hasError("required")),t.R7$(11),t.Y8G("disabled",o.tagForm.invalid||o.isLoading),t.R7$(),t.SpI(" ",o.isLoading?"Saving...":o.editMode?"Update":"Create"," ")}},dependencies:[u.MD,u.bT,l.X1,l.qT,l.me,l.BC,l.cb,l.YS,l.j4,l.JD,T.RG,T.rl,T.nJ,T.TL,k.fS,k.fg,m.Hl,m.$z,d.hM,d.tx,d.BI,d.Yi,f._T,h.mV,h.sG],styles:[".full-width[_ngcontent-%COMP%]{width:100%;margin-bottom:15px}.status-toggle[_ngcontent-%COMP%]{margin:16px 0}.button-container[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:8px;margin-top:16px}mat-dialog-content[_ngcontent-%COMP%]{min-width:400px;max-width:500px}"]})}return e})();const j=()=>[5,10,20];function S(e,s){1&e&&(t.j41(0,"div",10),t.nrm(1,"mat-spinner",11),t.j41(2,"p"),t.EFF(3,"Loading tags..."),t.k0s()())}function I(e,s){1&e&&(t.j41(0,"th",21),t.EFF(1," Name "),t.k0s())}function M(e,s){if(1&e&&(t.j41(0,"td",22),t.EFF(1),t.k0s()),2&e){const a=s.$implicit;t.R7$(),t.SpI(" ",a.tagName," ")}}function R(e,s){1&e&&(t.j41(0,"th",21),t.EFF(1," Description "),t.k0s())}function N(e,s){if(1&e&&(t.j41(0,"td",22),t.EFF(1),t.k0s()),2&e){const a=s.$implicit;t.R7$(),t.SpI(" ",a.description||"-"," ")}}function y(e,s){1&e&&(t.j41(0,"th",21),t.EFF(1," Status "),t.k0s())}function O(e,s){if(1&e){const a=t.RV6();t.j41(0,"td",22)(1,"mat-slide-toggle",23),t.bIt("change",function(o){const r=t.eBV(a).$implicit,c=t.XpG(2);return t.Njj(c.toggleTagStatus(r,o))}),t.k0s()()}if(2&e){const a=s.$implicit;t.R7$(),t.Y8G("checked",!1!==a.statusFlag)}}function D(e,s){1&e&&(t.j41(0,"th",21),t.EFF(1," Actions "),t.k0s())}function G(e,s){if(1&e){const a=t.RV6();t.j41(0,"td",22)(1,"button",24),t.bIt("click",function(){const o=t.eBV(a).$implicit,r=t.XpG(2);return t.Njj(r.editTag(o))}),t.j41(2,"mat-icon"),t.EFF(3,"edit"),t.k0s()(),t.j41(4,"button",25),t.bIt("click",function(){const o=t.eBV(a).$implicit,r=t.XpG(2);return t.Njj(r.deleteTag(o))}),t.j41(5,"mat-icon"),t.EFF(6,"delete"),t.k0s()()()}}function $(e,s){1&e&&t.nrm(0,"tr",26)}function B(e,s){1&e&&t.nrm(0,"tr",27)}function L(e,s){if(1&e&&(t.j41(0,"table",12),t.qex(1,13),t.DNE(2,I,2,0,"th",14)(3,M,2,1,"td",15),t.bVm(),t.qex(4,16),t.DNE(5,R,2,0,"th",14)(6,N,2,1,"td",15),t.bVm(),t.qex(7,17),t.DNE(8,y,2,0,"th",14)(9,O,2,1,"td",15),t.bVm(),t.qex(10,18),t.DNE(11,D,2,0,"th",14)(12,G,7,0,"td",15),t.bVm(),t.DNE(13,$,1,0,"tr",19)(14,B,1,0,"tr",20),t.k0s()),2&e){const a=t.XpG();t.Y8G("dataSource",a.pagedTags),t.R7$(13),t.Y8G("matHeaderRowDef",a.displayedColumns),t.R7$(),t.Y8G("matRowDefColumns",a.displayedColumns)}}function w(e,s){if(1&e){const a=t.RV6();t.j41(0,"div",28)(1,"mat-icon"),t.EFF(2,"local_offer"),t.k0s(),t.j41(3,"p"),t.EFF(4,"No tags found."),t.k0s(),t.j41(5,"button",4),t.bIt("click",function(){t.eBV(a);const o=t.XpG();return t.Njj(o.openTagForm())}),t.EFF(6," Create First Tag "),t.k0s()()}}const V=[{path:"",component:(()=>{class e{tagService;snackBar;dialog;tags=[];pageIndex=0;pageSize=10;isLoading=!1;displayedColumns=["tagName","description","statusFlag","actions"];get pagedTags(){const a=this.pageIndex*this.pageSize;return this.tags.slice(a,a+this.pageSize)}constructor(a,n,o){this.tagService=a,this.snackBar=n,this.dialog=o}ngOnInit(){this.loadTags()}loadTags(){this.isLoading=!0,this.tagService.getTags().subscribe({next:a=>{this.tags=a,this.pageIndex=0,this.isLoading=!1},error:a=>{console.error("Error loading tags:",a),this.snackBar.open("Error loading tags","Close",{duration:3e3}),this.isLoading=!1}})}openTagForm(a){this.dialog.open(E,{width:"500px",data:{tag:a}}).afterClosed().subscribe(o=>{o&&this.loadTags()})}editTag(a){this.openTagForm(a)}toggleTagStatus(a,n){const o=n.checked,r={...a,statusFlag:o};this.tagService.updateTag(a.tagId,r).subscribe({next:()=>{this.snackBar.open("Tag "+(o?"enabled":"disabled"),"Close",{duration:2e3}),this.loadTags()},error:c=>{console.error("Error updating tag status:",c),this.snackBar.open("Error updating tag status","Close",{duration:3e3}),this.loadTags()}})}deleteTag(a){confirm(`Are you sure you want to delete the tag "${a.tagName}"?`)&&this.tagService.deleteTag(a.tagId).subscribe({next:()=>{this.snackBar.open("Tag deleted successfully","Close",{duration:3e3}),this.loadTags()},error:n=>{console.error("Error deleting tag:",n),this.snackBar.open("Error deleting tag","Close",{duration:3e3})}})}onPageChange(a){this.pageIndex=a.pageIndex,this.pageSize=a.pageSize}static \u0275fac=function(n){return new(n||e)(t.rXU(x.w),t.rXU(f.UG),t.rXU(d.bZ))};static \u0275cmp=t.VBU({type:e,selectors:[["app-tags-page"]],standalone:!0,features:[t.aNF],decls:21,vars:9,consts:[[1,"container"],[1,"header-content"],[1,"header-actions"],["mat-icon-button","","color","primary","matTooltip","Refresh tags",3,"click","disabled"],["mat-raised-button","","color","primary",3,"click"],[1,"table-container"],["class","loading-container",4,"ngIf"],["mat-table","","class","mat-elevation-z2",3,"dataSource",4,"ngIf"],[3,"page","length","pageSize","pageIndex","pageSizeOptions"],["class","no-data",4,"ngIf"],[1,"loading-container"],["diameter","50"],["mat-table","",1,"mat-elevation-z2",3,"dataSource"],["matColumnDef","tagName"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","description"],["matColumnDef","statusFlag"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],[3,"change","checked"],["mat-icon-button","","aria-label","Edit",3,"click"],["mat-icon-button","","aria-label","Delete","color","warn",3,"click"],["mat-header-row",""],["mat-row",""],[1,"no-data"]],template:function(n,o){1&n&&(t.j41(0,"div",0)(1,"mat-card")(2,"mat-card-header")(3,"mat-card-title")(4,"div",1)(5,"h2"),t.EFF(6,"Manage Tags"),t.k0s(),t.j41(7,"div",2)(8,"button",3),t.bIt("click",function(){return o.loadTags()}),t.j41(9,"mat-icon"),t.EFF(10,"refresh"),t.k0s()(),t.j41(11,"button",4),t.bIt("click",function(){return o.openTagForm()}),t.j41(12,"mat-icon"),t.EFF(13,"add"),t.k0s(),t.EFF(14," Add New Tag "),t.k0s()()()()(),t.j41(15,"mat-card-content")(16,"div",5),t.DNE(17,S,4,0,"div",6)(18,L,15,3,"table",7),t.j41(19,"mat-paginator",8),t.bIt("page",function(c){return o.onPageChange(c)}),t.k0s(),t.DNE(20,w,7,0,"div",9),t.k0s()()()()),2&n&&(t.R7$(8),t.Y8G("disabled",o.isLoading),t.R7$(9),t.Y8G("ngIf",o.isLoading),t.R7$(),t.Y8G("ngIf",!o.isLoading),t.R7$(),t.Y8G("length",o.tags.length)("pageSize",o.pageSize)("pageIndex",o.pageIndex)("pageSizeOptions",t.lJ4(8,j)),t.R7$(),t.Y8G("ngIf",!o.isLoading&&0===o.tags.length))},dependencies:[u.MD,u.bT,g.tP,g.Zl,g.tL,g.ji,g.cC,g.YV,g.iL,g.KS,g.$R,g.YZ,g.NB,m.Hl,m.$z,m.iY,b.m_,b.An,f._T,d.hM,h.mV,h.sG,p.Hu,p.RN,p.m2,p.MM,p.dh,_.uc,_.oV,C.D6,C.LG,v.Ou,v.iy],styles:[".container[_ngcontent-%COMP%]{padding:20px;max-width:1200px;margin:0 auto}.header-content[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;width:100%}.header-content[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;color:#333}.header-actions[_ngcontent-%COMP%]{display:flex;gap:8px;align-items:center}.table-container[_ngcontent-%COMP%]{width:100%;overflow-x:auto;margin-top:20px}.loading-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:40px;text-align:center}.loading-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-top:16px;color:#666}.no-data[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:40px;text-align:center;color:#666}.no-data[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:48px;height:48px;width:48px;margin-bottom:16px;opacity:.6}.no-data[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-bottom:16px;font-size:16px}table[_ngcontent-%COMP%]{width:100%}th.mat-header-cell[_ngcontent-%COMP%]{font-weight:600;color:#333}.mat-mdc-button[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{margin-right:8px}.mat-mdc-table[_ngcontent-%COMP%]{width:100%;background:#fff}"]})}return e})()}]}}]);