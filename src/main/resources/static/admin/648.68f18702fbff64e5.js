"use strict";(self.webpackChunkadmin=self.webpackChunkadmin||[]).push([[648],{3648:(_n,W,c)=>{c.r(W),c.d(W,{LESSONS_ROUTES:()=>xn});var g=c(177),x=c(9159),k=c(8834),I=c(9213),_=c(5596),C=c(2102),w=c(2798),M=c(850),L=c(9631),F=c(5351),$=c(6471),O=c(4823),R=c(5416),m=c(9417),ve=c(450),J=c(6695),y=c(7673),N=c(9172),P=c(152),G=c(3294),A=c(5558),e=c(4438),Z=c(3822),ee=c(9973),te=c(3635),be=c(4354),q=c(4710),z=c(6600);const xe=()=>[5,10,20];function _e(i,a){if(1&i&&(e.j41(0,"mat-option",16),e.EFF(1),e.k0s()),2&i){const t=a.$implicit;e.Y8G("value",t.categoryId),e.R7$(),e.SpI(" ",t.name," ")}}function Ce(i,a){if(1&i&&(e.j41(0,"mat-option",16),e.EFF(1),e.k0s()),2&i){const t=a.$implicit;e.Y8G("value",t.courseId),e.R7$(),e.SpI(" ",t.title," ")}}function Fe(i,a){if(1&i&&(e.j41(0,"mat-option",16),e.EFF(1),e.k0s()),2&i){const t=a.$implicit,n=e.XpG();e.Y8G("value",t),e.R7$(),e.SpI(" ",n.displayTopicFn(t)," ")}}function ke(i,a){if(1&i&&(e.j41(0,"span",33),e.EFF(1),e.k0s()),2&i){const t=e.XpG(2);e.R7$(),e.Lme(" (",t.selectedCourse.title," - ",t.selectedCategory.name,") ")}}function Ee(i,a){1&i&&(e.j41(0,"th",34),e.EFF(1,"ID"),e.k0s())}function Te(i,a){if(1&i&&(e.j41(0,"td",35),e.EFF(1),e.k0s()),2&i){const t=a.$implicit;e.R7$(),e.JRh(t.lessonId)}}function Ie(i,a){1&i&&(e.j41(0,"th",34),e.EFF(1,"Order"),e.k0s())}function Me(i,a){if(1&i&&(e.j41(0,"td",35),e.EFF(1),e.k0s()),2&i){const t=a.$implicit;e.R7$(),e.JRh(t.orderNumber)}}function Se(i,a){1&i&&(e.j41(0,"th",34),e.EFF(1,"Title"),e.k0s())}function je(i,a){if(1&i&&(e.j41(0,"td",35),e.EFF(1),e.k0s()),2&i){const t=a.$implicit;e.R7$(),e.JRh(t.title)}}function Pe(i,a){1&i&&(e.j41(0,"th",34),e.EFF(1,"Content Type"),e.k0s())}function Ae(i,a){if(1&i&&(e.j41(0,"td",35)(1,"span",36),e.EFF(2),e.nI1(3,"titlecase"),e.k0s()()),2&i){const t=a.$implicit;e.R7$(),e.HbH("content-type-"+t.contentType),e.R7$(),e.SpI(" ",e.bMT(3,3,t.contentType)," ")}}function we(i,a){1&i&&(e.j41(0,"th",34),e.EFF(1,"Duration"),e.k0s())}function Le(i,a){if(1&i&&(e.j41(0,"td",35),e.EFF(1),e.k0s()),2&i){const t=a.$implicit;e.R7$(),e.SpI(" ",t.durationMinutes?t.durationMinutes+" min":"-"," ")}}function Oe(i,a){1&i&&(e.j41(0,"th",34),e.EFF(1,"Free"),e.k0s())}function Re(i,a){if(1&i&&(e.j41(0,"td",35)(1,"mat-icon",37),e.EFF(2),e.k0s()()),2&i){const t=a.$implicit;e.R7$(),e.Y8G("color",t.isFree?"primary":"warn"),e.R7$(),e.SpI(" ",t.isFree?"check_circle":"lock"," ")}}function Ne(i,a){1&i&&(e.j41(0,"th",34),e.EFF(1,"Created"),e.k0s())}function De(i,a){if(1&i&&(e.j41(0,"td",35),e.EFF(1),e.nI1(2,"date"),e.k0s()),2&i){const t=a.$implicit;e.R7$(),e.JRh(e.i5U(2,1,t.createdAt,"short"))}}function Be(i,a){1&i&&(e.j41(0,"th",34),e.EFF(1,"Actions"),e.k0s())}function Ve(i,a){if(1&i){const t=e.RV6();e.j41(0,"td",35)(1,"button",38),e.bIt("click",function(){const o=e.eBV(t).$implicit,s=e.XpG(2);return e.Njj(s.viewLessonDetails(o))}),e.j41(2,"mat-icon"),e.EFF(3,"visibility"),e.k0s()(),e.j41(4,"button",39),e.bIt("click",function(){const o=e.eBV(t).$implicit,s=e.XpG(2);return e.Njj(s.navigateToEditLesson(o.lessonId))}),e.j41(5,"mat-icon"),e.EFF(6,"edit"),e.k0s()(),e.j41(7,"button",40),e.bIt("click",function(){const o=e.eBV(t).$implicit,s=e.XpG(2);return e.Njj(s.deleteLesson(o.lessonId))}),e.j41(8,"mat-icon"),e.EFF(9,"delete"),e.k0s()()()}}function $e(i,a){1&i&&e.nrm(0,"tr",41)}function Ge(i,a){1&i&&e.nrm(0,"tr",42)}function qe(i,a){1&i&&(e.j41(0,"div",43)(1,"p"),e.EFF(2,"No lessons found for this topic."),e.k0s()())}function ze(i,a){if(1&i){const t=e.RV6();e.j41(0,"mat-card")(1,"mat-card-header")(2,"mat-card-title"),e.EFF(3),e.DNE(4,ke,2,2,"span",17),e.k0s()(),e.j41(5,"mat-card-content")(6,"table",18),e.qex(7,19),e.DNE(8,Ee,2,0,"th",20)(9,Te,2,1,"td",21),e.bVm(),e.qex(10,22),e.DNE(11,Ie,2,0,"th",20)(12,Me,2,1,"td",21),e.bVm(),e.qex(13,23),e.DNE(14,Se,2,0,"th",20)(15,je,2,1,"td",21),e.bVm(),e.qex(16,24),e.DNE(17,Pe,2,0,"th",20)(18,Ae,4,5,"td",21),e.bVm(),e.qex(19,25),e.DNE(20,we,2,0,"th",20)(21,Le,2,1,"td",21),e.bVm(),e.qex(22,26),e.DNE(23,Oe,2,0,"th",20)(24,Re,3,2,"td",21),e.bVm(),e.qex(25,27),e.DNE(26,Ne,2,0,"th",20)(27,De,3,4,"td",21),e.bVm(),e.qex(28,28),e.DNE(29,Be,2,0,"th",20)(30,Ve,10,0,"td",21),e.bVm(),e.DNE(31,$e,1,0,"tr",29)(32,Ge,1,0,"tr",30),e.k0s(),e.j41(33,"mat-paginator",31),e.bIt("page",function(o){e.eBV(t);const s=e.XpG();return e.Njj(s.onPageChange(o))}),e.k0s(),e.DNE(34,qe,3,0,"div",32),e.k0s()()}if(2&i){const t=e.XpG();e.R7$(3),e.SpI(" Lessons for: ",t.selectedTopic.title," "),e.R7$(),e.Y8G("ngIf",t.selectedCourse&&t.selectedCategory),e.R7$(2),e.Y8G("dataSource",t.pagedLessons),e.R7$(25),e.Y8G("matHeaderRowDef",t.displayedColumns),e.R7$(),e.Y8G("matRowDefColumns",t.displayedColumns),e.R7$(),e.Y8G("length",t.lessons.length)("pageSize",t.pageSize)("pageIndex",t.pageIndex)("pageSizeOptions",e.lJ4(10,xe)),e.R7$(),e.Y8G("ngIf",0===t.lessons.length)}}function He(i,a){1&i&&(e.j41(0,"mat-card",44)(1,"mat-card-content")(2,"div",43)(3,"mat-icon"),e.EFF(4,"play_lesson"),e.k0s(),e.j41(5,"p"),e.EFF(6,"Please select a topic to view its lessons."),e.k0s()()()())}function Xe(i,a){if(1&i&&(e.j41(0,"div",3)(1,"strong"),e.EFF(2,"Duration:"),e.k0s(),e.EFF(3),e.k0s()),2&i){const t=e.XpG();e.R7$(3),e.SpI(" ",t.data.lesson.durationMinutes," minutes ")}}function Ye(i,a){if(1&i&&(e.j41(0,"div",3)(1,"strong"),e.EFF(2,"Content URL:"),e.k0s(),e.j41(3,"a",12),e.EFF(4),e.k0s()()),2&i){const t=e.XpG();e.R7$(3),e.Y8G("href",t.data.lesson.contentUrl,e.B4B),e.R7$(),e.SpI(" ",t.data.lesson.contentUrl," ")}}function Ue(i,a){if(1&i&&(e.j41(0,"div",3)(1,"strong"),e.EFF(2,"Created:"),e.k0s(),e.EFF(3),e.nI1(4,"date"),e.k0s()),2&i){const t=e.XpG();e.R7$(3),e.SpI(" ",e.i5U(4,1,t.parseDate(t.data.lesson.createdAt),"medium")," ")}}function Qe(i,a){if(1&i&&(e.j41(0,"div",13)(1,"h3"),e.EFF(2,"Description"),e.k0s(),e.nrm(3,"div",14),e.k0s()),2&i){const t=e.XpG();e.R7$(3),e.Y8G("innerHTML",t.data.lesson.description,e.npT)}}let Ke=(()=>{class i{lessonService;topicService;courseService;categoryService;snackBar;router;dialog;lessons=[];selectedTopic=null;selectedCourse=null;selectedCategory=null;categories=[];filteredCourses=[];allTopics=[];categoryControl=new m.MJ("");courseControl=new m.MJ("");topicSearchControl=new m.MJ("");filteredTopics=(0,y.of)([]);displayedColumns=["lessonId","orderNumber","title","contentType","duration","isFree","createdAt","actions"];pageIndex=0;pageSize=10;get pagedLessons(){const t=this.pageIndex*this.pageSize;return this.lessons.slice(t,t+this.pageSize)}constructor(t,n,o,s,r,l,u){this.lessonService=t,this.topicService=n,this.courseService=o,this.categoryService=s,this.snackBar=r,this.router=l,this.dialog=u}ngOnInit(){Promise.all([this.loadCategoriesAsync(),this.loadAllTopicsAsync()]).then(()=>{this.setupTopicAutocomplete(),this.restoreSelectedTopic()})}loadCategories(){this.categoryService.getCategories().subscribe({next:t=>{this.categories=t},error:()=>{this.snackBar.open("Error loading categories","Close",{duration:3e3})}})}loadAllTopics(){this.topicService.getAllTopics().subscribe({next:t=>{this.allTopics=t},error:()=>{this.snackBar.open("Error loading topics","Close",{duration:3e3})}})}loadCategoriesAsync(){return new Promise((t,n)=>{this.categoryService.getCategories().subscribe({next:o=>{this.categories=o,t()},error:o=>{this.snackBar.open("Error loading categories","Close",{duration:3e3}),n(o)}})})}loadAllTopicsAsync(){return new Promise((t,n)=>{this.topicService.getAllTopics().subscribe({next:o=>{this.allTopics=o,t()},error:o=>{this.snackBar.open("Error loading topics","Close",{duration:3e3}),n(o)}})})}onCategorySelected(t){const n=t.value;this.selectedCategory=n&&this.categories.find(o=>o.categoryId===n)||null,this.courseControl.setValue(""),this.topicSearchControl.setValue(""),this.selectedCourse=null,this.selectedTopic=null,this.lessons=[],n?this.loadCoursesByCategory(n):this.filteredCourses=[]}onCourseSelected(t){const n=t.value;this.selectedCourse=n&&this.filteredCourses.find(o=>o.courseId===n)||null,this.topicSearchControl.setValue(""),this.selectedTopic=null,this.lessons=[],this.setupTopicAutocomplete()}loadCoursesByCategory(t){this.courseService.getAllCourses().subscribe({next:n=>{this.filteredCourses=n.filter(o=>o.categoryId===t)},error:()=>{this.snackBar.open("Error loading courses","Close",{duration:3e3})}})}restoreSelectedTopic(){const t=history.state;if(t&&t.selectedTopic){const n=t.selectedTopic;this.selectedTopic=n,this.topicSearchControl.setValue(n),t.selectedCategory&&(this.selectedCategory=t.selectedCategory,this.selectedCategory&&this.selectedCategory.categoryId&&this.categoryControl.setValue(this.selectedCategory.categoryId)),t.selectedCourse?(this.selectedCourse=t.selectedCourse,this.selectedCourse&&(this.loadCoursesByCategory(this.selectedCourse.categoryId),this.courseControl.setValue(this.selectedCourse.courseId))):n.courseId&&this.courseService.getCourseById(n.courseId).subscribe({next:o=>{if(this.selectedCourse=o,this.courseControl.setValue(o.courseId),!this.selectedCategory&&o.categoryId){const s=this.categories.find(r=>r.categoryId===o.categoryId);s&&s.categoryId&&(this.selectedCategory=s,this.categoryControl.setValue(s.categoryId),this.loadCoursesByCategory(s.categoryId))}}}),this.loadLessons()}}setupTopicAutocomplete(){this.filteredTopics=this.topicSearchControl.valueChanges.pipe((0,N.Z)(""),(0,P.B)(300),(0,G.F)(),(0,A.n)(t=>this._filterTopics(t||"")))}_filterTopics(t){const n="string"==typeof t?t:t?.title||"";if(!n||""===n.trim())return(0,y.of)(this.courseControl.value?this.allTopics.filter(s=>s.courseId===this.courseControl.value):this.allTopics);let o=this.allTopics.filter(s=>s.title.toLowerCase().includes(n.toLowerCase()));return this.courseControl.value&&(o=o.filter(s=>s.courseId===this.courseControl.value)),(0,y.of)(o)}displayTopicFn=t=>{if(!t)return"";let s="";return t.courseId&&this.selectedCourse&&(s=` - ${this.selectedCourse.title}`),`${t.title||"Untitled"} (ID: ${t.topicId||"N/A"})${s}`};onTopicSelected(t){const n=t.option.value;this.selectedTopic=n,!this.selectedCourse&&n.courseId&&this.courseService.getCourseById(n.courseId).subscribe({next:o=>{if(this.selectedCourse=o,this.courseControl.setValue(o.courseId),!this.selectedCategory&&o.categoryId){const s=this.categories.find(r=>r.categoryId===o.categoryId);s&&s.categoryId&&(this.selectedCategory=s,this.categoryControl.setValue(s.categoryId),this.loadCoursesByCategory(s.categoryId))}}}),this.loadLessons()}navigateToAddLesson(){this.selectedTopic&&this.router.navigate(["lessons/add"],{state:{selectedTopic:this.selectedTopic,selectedCourse:this.selectedCourse,selectedCategory:this.selectedCategory}})}navigateToEditLesson(t){this.router.navigate(["lessons/update",t],{state:{selectedTopic:this.selectedTopic,selectedCourse:this.selectedCourse,selectedCategory:this.selectedCategory}})}loadLessons(){this.selectedTopic&&this.lessonService.getLessonsByTopicId(this.selectedTopic.topicId).subscribe({next:t=>{this.lessons=t.map(n=>({...n,createdAt:H(n.createdAt),updatedAt:H(n.updatedAt)})),this.pageIndex=0},error:()=>{this.snackBar.open("Error loading lessons","Close",{duration:3e3})}})}onPageChange(t){this.pageIndex=t.pageIndex,this.pageSize=t.pageSize}deleteLesson(t){confirm("Are you sure you want to delete this lesson?")&&this.lessonService.deleteLesson(t).subscribe({next:()=>{this.loadLessons(),this.snackBar.open("Lesson deleted successfully","Close",{duration:3e3})},error:()=>{this.snackBar.open("Error deleting lesson","Close",{duration:3e3})}})}viewLessonDetails(t){this.dialog.open(We,{width:"800px",maxHeight:"90vh",data:{lesson:t}})}static \u0275fac=function(n){return new(n||i)(e.rXU(Z.u),e.rXU(ee.h),e.rXU(te.f),e.rXU(be.M),e.rXU(R.UG),e.rXU(q.Ix),e.rXU(F.bZ))};static \u0275cmp=e.VBU({type:i,selectors:[["app-lesson-list"]],standalone:!0,features:[e.aNF],decls:35,vars:14,consts:[["auto","matAutocomplete"],[1,"container"],[1,"header"],["mat-raised-button","","color","primary",3,"click","disabled"],[1,"filter-card"],[1,"filter-row"],[1,"filter-field"],[3,"selectionChange","formControl"],["value",""],[3,"value",4,"ngFor","ngForOf"],[3,"selectionChange","formControl","disabled"],[1,"full-width"],["type","text","matInput","","placeholder","Type to search topics...",3,"formControl","matAutocomplete"],[3,"optionSelected","displayWith"],[4,"ngIf"],["class","placeholder-card",4,"ngIf"],[3,"value"],["class","topic-context",4,"ngIf"],["mat-table","",1,"full-width",3,"dataSource"],["matColumnDef","lessonId"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","orderNumber"],["matColumnDef","title"],["matColumnDef","contentType"],["matColumnDef","duration"],["matColumnDef","isFree"],["matColumnDef","createdAt"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],[3,"page","length","pageSize","pageIndex","pageSizeOptions"],["class","no-data",4,"ngIf"],[1,"topic-context"],["mat-header-cell",""],["mat-cell",""],[1,"content-type-badge"],[3,"color"],["mat-icon-button","","color","accent","matTooltip","View Details",3,"click"],["mat-icon-button","","color","primary","matTooltip","Edit",3,"click"],["mat-icon-button","","color","warn","matTooltip","Delete",3,"click"],["mat-header-row",""],["mat-row",""],[1,"no-data"],[1,"placeholder-card"]],template:function(n,o){if(1&n){const s=e.RV6();e.j41(0,"div",1)(1,"div",2)(2,"h1"),e.EFF(3,"Lessons"),e.k0s(),e.j41(4,"button",3),e.bIt("click",function(){return e.eBV(s),e.Njj(o.navigateToAddLesson())}),e.j41(5,"mat-icon"),e.EFF(6,"add"),e.k0s(),e.EFF(7," Add Lesson "),e.k0s()(),e.j41(8,"mat-card",4)(9,"mat-card-content")(10,"div",5)(11,"mat-form-field",6)(12,"mat-label"),e.EFF(13,"Filter by Category"),e.k0s(),e.j41(14,"mat-select",7),e.bIt("selectionChange",function(l){return e.eBV(s),e.Njj(o.onCategorySelected(l))}),e.j41(15,"mat-option",8),e.EFF(16,"All Categories"),e.k0s(),e.DNE(17,_e,2,2,"mat-option",9),e.k0s()(),e.j41(18,"mat-form-field",6)(19,"mat-label"),e.EFF(20,"Filter by Course"),e.k0s(),e.j41(21,"mat-select",10),e.bIt("selectionChange",function(l){return e.eBV(s),e.Njj(o.onCourseSelected(l))}),e.j41(22,"mat-option",8),e.EFF(23,"All Courses"),e.k0s(),e.DNE(24,Ce,2,2,"mat-option",9),e.k0s()()(),e.j41(25,"mat-form-field",11)(26,"mat-label"),e.EFF(27,"Search Topic"),e.k0s(),e.nrm(28,"input",12),e.j41(29,"mat-autocomplete",13,0),e.bIt("optionSelected",function(l){return e.eBV(s),e.Njj(o.onTopicSelected(l))}),e.DNE(31,Fe,2,2,"mat-option",9),e.nI1(32,"async"),e.k0s()()()(),e.DNE(33,ze,35,11,"mat-card",14)(34,He,7,0,"mat-card",15),e.k0s()}if(2&n){const s=e.sdS(30);e.R7$(4),e.Y8G("disabled",!o.selectedTopic),e.R7$(10),e.Y8G("formControl",o.categoryControl),e.R7$(3),e.Y8G("ngForOf",o.categories),e.R7$(4),e.Y8G("formControl",o.courseControl)("disabled",!o.categoryControl.value),e.R7$(3),e.Y8G("ngForOf",o.filteredCourses),e.R7$(4),e.Y8G("formControl",o.topicSearchControl)("matAutocomplete",s),e.R7$(),e.Y8G("displayWith",o.displayTopicFn),e.R7$(2),e.Y8G("ngForOf",e.bMT(32,12,o.filteredTopics)),e.R7$(2),e.Y8G("ngIf",o.selectedTopic),e.R7$(),e.Y8G("ngIf",!o.selectedTopic)}},dependencies:[g.MD,g.Sq,g.bT,g.Jj,g.PV,g.vh,x.tP,x.Zl,x.tL,x.ji,x.cC,x.YV,x.iL,x.KS,x.$R,x.YZ,x.NB,k.Hl,k.$z,k.iY,I.m_,I.An,_.Hu,_.RN,_.m2,_.MM,_.dh,C.RG,C.rl,C.nJ,w.Ve,w.VO,z.wT,M.jL,M.$3,M.pN,L.fS,L.fg,F.hM,$.YN,O.uc,O.oV,R._T,ve.mV,J.Ou,J.iy,m.X1,m.me,m.BC,m.l_],styles:[".container[_ngcontent-%COMP%]{padding:20px}.header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px}.full-width[_ngcontent-%COMP%]{width:100%}.filter-card[_ngcontent-%COMP%]{margin-bottom:20px}.filter-row[_ngcontent-%COMP%]{display:flex;gap:16px;margin-bottom:16px}.filter-field[_ngcontent-%COMP%]{flex:1}.topic-context[_ngcontent-%COMP%]{font-size:14px;color:#666;font-weight:400}.no-data[_ngcontent-%COMP%]{text-align:center;padding:40px;color:#666}.no-data[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:48px;height:48px;width:48px;margin-bottom:16px}.placeholder-card[_ngcontent-%COMP%]{margin-top:20px}.content-type-badge[_ngcontent-%COMP%]{padding:4px 8px;border-radius:12px;font-size:12px;font-weight:500}.content-type-video[_ngcontent-%COMP%]{background-color:#e3f2fd;color:#1976d2}.content-type-article[_ngcontent-%COMP%]{background-color:#f3e5f5;color:#7b1fa2}.content-type-quiz[_ngcontent-%COMP%]{background-color:#fff3e0;color:#f57c00}.content-type-exercise[_ngcontent-%COMP%]{background-color:#e8f5e8;color:#388e3c}"]})}return i})();function H(i){if(!i)return null;if(i instanceof Date)return i;if("string"==typeof i&&i.includes(",")){const t=i.split(",").map(Number);if(t.length>=3)return new Date(t[0],t[1]-1,t[2],t[3]||0,t[4]||0,t[5]||0)}const a=new Date(i);return isNaN(a.getTime())?null:a}let We=(()=>{class i{dialogRef;data;constructor(t,n){this.dialogRef=t,this.data=n}parseDate(t){return H(t)}static \u0275fac=function(n){return new(n||i)(e.rXU(F.CP),e.rXU(F.Vh))};static \u0275cmp=e.VBU({type:i,selectors:[["app-lesson-detail-dialog"]],standalone:!0,features:[e.aNF],decls:37,vars:14,consts:[["mat-dialog-title",""],[1,"dialog-content"],[1,"lesson-info"],[1,"info-row"],[1,"id-badge"],[1,"order-badge"],[1,"content-type-badge",3,"ngClass"],["class","info-row",4,"ngIf"],[1,"free-badge"],["class","lesson-content",4,"ngIf"],["align","end"],["mat-button","","mat-dialog-close",""],["target","_blank",1,"content-link",3,"href"],[1,"lesson-content"],[1,"content-text",3,"innerHTML"]],template:function(n,o){1&n&&(e.j41(0,"h2",0)(1,"mat-icon"),e.EFF(2,"visibility"),e.k0s(),e.EFF(3," Lesson Details "),e.k0s(),e.j41(4,"mat-dialog-content",1)(5,"div",2)(6,"div",3)(7,"strong"),e.EFF(8,"ID:"),e.k0s(),e.j41(9,"span",4),e.EFF(10),e.k0s()(),e.j41(11,"div",3)(12,"strong"),e.EFF(13,"Title:"),e.k0s(),e.EFF(14),e.k0s(),e.j41(15,"div",3)(16,"strong"),e.EFF(17,"Order:"),e.k0s(),e.j41(18,"span",5),e.EFF(19),e.k0s()(),e.j41(20,"div",3)(21,"strong"),e.EFF(22,"Content Type:"),e.k0s(),e.j41(23,"span",6),e.EFF(24),e.k0s()(),e.DNE(25,Xe,4,1,"div",7),e.j41(26,"div",3)(27,"strong"),e.EFF(28,"Free:"),e.k0s(),e.j41(29,"span",8),e.EFF(30),e.k0s()(),e.DNE(31,Ye,5,2,"div",7)(32,Ue,5,4,"div",7),e.k0s(),e.DNE(33,Qe,4,1,"div",9),e.k0s(),e.j41(34,"mat-dialog-actions",10)(35,"button",11),e.EFF(36,"Close"),e.k0s()()),2&n&&(e.R7$(10),e.JRh(o.data.lesson.lessonId),e.R7$(4),e.SpI(" ",o.data.lesson.title," "),e.R7$(5),e.JRh(o.data.lesson.orderNumber),e.R7$(4),e.Y8G("ngClass","content-type-"+o.data.lesson.contentType),e.R7$(),e.SpI(" ",o.data.lesson.contentType," "),e.R7$(),e.Y8G("ngIf",o.data.lesson.durationMinutes),e.R7$(4),e.AVh("is-free",o.data.lesson.isFree)("is-paid",!o.data.lesson.isFree),e.R7$(),e.SpI(" ",o.data.lesson.isFree?"Yes":"No"," "),e.R7$(),e.Y8G("ngIf",o.data.lesson.contentUrl),e.R7$(),e.Y8G("ngIf",o.data.lesson.createdAt),e.R7$(),e.Y8G("ngIf",o.data.lesson.description))},dependencies:[g.MD,g.YU,g.bT,g.vh,F.hM,F.tx,F.BI,F.E7,F.Yi,k.Hl,k.$z,I.m_,I.An,_.Hu],styles:[".dialog-content[_ngcontent-%COMP%]{max-height:70vh;overflow-y:auto}.lesson-info[_ngcontent-%COMP%]{margin-bottom:24px}.info-row[_ngcontent-%COMP%]{display:flex;align-items:center;margin-bottom:12px;gap:8px}.info-row[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{min-width:120px;color:#333}.id-badge[_ngcontent-%COMP%]{background-color:#e3f2fd;color:#1976d2;padding:4px 8px;border-radius:12px;font-size:12px;font-weight:500;font-family:Courier New,monospace}.order-badge[_ngcontent-%COMP%]{background-color:#fff3e0;color:#f57c00;padding:4px 8px;border-radius:12px;font-size:12px;font-weight:500}.content-type-badge[_ngcontent-%COMP%]{padding:4px 8px;border-radius:12px;font-size:12px;font-weight:500;text-transform:uppercase}.content-type-video[_ngcontent-%COMP%]{background-color:#e3f2fd;color:#1976d2}.content-type-article[_ngcontent-%COMP%]{background-color:#f3e5f5;color:#7b1fa2}.content-type-quiz[_ngcontent-%COMP%]{background-color:#fff3e0;color:#f57c00}.content-type-exercise[_ngcontent-%COMP%]{background-color:#e8f5e8;color:#388e3c}.free-badge[_ngcontent-%COMP%]{padding:4px 8px;border-radius:12px;font-size:12px;font-weight:500}.is-free[_ngcontent-%COMP%]{background-color:#e8f5e8;color:#2e7d32}.is-paid[_ngcontent-%COMP%]{background-color:#fff3e0;color:#f57c00}.content-link[_ngcontent-%COMP%]{color:#1976d2;text-decoration:none;word-break:break-all}.content-link[_ngcontent-%COMP%]:hover{text-decoration:underline}.lesson-content[_ngcontent-%COMP%]{margin-bottom:24px}.lesson-content[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin-bottom:12px;color:#333}.content-text[_ngcontent-%COMP%]{background-color:#f5f5f5;padding:16px;border-radius:4px;border-left:4px solid #2196f3;max-height:300px;overflow-y:auto}"]})}return i})();var E=c(467),ne=c(2765),oe=c(5024),X=c(8359);const ie=new e.nKC("CdkAccordion");let Je=0,Ze=(()=>{class i{get expanded(){return this._expanded}set expanded(t){this._expanded!==t&&(this._expanded=t,this.expandedChange.emit(t),t?(this.opened.emit(),this._expansionDispatcher.notify(this.id,this.accordion?this.accordion.id:this.id)):this.closed.emit(),this._changeDetectorRef.markForCheck())}constructor(t,n,o){this.accordion=t,this._changeDetectorRef=n,this._expansionDispatcher=o,this._openCloseAllSubscription=X.yU.EMPTY,this.closed=new e.bkB,this.opened=new e.bkB,this.destroyed=new e.bkB,this.expandedChange=new e.bkB,this.id="cdk-accordion-child-"+Je++,this._expanded=!1,this.disabled=!1,this._removeUniqueSelectionListener=()=>{},this._removeUniqueSelectionListener=o.listen((s,r)=>{this.accordion&&!this.accordion.multi&&this.accordion.id===r&&this.id!==s&&(this.expanded=!1)}),this.accordion&&(this._openCloseAllSubscription=this._subscribeToOpenCloseAllActions())}ngOnDestroy(){this.opened.complete(),this.closed.complete(),this.destroyed.emit(),this.destroyed.complete(),this._removeUniqueSelectionListener(),this._openCloseAllSubscription.unsubscribe()}toggle(){this.disabled||(this.expanded=!this.expanded)}close(){this.disabled||(this.expanded=!1)}open(){this.disabled||(this.expanded=!0)}_subscribeToOpenCloseAllActions(){return this.accordion._openCloseAllActions.subscribe(t=>{this.disabled||(this.expanded=t)})}static{this.\u0275fac=function(n){return new(n||i)(e.rXU(ie,12),e.rXU(e.gRc),e.rXU(oe.zP))}}static{this.\u0275dir=e.FsC({type:i,selectors:[["cdk-accordion-item"],["","cdkAccordionItem",""]],inputs:{expanded:[2,"expanded","expanded",e.L39],disabled:[2,"disabled","disabled",e.L39]},outputs:{closed:"closed",opened:"opened",destroyed:"destroyed",expandedChange:"expandedChange"},exportAs:["cdkAccordionItem"],standalone:!0,features:[e.Jv_([{provide:ie,useValue:void 0}]),e.GFd]})}}return i})(),et=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275mod=e.$C({type:i})}static{this.\u0275inj=e.G2t({})}}return i})();var Y=c(6939),tt=c(9888),D=c(5964),nt=c(6697),U=c(7336),ot=c(1413),it=c(983),st=c(7786),v=c(9969);const at=["body"],rt=[[["mat-expansion-panel-header"]],"*",[["mat-action-row"]]],lt=["mat-expansion-panel-header","*","mat-action-row"];function ct(i,a){}const dt=[[["mat-panel-title"]],[["mat-panel-description"]],"*"],pt=["mat-panel-title","mat-panel-description","*"];function ut(i,a){if(1&i&&(e.j41(0,"span",1),e.qSk(),e.j41(1,"svg",2),e.nrm(2,"path",3),e.k0s()()),2&i){const t=e.XpG();e.Y8G("@indicatorRotate",t._getExpandedState())}}const se=new e.nKC("MAT_ACCORDION"),ae="225ms cubic-bezier(0.4,0.0,0.2,1)",re={indicatorRotate:(0,v.hZ)("indicatorRotate",[(0,v.wk)("collapsed, void",(0,v.iF)({transform:"rotate(0deg)"})),(0,v.wk)("expanded",(0,v.iF)({transform:"rotate(180deg)"})),(0,v.kY)("expanded <=> collapsed, void => collapsed",(0,v.i0)(ae))]),bodyExpansion:(0,v.hZ)("bodyExpansion",[(0,v.wk)("collapsed, void",(0,v.iF)({height:"0px",visibility:"hidden"})),(0,v.wk)("expanded",(0,v.iF)({height:"*",visibility:""})),(0,v.kY)("expanded <=> collapsed, void => collapsed",(0,v.i0)(ae))])},le=new e.nKC("MAT_EXPANSION_PANEL");let mt=(()=>{class i{constructor(t,n){this._template=t,this._expansionPanel=n}static{this.\u0275fac=function(n){return new(n||i)(e.rXU(e.C4Q),e.rXU(le,8))}}static{this.\u0275dir=e.FsC({type:i,selectors:[["ng-template","matExpansionPanelContent",""]],standalone:!0})}}return i})(),ht=0;const ce=new e.nKC("MAT_EXPANSION_PANEL_DEFAULT_OPTIONS");let de=(()=>{class i extends Ze{get hideToggle(){return this._hideToggle||this.accordion&&this.accordion.hideToggle}set hideToggle(t){this._hideToggle=t}get togglePosition(){return this._togglePosition||this.accordion&&this.accordion.togglePosition}set togglePosition(t){this._togglePosition=t}constructor(t,n,o,s,r,l,u){super(t,n,o),this._viewContainerRef=s,this._animationMode=l,this._hideToggle=!1,this.afterExpand=new e.bkB,this.afterCollapse=new e.bkB,this._inputChanges=new ot.B,this._headerId="mat-expansion-panel-header-"+ht++,this.accordion=t,this._document=r,this._animationsDisabled="NoopAnimations"===l,u&&(this.hideToggle=u.hideToggle)}_hasSpacing(){return!!this.accordion&&this.expanded&&"default"===this.accordion.displayMode}_getExpandedState(){return this.expanded?"expanded":"collapsed"}toggle(){this.expanded=!this.expanded}close(){this.expanded=!1}open(){this.expanded=!0}ngAfterContentInit(){this._lazyContent&&this._lazyContent._expansionPanel===this&&this.opened.pipe((0,N.Z)(null),(0,D.p)(()=>this.expanded&&!this._portal),(0,nt.s)(1)).subscribe(()=>{this._portal=new Y.VA(this._lazyContent._template,this._viewContainerRef)})}ngOnChanges(t){this._inputChanges.next(t)}ngOnDestroy(){super.ngOnDestroy(),this._inputChanges.complete()}_containsFocus(){if(this._body){const t=this._document.activeElement,n=this._body.nativeElement;return t===n||n.contains(t)}return!1}_animationStarted(t){!pe(t)&&!this._animationsDisabled&&this._body&&this._body?.nativeElement.setAttribute("inert","")}_animationDone(t){pe(t)||("expanded"===t.toState?this.afterExpand.emit():"collapsed"===t.toState&&this.afterCollapse.emit(),!this._animationsDisabled&&this._body&&this._body.nativeElement.removeAttribute("inert"))}static{this.\u0275fac=function(n){return new(n||i)(e.rXU(se,12),e.rXU(e.gRc),e.rXU(oe.zP),e.rXU(e.c1b),e.rXU(g.qQ),e.rXU(e.bc$,8),e.rXU(ce,8))}}static{this.\u0275cmp=e.VBU({type:i,selectors:[["mat-expansion-panel"]],contentQueries:function(n,o,s){if(1&n&&e.wni(s,mt,5),2&n){let r;e.mGM(r=e.lsd())&&(o._lazyContent=r.first)}},viewQuery:function(n,o){if(1&n&&e.GBs(at,5),2&n){let s;e.mGM(s=e.lsd())&&(o._body=s.first)}},hostAttrs:[1,"mat-expansion-panel"],hostVars:6,hostBindings:function(n,o){2&n&&e.AVh("mat-expanded",o.expanded)("_mat-animation-noopable",o._animationsDisabled)("mat-expansion-panel-spacing",o._hasSpacing())},inputs:{hideToggle:[2,"hideToggle","hideToggle",e.L39],togglePosition:"togglePosition"},outputs:{afterExpand:"afterExpand",afterCollapse:"afterCollapse"},exportAs:["matExpansionPanel"],standalone:!0,features:[e.Jv_([{provide:se,useValue:void 0},{provide:le,useExisting:i}]),e.GFd,e.Vt3,e.OA$,e.aNF],ngContentSelectors:lt,decls:7,vars:4,consts:[["body",""],["role","region",1,"mat-expansion-panel-content",3,"id"],[1,"mat-expansion-panel-body"],[3,"cdkPortalOutlet"]],template:function(n,o){if(1&n){const s=e.RV6();e.NAR(rt),e.SdG(0),e.j41(1,"div",1,0),e.bIt("@bodyExpansion.start",function(l){return e.eBV(s),e.Njj(o._animationStarted(l))})("@bodyExpansion.done",function(l){return e.eBV(s),e.Njj(o._animationDone(l))}),e.j41(3,"div",2),e.SdG(4,1),e.DNE(5,ct,0,0,"ng-template",3),e.k0s(),e.SdG(6,2),e.k0s()}2&n&&(e.R7$(),e.Y8G("@bodyExpansion",o._getExpandedState())("id",o.id),e.BMQ("aria-labelledby",o._headerId),e.R7$(4),e.Y8G("cdkPortalOutlet",o._portal))},dependencies:[Y.I3],styles:['.mat-expansion-panel{box-sizing:content-box;display:block;margin:0;overflow:hidden;transition:margin 225ms cubic-bezier(0.4, 0, 0.2, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);position:relative;background:var(--mat-expansion-container-background-color, var(--mat-app-surface));color:var(--mat-expansion-container-text-color, var(--mat-app-on-surface));border-radius:var(--mat-expansion-container-shape)}.mat-expansion-panel:not([class*=mat-elevation-z]){box-shadow:0px 3px 1px -2px rgba(0, 0, 0, 0.2), 0px 2px 2px 0px rgba(0, 0, 0, 0.14), 0px 1px 5px 0px rgba(0, 0, 0, 0.12)}.mat-accordion .mat-expansion-panel:not(.mat-expanded),.mat-accordion .mat-expansion-panel:not(.mat-expansion-panel-spacing){border-radius:0}.mat-accordion .mat-expansion-panel:first-of-type{border-top-right-radius:var(--mat-expansion-container-shape);border-top-left-radius:var(--mat-expansion-container-shape)}.mat-accordion .mat-expansion-panel:last-of-type{border-bottom-right-radius:var(--mat-expansion-container-shape);border-bottom-left-radius:var(--mat-expansion-container-shape)}.cdk-high-contrast-active .mat-expansion-panel{outline:solid 1px}.mat-expansion-panel.ng-animate-disabled,.ng-animate-disabled .mat-expansion-panel,.mat-expansion-panel._mat-animation-noopable{transition:none}.mat-expansion-panel-content{display:flex;flex-direction:column;overflow:visible;font-family:var(--mat-expansion-container-text-font, var(--mat-app-body-large-font));font-size:var(--mat-expansion-container-text-size, var(--mat-app-body-large-size));font-weight:var(--mat-expansion-container-text-weight, var(--mat-app-body-large-weight));line-height:var(--mat-expansion-container-text-line-height, var(--mat-app-body-large-line-height));letter-spacing:var(--mat-expansion-container-text-tracking, var(--mat-app-body-large-tracking))}.mat-expansion-panel-content[style*="visibility: hidden"] *{visibility:hidden !important}.mat-expansion-panel-body{padding:0 24px 16px}.mat-expansion-panel-spacing{margin:16px 0}.mat-accordion>.mat-expansion-panel-spacing:first-child,.mat-accordion>*:first-child:not(.mat-expansion-panel) .mat-expansion-panel-spacing{margin-top:0}.mat-accordion>.mat-expansion-panel-spacing:last-child,.mat-accordion>*:last-child:not(.mat-expansion-panel) .mat-expansion-panel-spacing{margin-bottom:0}.mat-action-row{border-top-style:solid;border-top-width:1px;display:flex;flex-direction:row;justify-content:flex-end;padding:16px 8px 16px 24px;border-top-color:var(--mat-expansion-actions-divider-color, var(--mat-app-outline))}.mat-action-row .mat-button-base,.mat-action-row .mat-mdc-button-base{margin-left:8px}[dir=rtl] .mat-action-row .mat-button-base,[dir=rtl] .mat-action-row .mat-mdc-button-base{margin-left:0;margin-right:8px}'],encapsulation:2,data:{animation:[re.bodyExpansion]},changeDetection:0})}}return i})();function pe(i){return"void"===i.fromState}let gt=(()=>{class i{constructor(t,n,o,s,r,l,u){this.panel=t,this._element=n,this._focusMonitor=o,this._changeDetectorRef=s,this._animationMode=l,this._parentChangeSubscription=X.yU.EMPTY,this.tabIndex=0;const d=t.accordion?t.accordion._stateChanges.pipe((0,D.p)(h=>!(!h.hideToggle&&!h.togglePosition))):it.w;this.tabIndex=parseInt(u||"")||0,this._parentChangeSubscription=(0,st.h)(t.opened,t.closed,d,t._inputChanges.pipe((0,D.p)(h=>!!(h.hideToggle||h.disabled||h.togglePosition)))).subscribe(()=>this._changeDetectorRef.markForCheck()),t.closed.pipe((0,D.p)(()=>t._containsFocus())).subscribe(()=>o.focusVia(n,"program")),r&&(this.expandedHeight=r.expandedHeight,this.collapsedHeight=r.collapsedHeight)}get disabled(){return this.panel.disabled}_toggle(){this.disabled||this.panel.toggle()}_isExpanded(){return this.panel.expanded}_getExpandedState(){return this.panel._getExpandedState()}_getPanelId(){return this.panel.id}_getTogglePosition(){return this.panel.togglePosition}_showToggle(){return!this.panel.hideToggle&&!this.panel.disabled}_getHeaderHeight(){const t=this._isExpanded();return t&&this.expandedHeight?this.expandedHeight:!t&&this.collapsedHeight?this.collapsedHeight:null}_keydown(t){switch(t.keyCode){case U.t6:case U.Fm:(0,U.rp)(t)||(t.preventDefault(),this._toggle());break;default:return void(this.panel.accordion&&this.panel.accordion._handleHeaderKeydown(t))}}focus(t,n){t?this._focusMonitor.focusVia(this._element,t,n):this._element.nativeElement.focus(n)}ngAfterViewInit(){this._focusMonitor.monitor(this._element).subscribe(t=>{t&&this.panel.accordion&&this.panel.accordion._handleHeaderFocus(this)})}ngOnDestroy(){this._parentChangeSubscription.unsubscribe(),this._focusMonitor.stopMonitoring(this._element)}static{this.\u0275fac=function(n){return new(n||i)(e.rXU(de,1),e.rXU(e.aKT),e.rXU(tt.FN),e.rXU(e.gRc),e.rXU(ce,8),e.rXU(e.bc$,8),e.kS0("tabindex"))}}static{this.\u0275cmp=e.VBU({type:i,selectors:[["mat-expansion-panel-header"]],hostAttrs:["role","button",1,"mat-expansion-panel-header","mat-focus-indicator"],hostVars:15,hostBindings:function(n,o){1&n&&e.bIt("click",function(){return o._toggle()})("keydown",function(r){return o._keydown(r)}),2&n&&(e.BMQ("id",o.panel._headerId)("tabindex",o.disabled?-1:o.tabIndex)("aria-controls",o._getPanelId())("aria-expanded",o._isExpanded())("aria-disabled",o.panel.disabled),e.xc7("height",o._getHeaderHeight()),e.AVh("mat-expanded",o._isExpanded())("mat-expansion-toggle-indicator-after","after"===o._getTogglePosition())("mat-expansion-toggle-indicator-before","before"===o._getTogglePosition())("_mat-animation-noopable","NoopAnimations"===o._animationMode))},inputs:{expandedHeight:"expandedHeight",collapsedHeight:"collapsedHeight",tabIndex:[2,"tabIndex","tabIndex",t=>null==t?0:(0,e.Udg)(t)]},standalone:!0,features:[e.GFd,e.aNF],ngContentSelectors:pt,decls:5,vars:3,consts:[[1,"mat-content"],[1,"mat-expansion-indicator"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 -960 960 960","aria-hidden","true","focusable","false"],["d","M480-345 240-585l56-56 184 184 184-184 56 56-240 240Z"]],template:function(n,o){1&n&&(e.NAR(dt),e.j41(0,"span",0),e.SdG(1),e.SdG(2,1),e.SdG(3,2),e.k0s(),e.DNE(4,ut,3,1,"span",1)),2&n&&(e.AVh("mat-content-hide-toggle",!o._showToggle()),e.R7$(4),e.vxM(o._showToggle()?4:-1))},styles:['.mat-expansion-panel-header{display:flex;flex-direction:row;align-items:center;padding:0 24px;border-radius:inherit;transition:height 225ms cubic-bezier(0.4, 0, 0.2, 1);height:var(--mat-expansion-header-collapsed-state-height);font-family:var(--mat-expansion-header-text-font, var(--mat-app-title-medium-font));font-size:var(--mat-expansion-header-text-size, var(--mat-app-title-medium-size));font-weight:var(--mat-expansion-header-text-weight, var(--mat-app-title-medium-weight));line-height:var(--mat-expansion-header-text-line-height, var(--mat-app-title-medium-line-height));letter-spacing:var(--mat-expansion-header-text-tracking, var(--mat-app-title-medium-tracking))}.mat-expansion-panel-header.mat-expanded{height:var(--mat-expansion-header-expanded-state-height)}.mat-expansion-panel-header[aria-disabled=true]{color:var(--mat-expansion-header-disabled-state-text-color)}.mat-expansion-panel-header:not([aria-disabled=true]){cursor:pointer}.mat-expansion-panel:not(.mat-expanded) .mat-expansion-panel-header:not([aria-disabled=true]):hover{background:var(--mat-expansion-header-hover-state-layer-color)}@media(hover: none){.mat-expansion-panel:not(.mat-expanded) .mat-expansion-panel-header:not([aria-disabled=true]):hover{background:var(--mat-expansion-container-background-color, var(--mat-app-surface))}}.mat-expansion-panel .mat-expansion-panel-header:not([aria-disabled=true]).cdk-keyboard-focused,.mat-expansion-panel .mat-expansion-panel-header:not([aria-disabled=true]).cdk-program-focused{background:var(--mat-expansion-header-focus-state-layer-color)}.mat-expansion-panel-header._mat-animation-noopable{transition:none}.mat-expansion-panel-header:focus,.mat-expansion-panel-header:hover{outline:none}.mat-expansion-panel-header.mat-expanded:focus,.mat-expansion-panel-header.mat-expanded:hover{background:inherit}.mat-expansion-panel-header.mat-expansion-toggle-indicator-before{flex-direction:row-reverse}.mat-expansion-panel-header.mat-expansion-toggle-indicator-before .mat-expansion-indicator{margin:0 16px 0 0}[dir=rtl] .mat-expansion-panel-header.mat-expansion-toggle-indicator-before .mat-expansion-indicator{margin:0 0 0 16px}.mat-content{display:flex;flex:1;flex-direction:row;overflow:hidden}.mat-content.mat-content-hide-toggle{margin-right:8px}[dir=rtl] .mat-content.mat-content-hide-toggle{margin-right:0;margin-left:8px}.mat-expansion-toggle-indicator-before .mat-content.mat-content-hide-toggle{margin-left:24px;margin-right:0}[dir=rtl] .mat-expansion-toggle-indicator-before .mat-content.mat-content-hide-toggle{margin-right:24px;margin-left:0}.mat-expansion-panel-header-title{color:var(--mat-expansion-header-text-color, var(--mat-app-on-surface))}.mat-expansion-panel-header-title,.mat-expansion-panel-header-description{display:flex;flex-grow:1;flex-basis:0;margin-right:16px;align-items:center}[dir=rtl] .mat-expansion-panel-header-title,[dir=rtl] .mat-expansion-panel-header-description{margin-right:0;margin-left:16px}.mat-expansion-panel-header[aria-disabled=true] .mat-expansion-panel-header-title,.mat-expansion-panel-header[aria-disabled=true] .mat-expansion-panel-header-description{color:inherit}.mat-expansion-panel-header-description{flex-grow:2;color:var(--mat-expansion-header-description-color, var(--mat-app-on-surface-variant))}.mat-expansion-indicator::after{border-style:solid;border-width:0 2px 2px 0;content:"";display:inline-block;padding:3px;transform:rotate(45deg);vertical-align:middle;color:var(--mat-expansion-header-indicator-color, var(--mat-app-on-surface-variant));display:var(--mat-expansion-legacy-header-indicator-display, inline-block)}.mat-expansion-indicator svg{width:24px;height:24px;margin:0 -8px;vertical-align:middle;fill:var(--mat-expansion-header-indicator-color, var(--mat-app-on-surface-variant));display:var(--mat-expansion-header-indicator-display, none)}.cdk-high-contrast-active .mat-expansion-panel-content{border-top:1px solid;border-top-left-radius:0;border-top-right-radius:0}'],encapsulation:2,data:{animation:[re.indicatorRotate]},changeDetection:0})}}return i})(),ft=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275dir=e.FsC({type:i,selectors:[["mat-panel-description"]],hostAttrs:[1,"mat-expansion-panel-header-description"],standalone:!0})}}return i})(),yt=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275dir=e.FsC({type:i,selectors:[["mat-panel-title"]],hostAttrs:[1,"mat-expansion-panel-header-title"],standalone:!0})}}return i})(),vt=(()=>{class i{static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275mod=e.$C({type:i})}static{this.\u0275inj=e.G2t({imports:[z.yE,et,Y.jc]})}}return i})();var ue=c(1997),me=c(9183),B=c(7069),bt=c(345),he=c(1985),xt=c(6977);function S(i){i||((0,e.Af3)(S),i=(0,e.WQX)(e.abz));const a=new he.c(t=>i.onDestroy(t.next.bind(t)));return t=>t.pipe((0,xt.Q)(a))}var Et=c(9030),Tt=c(9350),It=c(7707),St=c(6648),ge=c(7468),jt=c(4402),j=c(3726),Pt=c(4668),fe=c(6354),At=c(8141),wt=c(1397);const Lt=[[["","above-quill-editor-toolbar",""]],[["","quill-editor-toolbar",""]],[["","below-quill-editor-toolbar",""]]],Ot=["[above-quill-editor-toolbar]","[quill-editor-toolbar]","[below-quill-editor-toolbar]"];function Rt(i,a){1&i&&e.nrm(0,"div",0)}function Nt(i,a){1&i&&e.nrm(0,"div",0)}const V=(i,a)=>i||a||"html";let Bt=(()=>{class i{constructor(){var t=this;this.config=(0,e.WQX)(B.bU)||{modules:B.Zv},this.document=(0,e.WQX)(g.qQ),this.quill$=(0,Et.v)((0,E.A)(function*(){if(!t.Quill){const n=t.document.addEventListener;t.document.addEventListener=t.document.__zone_symbol__addEventListener||t.document.addEventListener;const o=yield c.e(206).then(c.bind(c,1206));t.document.addEventListener=n,t.Quill=o.default?.default??o.default??o}return t.config.customOptions?.forEach(n=>{const o=t.Quill.import(n.import);o.whitelist=n.whitelist,t.Quill.register(o,!0,t.config.suppressGlobalRegisterWarning)}),function Mt(i,a){const t="object"==typeof a;return new Promise((n,o)=>{const s=new It.Ms({next:r=>{n(r),s.unsubscribe()},error:o,complete:()=>{t?n(a.defaultValue):o(new Tt.G)}});i.subscribe(s)})}(t.registerCustomModules(t.Quill,t.config.customModules,t.config.suppressGlobalRegisterWarning))})).pipe((0,Pt.t)({bufferSize:1,refCount:!1})),this.registeredModules=new Set}getQuill(){return this.quill$}beforeRender(t,n,o=this.config.beforeRender){const s=[this.registerCustomModules(t,n)];return o&&s.push((0,St.H)(o())),(0,ge.p)(s).pipe((0,fe.T)(()=>t))}registerCustomModules(t,n,o){if(!Array.isArray(n))return(0,y.of)(t);const s=[];for(const r of n){const{path:l,implementation:u}=r;this.registeredModules.has(l)||(this.registeredModules.add(l),(0,jt.A)(u)?s.push(u.pipe((0,At.M)(d=>{t.register(l,d,o)}))):t.register(l,u,o))}return s.length>0?(0,ge.p)(s).pipe((0,fe.T)(()=>t)):(0,y.of)(t)}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275prov=e.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})(),Vt=(()=>{class i{constructor(){this.format=(0,e.hFB)(void 0),this.theme=(0,e.hFB)(void 0),this.modules=(0,e.hFB)(void 0),this.debug=(0,e.hFB)(!1),this.readOnly=(0,e.hFB)(!1),this.placeholder=(0,e.hFB)(void 0),this.maxLength=(0,e.hFB)(void 0),this.minLength=(0,e.hFB)(void 0),this.required=(0,e.hFB)(!1),this.formats=(0,e.hFB)(void 0),this.customToolbarPosition=(0,e.hFB)("top"),this.sanitize=(0,e.hFB)(void 0),this.beforeRender=(0,e.hFB)(void 0),this.styles=(0,e.hFB)(null),this.registry=(0,e.hFB)(void 0),this.bounds=(0,e.hFB)(void 0),this.customOptions=(0,e.hFB)([]),this.customModules=(0,e.hFB)([]),this.trackChanges=(0,e.hFB)(void 0),this.classes=(0,e.hFB)(void 0),this.trimOnValidation=(0,e.hFB)(!1),this.linkPlaceholder=(0,e.hFB)(void 0),this.compareValues=(0,e.hFB)(!1),this.filterNull=(0,e.hFB)(!1),this.debounceTime=(0,e.hFB)(void 0),this.defaultEmptyValue=(0,e.hFB)(null),this.onEditorCreated=new e.bkB,this.onEditorChanged=new e.bkB,this.onContentChanged=new e.bkB,this.onSelectionChanged=new e.bkB,this.onFocus=new e.bkB,this.onBlur=new e.bkB,this.onNativeFocus=new e.bkB,this.onNativeBlur=new e.bkB,this.disabled=!1,this.toolbarPosition=(0,e.vPA)("top"),this.subscription=null,this.quillSubscription=null,this.elementRef=(0,e.WQX)(e.aKT),this.document=(0,e.WQX)(g.qQ),this.cd=(0,e.WQX)(e.gRc),this.domSanitizer=(0,e.WQX)(bt.up),this.platformId=(0,e.WQX)(e.Agw),this.renderer=(0,e.WQX)(e.sFG),this.zone=(0,e.WQX)(e.SKi),this.service=(0,e.WQX)(Bt),this.destroyRef=(0,e.WQX)(e.abz),this.valueGetter=(0,e.hFB)(t=>{let n=t.getSemanticHTML();this.isEmptyValue(n)&&(n=this.defaultEmptyValue());let o=n;const s=V(this.format(),this.service.config.format);if("text"===s)o=t.getText();else if("object"===s)o=t.getContents();else if("json"===s)try{o=JSON.stringify(t.getContents())}catch{o=t.getText()}return o}),this.valueSetter=(0,e.hFB)((t,n)=>{const o=V(this.format(),this.service.config.format);if("html"===o)return([!0,!1].includes(this.sanitize())?this.sanitize():this.service.config.sanitize||!1)&&(n=this.domSanitizer.sanitize(e.WPN.HTML,n)),t.clipboard.convert({html:n});if("json"===o)try{return JSON.parse(n)}catch{return[{insert:n}]}return n}),this.selectionChangeHandler=(t,n,o)=>{const s=this.trackChanges()||this.service.config.trackChanges,r=!t&&!!this.onModelTouched&&("user"===o||s&&"all"===s);!this.onBlur.observed&&!this.onFocus.observed&&!this.onSelectionChanged.observed&&!r||this.zone.run(()=>{null===t?this.onBlur.emit({editor:this.quillEditor,source:o}):null===n&&this.onFocus.emit({editor:this.quillEditor,source:o}),this.onSelectionChanged.emit({editor:this.quillEditor,oldRange:n,range:t,source:o}),r&&this.onModelTouched(),this.cd.markForCheck()})},this.textChangeHandler=(t,n,o)=>{const s=this.quillEditor.getText(),r=this.quillEditor.getContents();let l=this.quillEditor.getSemanticHTML();this.isEmptyValue(l)&&(l=this.defaultEmptyValue());const u=this.trackChanges()||this.service.config.trackChanges,d=("user"===o||u&&"all"===u)&&!!this.onModelChange;!this.onContentChanged.observed&&!d||this.zone.run(()=>{if(d){const h=this.valueGetter();this.onModelChange(h(this.quillEditor))}this.onContentChanged.emit({content:r,delta:t,editor:this.quillEditor,html:l,oldDelta:n,source:o,text:s}),this.cd.markForCheck()})},this.editorChangeHandler=(t,n,o,s)=>{if(this.onEditorChanged.observed)if("text-change"===t){const r=this.quillEditor.getText(),l=this.quillEditor.getContents();let u=this.quillEditor.getSemanticHTML();this.isEmptyValue(u)&&(u=this.defaultEmptyValue()),this.zone.run(()=>{this.onEditorChanged.emit({content:l,delta:n,editor:this.quillEditor,event:t,html:u,oldDelta:o,source:s,text:r}),this.cd.markForCheck()})}else this.zone.run(()=>{this.onEditorChanged.emit({editor:this.quillEditor,event:t,oldRange:o,range:n,source:s}),this.cd.markForCheck()})}}static normalizeClassNames(t){return t.trim().split(" ").reduce((o,s)=>{const r=s.trim();return r&&o.push(r),o},[])}ngOnInit(){this.toolbarPosition.set(this.customToolbarPosition())}ngAfterViewInit(){(0,g.Vy)(this.platformId)||(this.quillSubscription=this.service.getQuill().pipe((0,wt.Z)(t=>this.service.beforeRender(t,this.customModules(),this.beforeRender()))).subscribe(t=>{this.editorElem=this.elementRef.nativeElement.querySelector("[quill-editor-element]");const n=this.elementRef.nativeElement.querySelector("[quill-editor-toolbar]"),o=Object.assign({},this.modules()||this.service.config.modules);n?o.toolbar=n:void 0===o.toolbar&&(o.toolbar=B.Zv.toolbar);let s=void 0!==this.placeholder()?this.placeholder():this.service.config.placeholder;void 0===s&&(s="Insert text here ...");const r=this.styles();r&&Object.keys(r).forEach(p=>{this.renderer.setStyle(this.editorElem,p,r[p])}),this.classes()&&this.addClasses(this.classes()),this.customOptions().forEach(p=>{const f=t.import(p.import);f.whitelist=p.whitelist,t.register(f,!0)});let l=this.bounds()&&"self"===this.bounds()?this.editorElem:this.bounds();l||(l=this.service.config.bounds?this.service.config.bounds:this.document.body);let u=this.debug();!u&&!1!==u&&this.service.config.debug&&(u=this.service.config.debug);let d=this.readOnly();!d&&!1!==this.readOnly()&&(d=void 0!==this.service.config.readOnly&&this.service.config.readOnly);let h=this.formats();if(!h&&void 0===h&&(h=this.service.config.formats?[...this.service.config.formats]:null===this.service.config.formats?null:void 0),this.zone.runOutsideAngular(()=>{if(this.quillEditor=new t(this.editorElem,{bounds:l,debug:u,formats:h,modules:o,placeholder:s,readOnly:d,registry:this.registry(),theme:this.theme()||(this.service.config.theme?this.service.config.theme:"snow")}),this.onNativeBlur.observed){(0,j.R)(this.quillEditor.scroll.domNode,"blur").pipe(S(this.destroyRef)).subscribe(()=>this.onNativeBlur.next({editor:this.quillEditor,source:"dom"}));const p=this.quillEditor.getModule("toolbar");p.container&&(0,j.R)(p.container,"mousedown").pipe(S(this.destroyRef)).subscribe(f=>f.preventDefault())}if(this.onNativeFocus.observed&&(0,j.R)(this.quillEditor.scroll.domNode,"focus").pipe(S(this.destroyRef)).subscribe(()=>this.onNativeFocus.next({editor:this.quillEditor,source:"dom"})),this.linkPlaceholder()){const f=this.quillEditor?.theme?.tooltip?.root?.querySelector("input[data-link]");f?.dataset&&(f.dataset.link=this.linkPlaceholder())}}),this.content){if("text"===V(this.format(),this.service.config.format))this.quillEditor.setText(this.content,"silent");else{const b=this.valueSetter()(this.quillEditor,this.content);this.quillEditor.setContents(b,"silent")}this.quillEditor.getModule("history").clear()}this.setDisabledState(),this.addQuillEventListeners(),(this.onEditorCreated.observed||this.onValidatorChanged)&&new he.c(i=>{const a=requestAnimationFrame(()=>{i.next(),i.complete()});return()=>cancelAnimationFrame(a)}).pipe(S(this.destroyRef)).subscribe(()=>{this.onValidatorChanged&&this.onValidatorChanged(),this.onEditorCreated.emit(this.quillEditor)})}))}ngOnDestroy(){this.dispose(),this.quillSubscription?.unsubscribe(),this.quillSubscription=null}ngOnChanges(t){if(this.quillEditor){if(t.readOnly&&this.quillEditor.enable(!t.readOnly.currentValue),t.placeholder&&(this.quillEditor.root.dataset.placeholder=t.placeholder.currentValue),t.styles){const n=t.styles.currentValue,o=t.styles.previousValue;o&&Object.keys(o).forEach(s=>{this.renderer.removeStyle(this.editorElem,s)}),n&&Object.keys(n).forEach(s=>{this.renderer.setStyle(this.editorElem,s,this.styles()[s])})}if(t.classes){const n=t.classes.currentValue,o=t.classes.previousValue;o&&this.removeClasses(o),n&&this.addClasses(n)}t.debounceTime&&this.addQuillEventListeners()}}addClasses(t){i.normalizeClassNames(t).forEach(n=>{this.renderer.addClass(this.editorElem,n)})}removeClasses(t){i.normalizeClassNames(t).forEach(n=>{this.renderer.removeClass(this.editorElem,n)})}writeValue(t){if(this.filterNull()&&null===t||(this.content=t,!this.quillEditor))return;const n=V(this.format(),this.service.config.format),s=this.valueSetter()(this.quillEditor,t);if(this.compareValues()){const r=this.quillEditor.getContents();if(JSON.stringify(r)===JSON.stringify(s))return}t?"text"===n?this.quillEditor.setText(t):this.quillEditor.setContents(s):this.quillEditor.setText("")}setDisabledState(t=this.disabled){this.disabled=t,this.quillEditor&&(t?(this.quillEditor.disable(),this.renderer.setAttribute(this.elementRef.nativeElement,"disabled","disabled")):(this.readOnly()||this.quillEditor.enable(),this.renderer.removeAttribute(this.elementRef.nativeElement,"disabled")))}registerOnChange(t){this.onModelChange=t}registerOnTouched(t){this.onModelTouched=t}registerOnValidatorChange(t){this.onValidatorChanged=t}validate(){if(!this.quillEditor)return null;const t={};let n=!0;const o=this.quillEditor.getText(),s=this.trimOnValidation()?o.trim().length:1===o.length&&0===o.trim().length?0:o.length-1,r=this.quillEditor.getContents().ops,l=!!r&&1===r.length&&["\n",""].includes(r[0].insert?.toString());return this.minLength()&&s&&s<this.minLength()&&(t.minLengthError={given:s,minLength:this.minLength()},n=!1),this.maxLength()&&s>this.maxLength()&&(t.maxLengthError={given:s,maxLength:this.maxLength()},n=!1),this.required()&&!s&&l&&(t.requiredError={empty:!0},n=!1),n?null:t}addQuillEventListeners(){this.dispose(),this.zone.runOutsideAngular(()=>{this.subscription=new X.yU,this.subscription.add((0,j.R)(this.quillEditor,"selection-change").subscribe(([o,s,r])=>{this.selectionChangeHandler(o,s,r)}));let t=(0,j.R)(this.quillEditor,"text-change"),n=(0,j.R)(this.quillEditor,"editor-change");"number"==typeof this.debounceTime()&&(t=t.pipe((0,P.B)(this.debounceTime())),n=n.pipe((0,P.B)(this.debounceTime()))),this.subscription.add(t.subscribe(([o,s,r])=>{this.textChangeHandler(o,s,r)})),this.subscription.add(n.subscribe(([o,s,r,l])=>{this.editorChangeHandler(o,s,r,l)}))})}dispose(){null!==this.subscription&&(this.subscription.unsubscribe(),this.subscription=null)}isEmptyValue(t){return"<p></p>"===t||"<div></div>"===t||"<p><br></p>"===t||"<div><br></div>"===t}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275dir=e.FsC({type:i,inputs:{format:[1,"format"],theme:[1,"theme"],modules:[1,"modules"],debug:[1,"debug"],readOnly:[1,"readOnly"],placeholder:[1,"placeholder"],maxLength:[1,"maxLength"],minLength:[1,"minLength"],required:[1,"required"],formats:[1,"formats"],customToolbarPosition:[1,"customToolbarPosition"],sanitize:[1,"sanitize"],beforeRender:[1,"beforeRender"],styles:[1,"styles"],registry:[1,"registry"],bounds:[1,"bounds"],customOptions:[1,"customOptions"],customModules:[1,"customModules"],trackChanges:[1,"trackChanges"],classes:[1,"classes"],trimOnValidation:[1,"trimOnValidation"],linkPlaceholder:[1,"linkPlaceholder"],compareValues:[1,"compareValues"],filterNull:[1,"filterNull"],debounceTime:[1,"debounceTime"],defaultEmptyValue:[1,"defaultEmptyValue"],valueGetter:[1,"valueGetter"],valueSetter:[1,"valueSetter"]},outputs:{onEditorCreated:"onEditorCreated",onEditorChanged:"onEditorChanged",onContentChanged:"onContentChanged",onSelectionChanged:"onSelectionChanged",onFocus:"onFocus",onBlur:"onBlur",onNativeFocus:"onNativeFocus",onNativeBlur:"onNativeBlur"},features:[e.OA$]})}}return i})(),$t=(()=>{class i extends Vt{static{this.\u0275fac=(()=>{let t;return function(o){return(t||(t=e.xGo(i)))(o||i)}})()}static{this.\u0275cmp=e.VBU({type:i,selectors:[["quill-editor"]],standalone:!0,features:[e.Jv_([{multi:!0,provide:m.kq,useExisting:(0,e.Rfq)(()=>i)},{multi:!0,provide:m.cz,useExisting:(0,e.Rfq)(()=>i)}]),e.Vt3,e.aNF],ngContentSelectors:Ot,decls:5,vars:2,consts:[["quill-editor-element",""]],template:function(n,o){1&n&&(e.NAR(Lt),e.DNE(0,Rt,1,0,"div",0),e.SdG(1),e.SdG(2,1),e.SdG(3,2),e.DNE(4,Nt,1,0,"div",0)),2&n&&(e.vxM("top"!==o.toolbarPosition()?0:-1),e.R7$(4),e.vxM("top"===o.toolbarPosition()?4:-1))},styles:["[_nghost-%COMP%]{display:inline-block}"]})}}return i})(),Gt=(()=>{class i{static forRoot(t){return{ngModule:i,providers:[{provide:B.bU,useValue:t}]}}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275mod=e.$C({type:i})}static{this.\u0275inj=e.G2t({})}}return i})();var qt=c(2888),zt=c(5899),Ht=c(7640),Xt=c(6538);function Yt(i,a){1&i&&(e.j41(0,"div",7),e.nrm(1,"mat-spinner"),e.j41(2,"p"),e.EFF(3,"Loading lesson data..."),e.k0s()())}function Ut(i,a){if(1&i&&(e.j41(0,"mat-option",49),e.EFF(1),e.k0s()),2&i){const t=a.$implicit,n=e.XpG(2);e.Y8G("value",t),e.R7$(),e.SpI(" ",n.displayCourseFn(t)," ")}}function Qt(i,a){if(1&i&&(e.j41(0,"mat-option",49),e.EFF(1),e.k0s()),2&i){const t=a.$implicit,n=e.XpG(2);e.Y8G("value",t),e.R7$(),e.SpI(" ",n.displayTopicFn(t)," ")}}function Kt(i,a){1&i&&(e.j41(0,"mat-hint",50),e.EFF(1," Please select a course first to view available topics "),e.k0s())}function Wt(i,a){1&i&&(e.j41(0,"mat-error"),e.EFF(1," Topic selection is required "),e.k0s())}function Jt(i,a){1&i&&(e.j41(0,"mat-error"),e.EFF(1," Title is required "),e.k0s())}function Zt(i,a){1&i&&(e.j41(0,"mat-error"),e.EFF(1," Content type is required "),e.k0s())}function en(i,a){1&i&&(e.j41(0,"mat-form-field",11)(1,"mat-label"),e.EFF(2,"Order Number"),e.k0s(),e.nrm(3,"input",51),e.j41(4,"mat-hint"),e.EFF(5,"Position of this lesson within the topic"),e.k0s()())}function tn(i,a){1&i&&(e.j41(0,"mat-chip",106)(1,"mat-icon"),e.EFF(2,"star"),e.k0s(),e.EFF(3," Important "),e.k0s())}function nn(i,a){1&i&&(e.j41(0,"mat-error"),e.EFF(1," Title is required "),e.k0s())}function on(i,a){1&i&&(e.j41(0,"mat-error"),e.EFF(1," Content type is required "),e.k0s())}function sn(i,a){1&i&&(e.j41(0,"div",107),e.EFF(1," Content is required "),e.k0s())}function an(i,a){1&i&&(e.j41(0,"mat-form-field",11)(1,"mat-label"),e.EFF(2,"Visual Aid URL"),e.k0s(),e.nrm(3,"input",108),e.j41(4,"mat-hint"),e.EFF(5,"URL to an image, diagram, or visual aid"),e.k0s()())}function rn(i,a){if(1&i&&(e.j41(0,"mat-option",49),e.EFF(1),e.k0s()),2&i){const t=a.$implicit;e.Y8G("value",t.tagId),e.R7$(),e.SpI(" ",t.tagName," ")}}function ln(i,a){1&i&&(e.j41(0,"mat-error"),e.EFF(1," Tag selection is required "),e.k0s())}function cn(i,a){if(1&i){const t=e.RV6();e.j41(0,"div",109)(1,"mat-form-field",110)(2,"mat-label"),e.EFF(3,"Tag"),e.k0s(),e.j41(4,"mat-select",111),e.DNE(5,rn,2,2,"mat-option",14),e.k0s(),e.DNE(6,ln,2,0,"mat-error",20),e.k0s(),e.j41(7,"mat-form-field",112)(8,"mat-label"),e.EFF(9,"Relevance Score"),e.k0s(),e.nrm(10,"input",113),e.j41(11,"mat-hint"),e.EFF(12,"1-10 scale"),e.k0s()(),e.j41(13,"button",114),e.bIt("click",function(){const o=e.eBV(t).index,s=e.XpG().index,r=e.XpG(2);return e.Njj(r.removeKeynoteTag(s,o))}),e.j41(14,"mat-icon"),e.EFF(15,"delete"),e.k0s()()()}if(2&i){let t;const n=a.$implicit,o=a.index,s=e.XpG(3);e.Y8G("formGroupName",o),e.R7$(5),e.Y8G("ngForOf",s.allTags),e.R7$(),e.Y8G("ngIf",null==(t=n.get("tagId"))?null:t.hasError("required"))}}function dn(i,a){1&i&&(e.j41(0,"div",115)(1,"mat-icon"),e.EFF(2,"local_offer_outlined"),e.k0s(),e.j41(3,"span"),e.EFF(4,"No tags added to this keynote yet."),e.k0s()())}function pn(i,a){if(1&i){const t=e.RV6();e.j41(0,"mat-expansion-panel",52)(1,"mat-expansion-panel-header")(2,"mat-panel-title")(3,"div",53)(4,"mat-icon",54),e.EFF(5,"note_alt"),e.k0s(),e.j41(6,"span",55),e.EFF(7),e.k0s(),e.DNE(8,tn,4,0,"mat-chip",56),e.j41(9,"mat-chip",57),e.EFF(10),e.k0s()()(),e.j41(11,"mat-panel-description")(12,"span",58),e.EFF(13),e.k0s()()(),e.j41(14,"div",59)(15,"mat-form-field",11)(16,"mat-label"),e.EFF(17,"Title"),e.k0s(),e.nrm(18,"input",60),e.DNE(19,nn,2,0,"mat-error",20),e.k0s(),e.j41(20,"mat-form-field",11)(21,"mat-label"),e.EFF(22,"Content Type"),e.k0s(),e.j41(23,"mat-select",26)(24,"mat-option",61),e.EFF(25,"Text"),e.k0s(),e.j41(26,"mat-option",62),e.EFF(27,"Bullet Points"),e.k0s(),e.j41(28,"mat-option",63),e.EFF(29,"Quote"),e.k0s(),e.j41(30,"mat-option",64),e.EFF(31,"Example"),e.k0s()(),e.DNE(32,on,2,0,"mat-error",20),e.k0s(),e.j41(33,"div",65)(34,"label",23),e.EFF(35,"Content"),e.k0s(),e.j41(36,"div",66),e.nrm(37,"quill-editor",67),e.k0s(),e.j41(38,"div",68),e.EFF(39),e.k0s(),e.DNE(40,sn,2,0,"div",69),e.k0s(),e.j41(41,"div",70)(42,"mat-checkbox",71),e.EFF(43," Mark as Important "),e.k0s(),e.j41(44,"mat-checkbox",72),e.EFF(45," Has Visual Aid "),e.k0s()(),e.DNE(46,an,6,0,"mat-form-field",33),e.j41(47,"div",70)(48,"mat-form-field",73)(49,"mat-label"),e.EFF(50,"Related Planet"),e.k0s(),e.j41(51,"mat-select",74)(52,"mat-option",75),e.EFF(53,"None"),e.k0s(),e.j41(54,"mat-option",76),e.EFF(55,"Sun"),e.k0s(),e.j41(56,"mat-option",77),e.EFF(57,"Moon"),e.k0s(),e.j41(58,"mat-option",78),e.EFF(59,"Mars"),e.k0s(),e.j41(60,"mat-option",79),e.EFF(61,"Mercury"),e.k0s(),e.j41(62,"mat-option",80),e.EFF(63,"Jupiter"),e.k0s(),e.j41(64,"mat-option",81),e.EFF(65,"Venus"),e.k0s(),e.j41(66,"mat-option",82),e.EFF(67,"Saturn"),e.k0s(),e.j41(68,"mat-option",83),e.EFF(69,"Rahu"),e.k0s(),e.j41(70,"mat-option",84),e.EFF(71,"Ketu"),e.k0s()()(),e.j41(72,"mat-form-field",73)(73,"mat-label"),e.EFF(74,"Related Zodiac"),e.k0s(),e.j41(75,"mat-select",85)(76,"mat-option",75),e.EFF(77,"None"),e.k0s(),e.j41(78,"mat-option",86),e.EFF(79,"Aries"),e.k0s(),e.j41(80,"mat-option",87),e.EFF(81,"Taurus"),e.k0s(),e.j41(82,"mat-option",88),e.EFF(83,"Gemini"),e.k0s(),e.j41(84,"mat-option",89),e.EFF(85,"Cancer"),e.k0s(),e.j41(86,"mat-option",90),e.EFF(87,"Leo"),e.k0s(),e.j41(88,"mat-option",91),e.EFF(89,"Virgo"),e.k0s(),e.j41(90,"mat-option",92),e.EFF(91,"Libra"),e.k0s(),e.j41(92,"mat-option",93),e.EFF(93,"Scorpio"),e.k0s(),e.j41(94,"mat-option",94),e.EFF(95,"Sagittarius"),e.k0s(),e.j41(96,"mat-option",95),e.EFF(97,"Capricorn"),e.k0s(),e.j41(98,"mat-option",96),e.EFF(99,"Aquarius"),e.k0s(),e.j41(100,"mat-option",97),e.EFF(101,"Pisces"),e.k0s()()()(),e.j41(102,"div",98)(103,"div",36)(104,"h4",99)(105,"mat-icon"),e.EFF(106,"local_offer"),e.k0s(),e.EFF(107," Keynote Tags "),e.k0s(),e.j41(108,"button",100),e.bIt("click",function(){const o=e.eBV(t).index,s=e.XpG(2);return e.Njj(s.addKeynoteTag(o))}),e.j41(109,"mat-icon"),e.EFF(110,"add"),e.k0s(),e.EFF(111," Add Tag "),e.k0s()(),e.j41(112,"div",101),e.DNE(113,cn,16,3,"div",102)(114,dn,5,0,"div",103),e.k0s()(),e.j41(115,"div",104)(116,"button",105),e.bIt("click",function(){const o=e.eBV(t).index,s=e.XpG(2);return e.Njj(s.removeKeynote(o))}),e.j41(117,"mat-icon"),e.EFF(118,"delete"),e.k0s(),e.EFF(119," Remove "),e.k0s()()()()}if(2&i){let t,n,o,s,r,l,u,d,h,p,f,Q;const b=a.$implicit,K=a.index,T=e.XpG(2);e.Y8G("formGroupName",K)("expanded",null==(t=b.get("isNew"))?null:t.value),e.R7$(7),e.SpI(" ",(null==(n=b.get("title"))?null:n.value)||"New Keynote"," "),e.R7$(),e.Y8G("ngIf",null==(o=b.get("isImportant"))?null:o.value),e.R7$(),e.Y8G("ngClass","content-type-"+(null==(s=b.get("contentType"))?null:s.value)),e.R7$(),e.SpI(" ",T.getContentTypeLabel(null==(r=b.get("contentType"))?null:r.value)," "),e.R7$(3),e.SpI(" ",T.getKeynotePreview(null==(l=b.get("content"))?null:l.value)," "),e.R7$(6),e.Y8G("ngIf",null==(u=b.get("title"))?null:u.hasError("required")),e.R7$(13),e.Y8G("ngIf",null==(d=b.get("contentType"))?null:d.hasError("required")),e.R7$(5),e.Y8G("modules",T.quillModules)("placeholder",T.getContentPlaceholder(null==(h=b.get("contentType"))?null:h.value)),e.R7$(2),e.JRh(T.getContentHint(null==(p=b.get("contentType"))?null:p.value)),e.R7$(),e.Y8G("ngIf",null==(f=b.get("content"))?null:f.hasError("required")),e.R7$(6),e.Y8G("ngIf",null==(Q=b.get("hasVisualAid"))?null:Q.value),e.R7$(67),e.Y8G("ngForOf",T.getKeynoteTags(K).controls),e.R7$(),e.Y8G("ngIf",0===T.getKeynoteTags(K).length)}}function un(i,a){1&i&&(e.j41(0,"div",116)(1,"mat-icon"),e.EFF(2,"note_add"),e.k0s(),e.j41(3,"p"),e.EFF(4,'No keynotes added yet. Click "Add Keynote" to get started.'),e.k0s()())}function mn(i,a){if(1&i&&(e.j41(0,"mat-option",49),e.EFF(1),e.k0s()),2&i){const t=a.$implicit;e.Y8G("value",t.tagId),e.R7$(),e.SpI(" ",t.tagName," ")}}function hn(i,a){1&i&&(e.j41(0,"mat-error"),e.EFF(1," Tag selection is required "),e.k0s())}function gn(i,a){if(1&i){const t=e.RV6();e.j41(0,"div",117)(1,"mat-form-field",11)(2,"mat-label"),e.EFF(3,"Tag"),e.k0s(),e.j41(4,"mat-select",111),e.DNE(5,mn,2,2,"mat-option",14),e.k0s(),e.DNE(6,hn,2,0,"mat-error",20),e.k0s(),e.j41(7,"mat-form-field",11)(8,"mat-label"),e.EFF(9,"Relevance Score"),e.k0s(),e.nrm(10,"input",118),e.j41(11,"mat-hint"),e.EFF(12,"Enter a score from 1-10 indicating relevance to the lesson"),e.k0s()(),e.j41(13,"div",119)(14,"button",120),e.bIt("click",function(){const o=e.eBV(t).index,s=e.XpG(2);return e.Njj(s.saveTag(o))}),e.j41(15,"mat-icon"),e.EFF(16,"save"),e.k0s()(),e.j41(17,"button",121),e.bIt("click",function(){const o=e.eBV(t).index,s=e.XpG(2);return e.Njj(s.removeTag(o))}),e.j41(18,"mat-icon"),e.EFF(19,"delete"),e.k0s(),e.EFF(20," Remove "),e.k0s()()()}if(2&i){let t;const n=a.$implicit,o=a.index,s=e.XpG(2);e.Y8G("formGroupName",o),e.R7$(5),e.Y8G("ngForOf",s.allTags),e.R7$(),e.Y8G("ngIf",null==(t=n.get("tagId"))?null:t.hasError("required"))}}function fn(i,a){1&i&&(e.j41(0,"div",122)(1,"mat-icon"),e.EFF(2,"label_off"),e.k0s(),e.j41(3,"p"),e.EFF(4,'No tags added yet. Click "Add Tag" to get started.'),e.k0s()())}function yn(i,a){1&i&&e.nrm(0,"mat-spinner",123)}function vn(i,a){if(1&i&&(e.j41(0,"span"),e.EFF(1),e.k0s()),2&i){const t=e.XpG(2);e.R7$(),e.SpI(" with ",t.keynotes.length," Keynote(s)")}}function bn(i,a){if(1&i){const t=e.RV6();e.j41(0,"form",8),e.bIt("ngSubmit",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.onSubmit())}),e.j41(1,"div",9)(2,"h3",10)(3,"mat-icon"),e.EFF(4,"info"),e.k0s(),e.EFF(5," Lesson Information "),e.k0s(),e.j41(6,"mat-form-field",11)(7,"mat-label"),e.EFF(8,"Search Course"),e.k0s(),e.nrm(9,"input",12),e.j41(10,"mat-autocomplete",13,0),e.bIt("optionSelected",function(o){e.eBV(t);const s=e.XpG();return e.Njj(s.onCourseSelected(o))}),e.DNE(12,Ut,2,2,"mat-option",14),e.nI1(13,"async"),e.k0s(),e.j41(14,"mat-icon",15),e.EFF(15,"school"),e.k0s(),e.j41(16,"mat-hint"),e.EFF(17,"Select a course to filter topics"),e.k0s()(),e.j41(18,"mat-form-field",11)(19,"mat-label"),e.EFF(20,"Course ID"),e.k0s(),e.nrm(21,"input",16),e.j41(22,"mat-hint"),e.EFF(23,"Selected from course search above"),e.k0s()(),e.j41(24,"mat-form-field",11)(25,"mat-label"),e.EFF(26,"Search Topic"),e.k0s(),e.nrm(27,"input",17),e.j41(28,"mat-autocomplete",13,1),e.bIt("optionSelected",function(o){e.eBV(t);const s=e.XpG();return e.Njj(s.onTopicSelected(o))}),e.DNE(30,Qt,2,2,"mat-option",14),e.nI1(31,"async"),e.k0s(),e.j41(32,"mat-icon",15),e.EFF(33,"search"),e.k0s(),e.DNE(34,Kt,2,0,"mat-hint",18),e.k0s(),e.j41(35,"mat-form-field",11)(36,"mat-label"),e.EFF(37,"Topic ID"),e.k0s(),e.nrm(38,"input",19),e.j41(39,"mat-hint"),e.EFF(40,"Selected from topic search above"),e.k0s(),e.DNE(41,Wt,2,0,"mat-error",20),e.k0s(),e.j41(42,"mat-form-field",11)(43,"mat-label"),e.EFF(44,"Title"),e.k0s(),e.nrm(45,"input",21),e.DNE(46,Jt,2,0,"mat-error",20),e.k0s(),e.j41(47,"div",22)(48,"label",23),e.EFF(49,"Description"),e.k0s(),e.j41(50,"div",24),e.nrm(51,"quill-editor",25),e.k0s()(),e.j41(52,"mat-form-field",11)(53,"mat-label"),e.EFF(54,"Content Type"),e.k0s(),e.j41(55,"mat-select",26)(56,"mat-option",27),e.EFF(57,"Video"),e.k0s(),e.j41(58,"mat-option",28),e.EFF(59,"Article"),e.k0s(),e.j41(60,"mat-option",29),e.EFF(61,"Quiz"),e.k0s(),e.j41(62,"mat-option",30),e.EFF(63,"Exercise"),e.k0s()(),e.DNE(64,Zt,2,0,"mat-error",20),e.k0s(),e.j41(65,"mat-form-field",11)(66,"mat-label"),e.EFF(67,"Content URL"),e.k0s(),e.nrm(68,"input",31),e.j41(69,"mat-hint"),e.EFF(70,"URL to the lesson content (video, article, etc.)"),e.k0s()(),e.j41(71,"mat-form-field",11)(72,"mat-label"),e.EFF(73,"Duration (minutes)"),e.k0s(),e.nrm(74,"input",32),e.j41(75,"mat-hint"),e.EFF(76,"Estimated time to complete this lesson"),e.k0s()(),e.DNE(77,en,6,0,"mat-form-field",33),e.j41(78,"div",34)(79,"mat-checkbox",35)(80,"strong"),e.EFF(81,"Free lesson"),e.k0s(),e.EFF(82," (accessible without payment) "),e.k0s()()(),e.nrm(83,"mat-divider"),e.j41(84,"div",9)(85,"div",36)(86,"h3",10)(87,"mat-icon"),e.EFF(88,"note_alt"),e.k0s(),e.EFF(89," Lesson Keynotes "),e.k0s(),e.j41(90,"button",37),e.bIt("click",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.addKeynote())}),e.j41(91,"mat-icon"),e.EFF(92,"add"),e.k0s(),e.EFF(93," Add Keynote "),e.k0s()(),e.j41(94,"div",38),e.DNE(95,pn,120,16,"mat-expansion-panel",39)(96,un,5,0,"div",40),e.k0s()(),e.nrm(97,"mat-divider"),e.j41(98,"div",9)(99,"div",36)(100,"h3",10)(101,"mat-icon"),e.EFF(102,"label"),e.k0s(),e.EFF(103," Lesson Tags "),e.k0s(),e.j41(104,"button",41),e.bIt("click",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.addTag())}),e.j41(105,"mat-icon"),e.EFF(106,"add"),e.k0s(),e.EFF(107," Add Tag "),e.k0s()(),e.j41(108,"div",42),e.DNE(109,gn,21,3,"div",43)(110,fn,5,0,"div",44),e.k0s()(),e.nrm(111,"mat-divider"),e.j41(112,"div",45)(113,"button",46),e.bIt("click",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.goBack())}),e.EFF(114," Cancel "),e.k0s(),e.j41(115,"button",47),e.DNE(116,yn,1,0,"mat-spinner",48),e.EFF(117),e.DNE(118,vn,2,1,"span",20),e.k0s()()()}if(2&i){let t,n,o,s,r;const l=e.sdS(11),u=e.sdS(29),d=e.XpG();e.Y8G("formGroup",d.lessonForm),e.R7$(9),e.Y8G("matAutocomplete",l),e.R7$(),e.Y8G("displayWith",d.displayCourseFn),e.R7$(2),e.Y8G("ngForOf",e.bMT(13,22,d.filteredCourses)),e.R7$(15),e.Y8G("matAutocomplete",u)("disabled",!(null!=(t=d.lessonForm.get("courseId"))&&t.value)),e.R7$(),e.Y8G("displayWith",d.displayTopicFn),e.R7$(2),e.Y8G("ngForOf",e.bMT(31,24,d.filteredTopics)),e.R7$(4),e.Y8G("ngIf",!(null!=(n=d.lessonForm.get("courseId"))&&n.value)),e.R7$(7),e.Y8G("ngIf",null==(o=d.lessonForm.get("topicId"))?null:o.hasError("required")),e.R7$(5),e.Y8G("ngIf",null==(s=d.lessonForm.get("title"))?null:s.hasError("required")),e.R7$(5),e.Y8G("modules",d.quillModules),e.R7$(13),e.Y8G("ngIf",null==(r=d.lessonForm.get("contentType"))?null:r.hasError("required")),e.R7$(13),e.Y8G("ngIf",d.isEditMode),e.R7$(18),e.Y8G("ngForOf",d.keynotes.controls),e.R7$(),e.Y8G("ngIf",0===d.keynotes.length),e.R7$(13),e.Y8G("ngForOf",d.tags.controls),e.R7$(),e.Y8G("ngIf",0===d.tags.length),e.R7$(5),e.Y8G("disabled",d.lessonForm.invalid||d.submitting),e.R7$(),e.Y8G("ngIf",d.submitting),e.R7$(),e.SpI(" ",d.submitting?d.isEditMode?"Updating...":"Creating...":d.isEditMode?"Update":"Create"," Lesson "),e.R7$(),e.Y8G("ngIf",d.keynotes.length>0&&!d.submitting)}}let ye=(()=>{class i{lessonForm;filteredTopics=(0,y.of)([]);filteredCourses=(0,y.of)([]);isEditMode=!1;lessonId=null;allTags=[];allCourses=[];loading=!1;submitting=!1;quillModules={toolbar:[["bold","italic","underline","strike"],["blockquote","code-block"],[{header:1},{header:2}],[{list:"ordered"},{list:"bullet"}],[{script:"sub"},{script:"super"}],[{indent:"-1"},{indent:"+1"}],[{direction:"rtl"}],[{size:["small",!1,"large","huge"]}],[{header:[1,2,3,4,5,6,!1]}],[{color:[]},{background:[]}],[{font:[]}],[{align:[]}],["clean"],["link"]]};fb=(0,e.WQX)(m.ok);lessonService=(0,e.WQX)(Z.u);topicService=(0,e.WQX)(ee.h);courseService=(0,e.WQX)(te.f);keynoteService=(0,e.WQX)(qt.B);router=(0,e.WQX)(q.Ix);route=(0,e.WQX)(q.nX);snackBar=(0,e.WQX)(R.UG);lessonTagService=(0,e.WQX)(zt.E);keynoteTagService=(0,e.WQX)(Ht.Z);tagService=(0,e.WQX)(Xt.w);constructor(){this.lessonForm=this.fb.group({title:["",m.k0.required],description:[""],courseId:[""],courseSearch:[""],topicId:["",m.k0.required],topicSearch:[""],contentType:["",m.k0.required],contentUrl:[""],durationMinutes:[""],orderNumber:[1],isFree:[!1],tags:this.fb.array([]),keynotes:this.fb.array([])})}get tags(){return this.lessonForm.get("tags")}get keynotes(){return this.lessonForm.get("keynotes")}ngOnInit(){this.setupCourseAutocomplete(),this.setupTopicAutocomplete(),this.checkEditMode(),this.loadAllTags(),this.loadAllCourses(),this.handleNavigationState()}handleNavigationState(){const n=this.router.getCurrentNavigation()?.extras?.state||window.history.state;if(n&&n.selectedTopic&&!this.isEditMode){const o=n.selectedTopic;this.courseService.getCourseById(o.courseId).subscribe({next:s=>{this.lessonForm.patchValue({courseId:o.courseId,courseSearch:s,topicId:o.topicId,topicSearch:o})},error:()=>{console.error("Error loading course for selected topic")}})}}setupCourseAutocomplete(){this.filteredCourses=this.lessonForm.get("courseSearch").valueChanges.pipe((0,N.Z)(""),(0,P.B)(300),(0,G.F)(),(0,A.n)(t=>this._filterCourses(t)))}setupTopicAutocomplete(){this.filteredTopics=this.lessonForm.get("topicSearch").valueChanges.pipe((0,N.Z)(""),(0,P.B)(300),(0,G.F)(),(0,A.n)(t=>this._filterTopics(t)))}_filterCourses(t){if("string"!=typeof t)return(0,y.of)([]);if(!t||""===t.trim())return this.courseService.getAllCourses();const n=t.toLowerCase();return this.courseService.getAllCourses().pipe((0,A.n)(o=>(0,y.of)(o.filter(s=>s.title.toLowerCase().includes(n)))))}_filterTopics(t){if("string"!=typeof t)return(0,y.of)([]);const n=this.lessonForm.get("courseId")?.value;return n?this.topicService.getTopicsByCourseId(n).pipe((0,A.n)(o=>{if(!t||""===t.trim())return(0,y.of)(o);const s=t.toLowerCase();return(0,y.of)(o.filter(r=>r.title.toLowerCase().includes(s)))})):(0,y.of)([])}displayCourseFn=t=>t?`${t.title} (ID: ${t.courseId})`:"";displayTopicFn=t=>t?`${t.title} (ID: ${t.topicId})`:"";onCourseSelected(t){this.lessonForm.patchValue({courseId:t.option.value.courseId,topicId:"",topicSearch:""}),this.lessonForm.get("topicSearch")?.updateValueAndValidity()}onTopicSelected(t){this.lessonForm.patchValue({topicId:t.option.value.topicId})}loadAllCourses(){this.courseService.getAllCourses().subscribe({next:t=>{this.allCourses=t},error:t=>{console.error("Error loading courses:",t),this.snackBar.open("Error loading courses","Close",{duration:3e3})}})}addKeynote(){const t=this.fb.group({title:["",m.k0.required],content:["",m.k0.required],contentType:["text",m.k0.required],isImportant:[!1],hasVisualAid:[!1],visualAidUrl:[""],relatedPlanet:[""],relatedZodiac:[""],keynoteTags:this.fb.array([]),isNew:[!0]});this.keynotes.push(t)}removeKeynote(t){this.keynotes.removeAt(t)}addTag(){const t=this.fb.group({lessonTagId:[null],tagId:[null,m.k0.required],tagName:[""],relevanceScore:[1]});this.tags.push(t)}removeTag(t){var n=this;return(0,E.A)(function*(){const s=n.tags.at(t).value;if(s.lessonTagId)try{yield n.lessonTagService.deleteLessonTag(s.lessonTagId).toPromise(),n.snackBar.open("Tag deleted successfully.","Close",{duration:2e3}),n.loadTags()}catch(r){let l="Failed to delete tag. Please try again.";r&&r.error&&r.error.message?l=r.error.message:r&&r.message&&(l=r.message),n.snackBar.open(l,"Close",{duration:5e3}),console.error("Error deleting tag:",r)}else n.tags.removeAt(t)})()}getKeynoteTags(t){return this.keynotes.at(t).get("keynoteTags")}addKeynoteTag(t){const n=this.fb.group({keynoteTagId:[null],tagId:[null,m.k0.required],relevanceScore:[5]});this.getKeynoteTags(t).push(n)}removeKeynoteTag(t,n){this.getKeynoteTags(t).removeAt(n)}getContentTypeLabel(t){switch(t){case"text":return"Text";case"bullet_points":return"Bullet Points";case"quote":return"Quote";case"example":return"Example";default:return t||"Text"}}getKeynotePreview(t){if(!t)return"No content";const n=t.replace(/<[^>]*>/g,"");return n.length>50?n.substring(0,50)+"...":n}getContentPlaceholder(t){switch(t){case"bullet_points":return"Enter bullet points, one per line:\n\u2022 Point 1\n\u2022 Point 2\n\u2022 Point 3";case"quote":return"Enter the quote text...";case"example":return"Provide a detailed example...";default:return"Enter the keynote content..."}}getContentHint(t){switch(t){case"bullet_points":return"Use bullet points (\u2022), dashes (-), or asterisks (*) to separate points";case"quote":return"Inspirational or educational quotes related to the lesson";case"example":return"Practical examples that illustrate the lesson concepts";default:return"General text content for the keynote"}}checkEditMode(){const t=this.route.snapshot.paramMap.get("id");if(t){const n=parseInt(t,10);!isNaN(n)&&n>0?(this.isEditMode=!0,this.lessonId=n,console.log("Edit mode enabled for lessonId:",this.lessonId),this.loadLesson()):(console.error("Invalid lesson ID in route:",t),this.snackBar.open("Invalid lesson ID provided","Close",{duration:3e3}),this.router.navigate(["/lessons"]))}}loadLesson(){this.lessonId&&(this.loading=!0,this.lessonService.getLessonById(this.lessonId).subscribe({next:t=>{this.lessonForm.patchValue({title:t.title,description:t.description,topicId:t.topicId,contentType:t.contentType,contentUrl:t.contentUrl,durationMinutes:t.durationMinutes,orderNumber:t.orderNumber,isFree:t.isFree}),this.topicService.getTopicById(t.topicId).subscribe({next:n=>{this.lessonForm.patchValue({topicSearch:n,courseId:n.courseId}),this.courseService.getCourseById(n.courseId).subscribe({next:o=>{this.lessonForm.patchValue({courseSearch:o})},error:()=>{console.error("Error loading course details")}})}}),this.loadKeynotes(),this.loadTags(),this.loading=!1},error:()=>{this.snackBar.open("Error loading lesson","Close",{duration:3e3}),this.loading=!1}}))}loadKeynotes(){this.lessonId&&this.keynoteService.getKeynotesByLessonId(this.lessonId).subscribe({next:t=>{for(;0!==this.keynotes.length;)this.keynotes.removeAt(0);t.forEach(n=>{const o=this.fb.group({keynoteId:[n.keynoteId],title:[n.title,m.k0.required],content:[n.content,m.k0.required],contentType:[n.contentType,m.k0.required],isImportant:[n.isImportant||!1],hasVisualAid:[n.hasVisualAid||!1],visualAidUrl:[n.visualAidUrl||""],relatedPlanet:[n.relatedPlanet||""],relatedZodiac:[n.relatedZodiac||""],keynoteTags:this.fb.array([]),isNew:[!1]});this.keynotes.push(o),n.keynoteId&&this.loadKeynoteTags(n.keynoteId,this.keynotes.length-1)})},error:()=>{this.snackBar.open("Error loading keynotes","Close",{duration:3e3})}})}loadTags(){this.lessonId&&"number"==typeof this.lessonId&&this.lessonId>0?(console.log("Loading tags for lessonId:",this.lessonId),this.lessonTagService.getTagsByLessonId(this.lessonId).subscribe({next:t=>{for(console.log("Tags loaded successfully:",t);0!==this.tags.length;)this.tags.removeAt(0);t.forEach(n=>{const o=this.fb.group({lessonTagId:[n.lessonTagId],tagId:[n.tagId,m.k0.required],tagName:[n.tagName||""],relevanceScore:[n.relevanceScore||1]});this.tags.push(o)}),console.log("Tags form array updated, length:",this.tags.length)},error:t=>{console.error("Error loading tags:",t);let n="Error loading tags";t.status&&(n+=` (${t.status})`),t.error&&t.error.message&&(n+=`: ${t.error.message}`),this.snackBar.open(n,"Close",{duration:5e3})}})):console.log("lessonId is not valid for loadTags:",this.lessonId,typeof this.lessonId)}loadAllTags(){this.tagService.getTags().subscribe({next:t=>{this.allTags=t},error:()=>{this.snackBar.open("Error loading tags","Close",{duration:3e3})}})}loadKeynoteTags(t,n){this.keynoteTagService.getTagsByKeynoteId(t).subscribe({next:o=>{const s=this.getKeynoteTags(n);for(;0!==s.length;)s.removeAt(0);o.forEach(r=>{const l=this.fb.group({keynoteTagId:[r.keynoteTagId],tagId:[r.tagId,m.k0.required],relevanceScore:[r.relevanceScore||5]});s.push(l)})},error:()=>{this.snackBar.open("Error loading keynote tags","Close",{duration:3e3})}})}onSubmit(){var s,t=this;if(this.lessonForm.valid){this.submitting=!0;const n=this.lessonForm.value,o={title:n.title,description:n.description,topicId:n.topicId,contentType:n.contentType,contentUrl:n.contentUrl,durationMinutes:n.durationMinutes,isFree:n.isFree,...this.isEditMode&&{orderNumber:n.orderNumber}};this.isEditMode&&this.lessonId?this.lessonService.updateLesson(this.lessonId,o).subscribe({next:(s=(0,E.A)(function*(){try{yield t.handleKeynotes(t.lessonId),yield t.handleTags(t.lessonId),t.snackBar.open(`Lesson updated successfully with ${t.keynotes.length} keynote(s) and ${t.tags.length} tag(s)!`,"Close",{duration:3e3}),t.submitting=!1,t.goBack()}catch(r){console.error("Error updating keynotes/tags:",r),t.snackBar.open("Lesson updated but some keynotes or tags failed to save","Close",{duration:5e3}),t.submitting=!1,t.goBack()}}),function(){return s.apply(this,arguments)}),error:s=>{console.error("Error updating lesson:",s),this.snackBar.open("Error updating lesson. Please try again.","Close",{duration:5e3}),this.submitting=!1}}):this.lessonService.createLesson(o).subscribe({next:function(){var s=(0,E.A)(function*(r){try{yield t.handleKeynotes(r.lessonId),yield t.handleTags(r.lessonId),t.snackBar.open(`Lesson created successfully with ${t.keynotes.length} keynote(s) and ${t.tags.length} tag(s)!`,"Close",{duration:3e3}),t.submitting=!1,t.goBack()}catch(l){console.error("Error creating keynotes/tags:",l),t.snackBar.open("Lesson created but some keynotes or tags failed to save","Close",{duration:5e3}),t.submitting=!1,t.goBack()}});return function(l){return s.apply(this,arguments)}}(),error:s=>{console.error("Error creating lesson:",s),this.snackBar.open("Error creating lesson. Please try again.","Close",{duration:5e3}),this.submitting=!1}})}else this.snackBar.open("Please fill in all required fields correctly.","Close",{duration:3e3})}handleKeynotes(t){var n=this;return(0,E.A)(function*(){const s=n.lessonForm.get("keynotes")?.value||[];for(let r=0;r<s.length;r++){const l=s[r],u={lessonId:t,title:l.title,content:l.content,contentType:l.contentType,isImportant:l.isImportant||!1,hasVisualAid:l.hasVisualAid||!1,visualAidUrl:l.visualAidUrl||null,relatedPlanet:l.relatedPlanet||null,relatedZodiac:l.relatedZodiac||null};try{let d;d=l.keynoteId?yield n.keynoteService.updateKeynote(l.keynoteId,u).toPromise():yield n.keynoteService.createKeynote(u).toPromise(),d&&d.keynoteId&&l.keynoteTags&&(yield n.handleKeynoteTags(d.keynoteId,l.keynoteTags))}catch(d){throw console.error("Error handling keynote:",d),d}}})()}handleKeynoteTags(t,n){var o=this;return(0,E.A)(function*(){if(o.isEditMode)try{const r=(yield o.keynoteTagService.getTagsByKeynoteId(t).toPromise())||[],l=n.map(p=>p.keynoteTagId).filter(p=>p),d=r.filter(p=>p.keynoteTagId&&!l.includes(p.keynoteTagId)).filter(p=>p.keynoteTagId).map(p=>o.keynoteTagService.deleteKeynoteTag(p.keynoteTagId).toPromise());d.length>0&&(yield Promise.all(d));const h=[];n.forEach(p=>{const f={keynoteId:t,tagId:p.tagId,relevanceScore:p.relevanceScore||5};h.push(p.keynoteTagId?o.keynoteTagService.updateKeynoteTag(p.keynoteTagId,f).toPromise():o.keynoteTagService.createKeynoteTag(f).toPromise())}),h.length>0&&(yield Promise.all(h))}catch(s){throw console.error("Error handling keynote tags:",s),s}else{const s=[];n.forEach(r=>{s.push(o.keynoteTagService.createKeynoteTag({keynoteId:t,tagId:r.tagId,relevanceScore:r.relevanceScore||5}).toPromise())}),s.length>0&&(yield Promise.all(s))}})()}handleTags(t){var n=this;return(0,E.A)(function*(){const o=n.lessonForm.get("tags")?.value||[];if(n.isEditMode)try{const r=(yield n.lessonTagService.getTagsByLessonId(t).toPromise())||[],l=o.map(p=>p.lessonTagId).filter(p=>p),d=r.filter(p=>p.lessonTagId&&!l.includes(p.lessonTagId)).filter(p=>p.lessonTagId).map(p=>n.lessonTagService.deleteLessonTag(p.lessonTagId).toPromise());d.length>0&&(yield Promise.all(d));const h=[];o.forEach(p=>{const f={lessonId:t,tagId:p.tagId,relevanceScore:p.relevanceScore||1};h.push(p.lessonTagId?n.lessonTagService.updateLessonTag(p.lessonTagId,f).toPromise():n.lessonTagService.addLessonTag(f).toPromise())}),h.length>0&&(yield Promise.all(h))}catch(s){throw console.error("Error handling tags:",s),s}else{const s=[];o.forEach(r=>{s.push(n.lessonTagService.addLessonTag({lessonId:t,tagId:r.tagId,relevanceScore:r.relevanceScore||1}).toPromise())}),s.length>0&&(yield Promise.all(s))}})()}goBack(){const n=this.router.getCurrentNavigation()?.extras?.state||window.history.state;this.router.navigate(["/lessons"],{state:{selectedTopic:n?.selectedTopic,selectedCourse:n?.selectedCourse,selectedCategory:n?.selectedCategory}})}saveTag(t){var n=this;return(0,E.A)(function*(){const o=n.tags.at(t);if(!o.valid)return void n.snackBar.open("Please select a tag and enter a valid relevance score.","Close",{duration:3e3});if(!n.lessonId||"number"!=typeof n.lessonId)return void n.snackBar.open("Lesson ID is missing. Cannot save tag.","Close",{duration:3e3});const s=o.value,r={lessonId:n.lessonId,tagId:Number(s.tagId),relevanceScore:Number(s.relevanceScore)};try{if(s.lessonTagId)yield n.lessonTagService.updateLessonTag(s.lessonTagId,{...r,lessonTagId:s.lessonTagId}).toPromise(),n.snackBar.open("Tag updated successfully.","Close",{duration:2e3});else{const l=yield n.lessonTagService.addLessonTag(r).toPromise();l&&l.lessonTagId&&o.patchValue({lessonTagId:l.lessonTagId}),n.snackBar.open("Tag added successfully.","Close",{duration:2e3})}n.loadTags()}catch(l){let u="Failed to save tag. Please try again.";l&&l.error&&l.error.message?u=l.error.message:l&&l.message&&(u=l.message),n.snackBar.open(u,"Close",{duration:5e3}),console.error("Error saving tag:",l)}})()}static \u0275fac=function(n){return new(n||i)};static \u0275cmp=e.VBU({type:i,selectors:[["app-add-lesson"]],standalone:!0,features:[e.aNF],decls:15,vars:3,consts:[["courseAuto","matAutocomplete"],["auto","matAutocomplete"],[1,"container"],[1,"header"],["mat-button","",3,"click"],["class","loading-container",4,"ngIf"],[3,"formGroup","ngSubmit",4,"ngIf"],[1,"loading-container"],[3,"ngSubmit","formGroup"],[1,"section"],[1,"section-title"],["appearance","outline",1,"full-width"],["type","text","matInput","","formControlName","courseSearch","placeholder","Type to search courses...",3,"matAutocomplete"],[3,"optionSelected","displayWith"],[3,"value",4,"ngFor","ngForOf"],["matSuffix",""],["matInput","","formControlName","courseId","readonly",""],["type","text","matInput","","formControlName","topicSearch","placeholder","Type to search topics...",3,"matAutocomplete","disabled"],["class","course-warning",4,"ngIf"],["matInput","","formControlName","topicId","required","","readonly",""],[4,"ngIf"],["matInput","","formControlName","title","required","","placeholder","Enter lesson title..."],[1,"rich-text-field"],[1,"rich-text-label"],[1,"rich-text-container"],["formControlName","description","placeholder","Enter lesson description...","theme","snow",3,"modules"],["formControlName","contentType","required",""],["value","video"],["value","article"],["value","quiz"],["value","exercise"],["matInput","","formControlName","contentUrl","type","url","placeholder","https://example.com/content"],["matInput","","type","number","formControlName","durationMinutes","min","0","placeholder","0"],["appearance","outline","class","full-width",4,"ngIf"],[1,"checkbox-container"],["formControlName","isFree",1,"full-width"],[1,"section-header"],["mat-raised-button","","color","accent","type","button",1,"add-keynote-btn",3,"click"],["formArrayName","keynotes",1,"keynotes-container"],["class","keynote-panel",3,"formGroupName","expanded",4,"ngFor","ngForOf"],["class","no-keynotes",4,"ngIf"],["mat-raised-button","","color","accent","type","button",1,"add-tag-btn",3,"click"],["formArrayName","tags",1,"tags-container"],["class","tag-item",3,"formGroupName",4,"ngFor","ngForOf"],["class","no-tags",4,"ngIf"],[1,"button-container"],["mat-button","","type","button",3,"click"],["mat-raised-button","","color","primary","type","submit",3,"disabled"],["diameter","20",4,"ngIf"],[3,"value"],[1,"course-warning"],["matInput","","type","number","formControlName","orderNumber","min","1"],[1,"keynote-panel",3,"formGroupName","expanded"],[1,"keynote-title-container"],[1,"keynote-icon"],[1,"keynote-title"],["class","important-chip",4,"ngIf"],[1,"content-type-chip",3,"ngClass"],[1,"keynote-preview"],[1,"keynote-form"],["matInput","","formControlName","title","required",""],["value","text"],["value","bullet_points"],["value","quote"],["value","example"],[1,"rich-text-field","keynote-field"],[1,"rich-text-container","keynote-editor"],["formControlName","content","theme","snow",3,"modules","placeholder"],[1,"rich-text-hint"],["class","rich-text-error",4,"ngIf"],[1,"form-row"],["formControlName","isImportant",1,"checkbox-field"],["formControlName","hasVisualAid",1,"checkbox-field"],["appearance","outline",1,"half-width"],["formControlName","relatedPlanet"],["value",""],["value","Sun"],["value","Moon"],["value","Mars"],["value","Mercury"],["value","Jupiter"],["value","Venus"],["value","Saturn"],["value","Rahu"],["value","Ketu"],["formControlName","relatedZodiac"],["value","Aries"],["value","Taurus"],["value","Gemini"],["value","Cancer"],["value","Leo"],["value","Virgo"],["value","Libra"],["value","Scorpio"],["value","Sagittarius"],["value","Capricorn"],["value","Aquarius"],["value","Pisces"],[1,"keynote-tags-section"],[1,"section-subtitle"],["mat-button","","color","accent","type","button",1,"add-keynote-tag-btn",3,"click"],["formArrayName","keynoteTags",1,"keynote-tags-container"],["class","keynote-tag-item",3,"formGroupName",4,"ngFor","ngForOf"],["class","no-keynote-tags",4,"ngIf"],[1,"keynote-actions"],["mat-button","","color","warn","type","button","matTooltip","Remove this keynote",3,"click"],[1,"important-chip"],[1,"rich-text-error"],["matInput","","formControlName","visualAidUrl","type","url"],[1,"keynote-tag-item",3,"formGroupName"],["appearance","outline",1,"tag-select"],["formControlName","tagId","required",""],["appearance","outline",1,"relevance-score"],["matInput","","formControlName","relevanceScore","type","number","min","1","max","10"],["mat-icon-button","","color","warn","type","button","matTooltip","Remove this tag",1,"remove-tag-btn",3,"click"],[1,"no-keynote-tags"],[1,"no-keynotes"],[1,"tag-item",3,"formGroupName"],["matInput","","formControlName","relevanceScore","type","number","min","1"],[1,"tag-actions"],["mat-icon-button","","color","primary","type","button","matTooltip","Save this tag",1,"save-tag-btn",3,"click"],["mat-button","","color","warn","type","button","matTooltip","Remove this tag",3,"click"],[1,"no-tags"],["diameter","20"]],template:function(n,o){1&n&&(e.j41(0,"div",2)(1,"div",3)(2,"h1"),e.EFF(3),e.k0s(),e.j41(4,"button",4),e.bIt("click",function(){return o.goBack()}),e.j41(5,"mat-icon"),e.EFF(6,"arrow_back"),e.k0s(),e.EFF(7," Back to Lessons "),e.k0s()(),e.j41(8,"mat-card")(9,"mat-card-header")(10,"mat-card-title"),e.EFF(11,"Lesson Information"),e.k0s()(),e.j41(12,"mat-card-content"),e.DNE(13,Yt,4,0,"div",5)(14,bn,119,26,"form",6),e.k0s()()()),2&n&&(e.R7$(3),e.JRh(o.isEditMode?"Edit Lesson"+(o.lessonId?" (ID: "+o.lessonId+")":""):"Add New Lesson"),e.R7$(10),e.Y8G("ngIf",o.loading),e.R7$(),e.Y8G("ngIf",!o.loading))},dependencies:[g.MD,g.YU,g.Sq,g.bT,g.Jj,m.X1,m.qT,m.me,m.Q0,m.BC,m.cb,m.YS,m.VZ,m.zX,m.j4,m.JD,m.$R,m.v8,C.RG,C.rl,C.nJ,C.MV,C.TL,C.yw,L.fS,L.fg,k.Hl,k.$z,k.iY,_.Hu,_.RN,_.m2,_.MM,_.dh,M.jL,M.$3,z.wT,M.pN,w.Ve,w.VO,ne.g7,ne.So,R._T,vt,de,gt,yt,ft,I.m_,I.An,$.YN,$.Jl,ue.w,ue.q,O.uc,O.oV,me.D6,me.LG,Gt,$t],styles:[".container[_ngcontent-%COMP%]{padding:20px;max-width:1000px;margin:0 auto}.header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:24px;padding-bottom:16px;border-bottom:1px solid #e0e0e0}.header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0;color:#1976d2;font-weight:500}.loading-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;padding:60px 20px;color:#666}.loading-container[_ngcontent-%COMP%]   mat-spinner[_ngcontent-%COMP%]{margin-bottom:16px}.section[_ngcontent-%COMP%]{margin-bottom:30px}.section-title[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;font-size:18px;font-weight:500;margin-bottom:20px;color:#333}.section-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px}.add-keynote-btn[_ngcontent-%COMP%], .add-tag-btn[_ngcontent-%COMP%]{min-width:140px}.full-width[_ngcontent-%COMP%]{width:100%;margin-bottom:15px}.course-warning[_ngcontent-%COMP%]{color:#ff6b6b!important;font-weight:500}.rich-text-field[_ngcontent-%COMP%]{width:100%;margin-bottom:16px}.rich-text-label[_ngcontent-%COMP%]{display:block;font-size:12px;font-weight:500;color:#0009;margin-bottom:8px;font-family:Roboto,Helvetica Neue,sans-serif}.rich-text-container[_ngcontent-%COMP%]{border:1px solid rgba(0,0,0,.12);border-radius:4px;min-height:120px;background-color:#fff;transition:border-color .15s ease}.rich-text-container[_ngcontent-%COMP%]   .ql-editor[_ngcontent-%COMP%]{min-height:100px;font-family:Roboto,Helvetica Neue,sans-serif;font-size:14px;line-height:1.5}.rich-text-container[_ngcontent-%COMP%]   .ql-toolbar[_ngcontent-%COMP%]{border-bottom:1px solid rgba(0,0,0,.12);font-family:Roboto,Helvetica Neue,sans-serif}.rich-text-container[_ngcontent-%COMP%]:focus-within{border-color:#1976d2;box-shadow:0 0 0 1px #1976d2}.rich-text-hint[_ngcontent-%COMP%]{font-size:12px;color:#0009;margin-top:4px;font-family:Roboto,Helvetica Neue,sans-serif}.rich-text-error[_ngcontent-%COMP%]{font-size:12px;color:#f44336;margin-top:4px;font-family:Roboto,Helvetica Neue,sans-serif}.keynote-field[_ngcontent-%COMP%]{margin-bottom:20px}.keynote-editor[_ngcontent-%COMP%]{min-height:100px}.keynote-editor[_ngcontent-%COMP%]   .ql-editor[_ngcontent-%COMP%]{min-height:80px}.half-width[_ngcontent-%COMP%]{width:48%;margin-bottom:15px}.form-row[_ngcontent-%COMP%]{display:flex;gap:16px;align-items:center;margin-bottom:15px}.checkbox-field[_ngcontent-%COMP%]{margin-right:20px}.keynotes-container[_ngcontent-%COMP%], .tags-container[_ngcontent-%COMP%]{max-height:600px;overflow-y:auto;border:1px solid #e0e0e0;border-radius:8px;padding:12px;background-color:#fafafa}.tag-item[_ngcontent-%COMP%]{background-color:#fff;border:1px solid #e0e0e0;border-radius:8px;padding:16px;margin-bottom:12px;position:relative}.tag-item[_ngcontent-%COMP%]:last-child{margin-bottom:0}.tag-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;margin-top:12px;padding-top:12px;border-top:1px solid #f0f0f0}.keynote-tags-section[_ngcontent-%COMP%]{margin-top:20px;padding:16px;background-color:#f8f9fa;border-radius:8px;border:1px solid #e9ecef}.section-subtitle[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;font-size:16px;font-weight:500;margin:0;color:#495057}.keynote-tag-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;background-color:#fff;border:1px solid #dee2e6;border-radius:6px;padding:12px;margin-bottom:8px}.tag-select[_ngcontent-%COMP%]{flex:2;margin-bottom:0}.relevance-score[_ngcontent-%COMP%]{flex:1;margin-bottom:0}.remove-tag-btn[_ngcontent-%COMP%]{flex-shrink:0;width:40px;height:40px}.add-keynote-tag-btn[_ngcontent-%COMP%]{font-size:12px;height:32px}.no-keynote-tags[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;color:#6c757d;font-style:italic;padding:12px;justify-content:center}.keynote-panel[_ngcontent-%COMP%]{margin-bottom:12px;border:1px solid #e0e0e0;border-radius:8px;overflow:hidden}.keynote-panel[_ngcontent-%COMP%]:last-child{margin-bottom:0}.keynote-title-container[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;flex:1}.keynote-icon[_ngcontent-%COMP%]{color:#666;font-size:20px}.keynote-title[_ngcontent-%COMP%]{font-weight:500;max-width:200px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.important-chip[_ngcontent-%COMP%]{background-color:#ff6b6b;color:#fff;font-size:11px;height:24px;min-height:24px}.content-type-chip[_ngcontent-%COMP%]{font-size:11px;height:24px;min-height:24px;color:#fff}.content-type-text[_ngcontent-%COMP%]{background-color:#4caf50}.content-type-bullet_points[_ngcontent-%COMP%]{background-color:#ff9800}.content-type-quote[_ngcontent-%COMP%]{background-color:#9c27b0}.content-type-example[_ngcontent-%COMP%]{background-color:#2196f3}.keynote-preview[_ngcontent-%COMP%]{color:#666;font-size:12px;max-width:150px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.keynote-form[_ngcontent-%COMP%]{padding:20px;background-color:#fff;border-radius:8px;margin:8px 0}.keynote-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;margin-top:20px;padding-top:16px;border-top:1px solid #f0f0f0}.no-keynotes[_ngcontent-%COMP%], .no-tags[_ngcontent-%COMP%]{text-align:center;padding:40px 20px;color:#666}.no-keynotes[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%], .no-tags[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:48px;width:48px;height:48px;margin-bottom:16px;opacity:.5}.button-container[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:12px;margin-top:30px;padding-top:20px;border-top:1px solid #e0e0e0}.button-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{min-width:120px}.button-container[_ngcontent-%COMP%]   mat-spinner[_ngcontent-%COMP%]{margin-right:8px}.checkbox-container[_ngcontent-%COMP%]{margin:20px 0;padding:16px;background-color:#f8f9fa;border-radius:8px;border:1px solid #e9ecef}mat-checkbox[_ngcontent-%COMP%]{margin-bottom:15px}mat-divider[_ngcontent-%COMP%]{margin:30px 0}@media (max-width: 768px){.section-header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:12px}.form-row[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start}.half-width[_ngcontent-%COMP%]{width:100%}.keynote-title-container[_ngcontent-%COMP%]{flex-wrap:wrap}.keynote-title[_ngcontent-%COMP%]{max-width:150px}}"]})}return i})();const xn=[{path:"",component:Ke},{path:"add",component:ye},{path:"update/:id",component:ye}]}}]);